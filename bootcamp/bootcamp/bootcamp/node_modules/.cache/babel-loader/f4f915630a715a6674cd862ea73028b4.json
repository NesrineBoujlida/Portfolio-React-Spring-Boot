{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar tslib = require('tslib');\n\nvar useMotionValue = require('./use-motion-value-4144a8cf.js');\n\nvar React = require('react');\n\nvar styleValueTypes = require('style-value-types');\n\nvar popmotion = require('popmotion');\n\nvar heyListen = require('hey-listen');\n\nvar sync = require('framesync');\n\nfunction _interopDefaultLegacy(e) {\n  return e && typeof e === 'object' && 'default' in e ? e : {\n    'default': e\n  };\n}\n\nfunction _interopNamespace(e) {\n  if (e && e.__esModule) return e;\n  var n = Object.create(null);\n\n  if (e) {\n    Object.keys(e).forEach(function (k) {\n      if (k !== 'default') {\n        var d = Object.getOwnPropertyDescriptor(e, k);\n        Object.defineProperty(n, k, d.get ? d : {\n          enumerable: true,\n          get: function () {\n            return e[k];\n          }\n        });\n      }\n    });\n  }\n\n  n[\"default\"] = e;\n  return Object.freeze(n);\n}\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nvar React__namespace = /*#__PURE__*/_interopNamespace(React);\n\nvar sync__default = /*#__PURE__*/_interopDefaultLegacy(sync);\n/**\n * Convert any React component into a `motion` component. The provided component\n * **must** use `React.forwardRef` to the underlying DOM component you want to animate.\n *\n * ```jsx\n * const Component = React.forwardRef((props, ref) => {\n *   return <div ref={ref} />\n * })\n *\n * const MotionComponent = motion(Component)\n * ```\n *\n * @public\n */\n\n\nfunction createMotionProxy(createConfig) {\n  function custom(Component, customMotionComponentConfig) {\n    if (customMotionComponentConfig === void 0) {\n      customMotionComponentConfig = {};\n    }\n\n    return useMotionValue.createMotionComponent(createConfig(Component, customMotionComponentConfig));\n  }\n\n  if (typeof Proxy === \"undefined\") {\n    return custom;\n  }\n  /**\n   * A cache of generated `motion` components, e.g `motion.div`, `motion.input` etc.\n   * Rather than generating them anew every render.\n   */\n\n\n  var componentCache = new Map();\n  return new Proxy(custom, {\n    /**\n     * Called when `motion` is referenced with a prop: `motion.div`, `motion.input` etc.\n     * The prop name is passed through as `key` and we can use that to generate a `motion`\n     * DOM component with that name.\n     */\n    get: function (_target, key) {\n      /**\n       * If this element doesn't exist in the component cache, create it and cache.\n       */\n      if (!componentCache.has(key)) {\n        componentCache.set(key, custom(key));\n      }\n\n      return componentCache.get(key);\n    }\n  });\n}\n/**\n * We keep these listed seperately as we use the lowercase tag names as part\n * of the runtime bundle to detect SVG components\n */\n\n\nvar lowercaseSVGElements = [\"animate\", \"circle\", \"defs\", \"desc\", \"ellipse\", \"g\", \"image\", \"line\", \"filter\", \"marker\", \"mask\", \"metadata\", \"path\", \"pattern\", \"polygon\", \"polyline\", \"rect\", \"stop\", \"svg\", \"switch\", \"symbol\", \"text\", \"tspan\", \"use\", \"view\"];\n\nfunction isSVGComponent(Component) {\n  if (\n  /**\n   * If it's not a string, it's a custom React component. Currently we only support\n   * HTML custom React components.\n   */\n  typeof Component !== \"string\" ||\n  /**\n   * If it contains a dash, the element is a custom HTML webcomponent.\n   */\n  Component.includes(\"-\")) {\n    return false;\n  } else if (\n  /**\n   * If it's in our list of lowercase SVG tags, it's an SVG component\n   */\n  lowercaseSVGElements.indexOf(Component) > -1 ||\n  /**\n   * If it contains a capital letter, it's an SVG component\n   */\n  /[A-Z]/.test(Component)) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction isForcedMotionValue(key, _a) {\n  var layout = _a.layout,\n      layoutId = _a.layoutId;\n  return useMotionValue.isTransformProp(key) || useMotionValue.isTransformOriginProp(key) || (layout || layoutId !== undefined) && (!!useMotionValue.scaleCorrectors[key] || key === \"opacity\");\n}\n\nvar translateAlias = {\n  x: \"translateX\",\n  y: \"translateY\",\n  z: \"translateZ\",\n  transformPerspective: \"perspective\"\n};\n/**\n * Build a CSS transform style from individual x/y/scale etc properties.\n *\n * This outputs with a default order of transforms/scales/rotations, this can be customised by\n * providing a transformTemplate function.\n */\n\nfunction buildTransform(_a, _b, transformIsDefault, transformTemplate) {\n  var transform = _a.transform,\n      transformKeys = _a.transformKeys;\n  var _c = _b.enableHardwareAcceleration,\n      enableHardwareAcceleration = _c === void 0 ? true : _c,\n      _d = _b.allowTransformNone,\n      allowTransformNone = _d === void 0 ? true : _d; // The transform string we're going to build into.\n\n  var transformString = \"\"; // Transform keys into their default order - this will determine the output order.\n\n  transformKeys.sort(useMotionValue.sortTransformProps); // Track whether the defined transform has a defined z so we don't add a\n  // second to enable hardware acceleration\n\n  var transformHasZ = false; // Loop over each transform and build them into transformString\n\n  var numTransformKeys = transformKeys.length;\n\n  for (var i = 0; i < numTransformKeys; i++) {\n    var key = transformKeys[i];\n    transformString += \"\".concat(translateAlias[key] || key, \"(\").concat(transform[key], \") \");\n    if (key === \"z\") transformHasZ = true;\n  }\n\n  if (!transformHasZ && enableHardwareAcceleration) {\n    transformString += \"translateZ(0)\";\n  } else {\n    transformString = transformString.trim();\n  } // If we have a custom `transform` template, pass our transform values and\n  // generated transformString to that before returning\n\n\n  if (transformTemplate) {\n    transformString = transformTemplate(transform, transformIsDefault ? \"\" : transformString);\n  } else if (allowTransformNone && transformIsDefault) {\n    transformString = \"none\";\n  }\n\n  return transformString;\n}\n/**\n * Build a transformOrigin style. Uses the same defaults as the browser for\n * undefined origins.\n */\n\n\nfunction buildTransformOrigin(_a) {\n  var _b = _a.originX,\n      originX = _b === void 0 ? \"50%\" : _b,\n      _c = _a.originY,\n      originY = _c === void 0 ? \"50%\" : _c,\n      _d = _a.originZ,\n      originZ = _d === void 0 ? 0 : _d;\n  return \"\".concat(originX, \" \").concat(originY, \" \").concat(originZ);\n}\n/**\n * Returns true if the provided key is a CSS variable\n */\n\n\nfunction isCSSVariable$1(key) {\n  return key.startsWith(\"--\");\n}\n/**\n * Provided a value and a ValueType, returns the value as that value type.\n */\n\n\nvar getValueAsType = function (value, type) {\n  return type && typeof value === \"number\" ? type.transform(value) : value;\n};\n\nfunction buildHTMLStyles(state, latestValues, options, transformTemplate) {\n  var _a;\n\n  var style = state.style,\n      vars = state.vars,\n      transform = state.transform,\n      transformKeys = state.transformKeys,\n      transformOrigin = state.transformOrigin; // Empty the transformKeys array. As we're throwing out refs to its items\n  // this might not be as cheap as suspected. Maybe using the array as a buffer\n  // with a manual incrementation would be better.\n\n  transformKeys.length = 0; // Track whether we encounter any transform or transformOrigin values.\n\n  var hasTransform = false;\n  var hasTransformOrigin = false; // Does the calculated transform essentially equal \"none\"?\n\n  var transformIsNone = true;\n  /**\n   * Loop over all our latest animated values and decide whether to handle them\n   * as a style or CSS variable.\n   *\n   * Transforms and transform origins are kept seperately for further processing.\n   */\n\n  for (var key in latestValues) {\n    var value = latestValues[key];\n    /**\n     * If this is a CSS variable we don't do any further processing.\n     */\n\n    if (isCSSVariable$1(key)) {\n      vars[key] = value;\n      continue;\n    } // Convert the value to its default value type, ie 0 -> \"0px\"\n\n\n    var valueType = useMotionValue.numberValueTypes[key];\n    var valueAsType = getValueAsType(value, valueType);\n\n    if (useMotionValue.isTransformProp(key)) {\n      // If this is a transform, flag to enable further transform processing\n      hasTransform = true;\n      transform[key] = valueAsType;\n      transformKeys.push(key); // If we already know we have a non-default transform, early return\n\n      if (!transformIsNone) continue; // Otherwise check to see if this is a default transform\n\n      if (value !== ((_a = valueType.default) !== null && _a !== void 0 ? _a : 0)) transformIsNone = false;\n    } else if (useMotionValue.isTransformOriginProp(key)) {\n      transformOrigin[key] = valueAsType; // If this is a transform origin, flag and enable further transform-origin processing\n\n      hasTransformOrigin = true;\n    } else {\n      style[key] = valueAsType;\n    }\n  }\n\n  if (hasTransform) {\n    style.transform = buildTransform(state, options, transformIsNone, transformTemplate);\n  } else if (transformTemplate) {\n    style.transform = transformTemplate({}, \"\");\n  } else if (!latestValues.transform && style.transform) {\n    style.transform = \"none\";\n  }\n\n  if (hasTransformOrigin) {\n    style.transformOrigin = buildTransformOrigin(transformOrigin);\n  }\n}\n\nvar createHtmlRenderState = function () {\n  return {\n    style: {},\n    transform: {},\n    transformKeys: [],\n    transformOrigin: {},\n    vars: {}\n  };\n};\n\nfunction copyRawValuesOnly(target, source, props) {\n  for (var key in source) {\n    if (!useMotionValue.isMotionValue(source[key]) && !isForcedMotionValue(key, props)) {\n      target[key] = source[key];\n    }\n  }\n}\n\nfunction useInitialMotionValues(_a, visualState, isStatic) {\n  var transformTemplate = _a.transformTemplate;\n  return React.useMemo(function () {\n    var state = createHtmlRenderState();\n    buildHTMLStyles(state, visualState, {\n      enableHardwareAcceleration: !isStatic\n    }, transformTemplate);\n    var vars = state.vars,\n        style = state.style;\n    return tslib.__assign(tslib.__assign({}, vars), style);\n  }, [visualState]);\n}\n\nfunction useStyle(props, visualState, isStatic) {\n  var styleProp = props.style || {};\n  var style = {};\n  /**\n   * Copy non-Motion Values straight into style\n   */\n\n  copyRawValuesOnly(style, styleProp, props);\n  Object.assign(style, useInitialMotionValues(props, visualState, isStatic));\n\n  if (props.transformValues) {\n    style = props.transformValues(style);\n  }\n\n  return style;\n}\n\nfunction useHTMLProps(props, visualState, isStatic) {\n  // The `any` isn't ideal but it is the type of createElement props argument\n  var htmlProps = {};\n  var style = useStyle(props, visualState, isStatic);\n\n  if (Boolean(props.drag) && props.dragListener !== false) {\n    // Disable the ghost element when a user drags\n    htmlProps.draggable = false; // Disable text selection\n\n    style.userSelect = style.WebkitUserSelect = style.WebkitTouchCallout = \"none\"; // Disable scrolling on the draggable direction\n\n    style.touchAction = props.drag === true ? \"none\" : \"pan-\".concat(props.drag === \"x\" ? \"y\" : \"x\");\n  }\n\n  htmlProps.style = style;\n  return htmlProps;\n}\n\nfunction calcOrigin$1(origin, offset, size) {\n  return typeof origin === \"string\" ? origin : styleValueTypes.px.transform(offset + size * origin);\n}\n/**\n * The SVG transform origin defaults are different to CSS and is less intuitive,\n * so we use the measured dimensions of the SVG to reconcile these.\n */\n\n\nfunction calcSVGTransformOrigin(dimensions, originX, originY) {\n  var pxOriginX = calcOrigin$1(originX, dimensions.x, dimensions.width);\n  var pxOriginY = calcOrigin$1(originY, dimensions.y, dimensions.height);\n  return \"\".concat(pxOriginX, \" \").concat(pxOriginY);\n}\n\nvar dashKeys = {\n  offset: \"stroke-dashoffset\",\n  array: \"stroke-dasharray\"\n};\nvar camelKeys = {\n  offset: \"strokeDashoffset\",\n  array: \"strokeDasharray\"\n};\n/**\n * Build SVG path properties. Uses the path's measured length to convert\n * our custom pathLength, pathSpacing and pathOffset into stroke-dashoffset\n * and stroke-dasharray attributes.\n *\n * This function is mutative to reduce per-frame GC.\n */\n\nfunction buildSVGPath(attrs, length, spacing, offset, useDashCase) {\n  if (spacing === void 0) {\n    spacing = 1;\n  }\n\n  if (offset === void 0) {\n    offset = 0;\n  }\n\n  if (useDashCase === void 0) {\n    useDashCase = true;\n  } // Normalise path length by setting SVG attribute pathLength to 1\n\n\n  attrs.pathLength = 1; // We use dash case when setting attributes directly to the DOM node and camel case\n  // when defining props on a React component.\n\n  var keys = useDashCase ? dashKeys : camelKeys; // Build the dash offset\n\n  attrs[keys.offset] = styleValueTypes.px.transform(-offset); // Build the dash array\n\n  var pathLength = styleValueTypes.px.transform(length);\n  var pathSpacing = styleValueTypes.px.transform(spacing);\n  attrs[keys.array] = \"\".concat(pathLength, \" \").concat(pathSpacing);\n}\n/**\n * Build SVG visual attrbutes, like cx and style.transform\n */\n\n\nfunction buildSVGAttrs(state, _a, options, transformTemplate) {\n  var attrX = _a.attrX,\n      attrY = _a.attrY,\n      originX = _a.originX,\n      originY = _a.originY,\n      pathLength = _a.pathLength,\n      _b = _a.pathSpacing,\n      pathSpacing = _b === void 0 ? 1 : _b,\n      _c = _a.pathOffset,\n      pathOffset = _c === void 0 ? 0 : _c,\n      // This is object creation, which we try to avoid per-frame.\n  latest = tslib.__rest(_a, [\"attrX\", \"attrY\", \"originX\", \"originY\", \"pathLength\", \"pathSpacing\", \"pathOffset\"]);\n\n  buildHTMLStyles(state, latest, options, transformTemplate);\n  state.attrs = state.style;\n  state.style = {};\n  var attrs = state.attrs,\n      style = state.style,\n      dimensions = state.dimensions;\n  /**\n   * However, we apply transforms as CSS transforms. So if we detect a transform we take it from attrs\n   * and copy it into style.\n   */\n\n  if (attrs.transform) {\n    if (dimensions) style.transform = attrs.transform;\n    delete attrs.transform;\n  } // Parse transformOrigin\n\n\n  if (dimensions && (originX !== undefined || originY !== undefined || style.transform)) {\n    style.transformOrigin = calcSVGTransformOrigin(dimensions, originX !== undefined ? originX : 0.5, originY !== undefined ? originY : 0.5);\n  } // Treat x/y not as shortcuts but as actual attributes\n\n\n  if (attrX !== undefined) attrs.x = attrX;\n  if (attrY !== undefined) attrs.y = attrY; // Build SVG path if one has been defined\n\n  if (pathLength !== undefined) {\n    buildSVGPath(attrs, pathLength, pathSpacing, pathOffset, false);\n  }\n}\n\nvar createSvgRenderState = function () {\n  return tslib.__assign(tslib.__assign({}, createHtmlRenderState()), {\n    attrs: {}\n  });\n};\n\nfunction useSVGProps(props, visualState) {\n  var visualProps = React.useMemo(function () {\n    var state = createSvgRenderState();\n    buildSVGAttrs(state, visualState, {\n      enableHardwareAcceleration: false\n    }, props.transformTemplate);\n    return tslib.__assign(tslib.__assign({}, state.attrs), {\n      style: tslib.__assign({}, state.style)\n    });\n  }, [visualState]);\n\n  if (props.style) {\n    var rawStyles = {};\n    copyRawValuesOnly(rawStyles, props.style, props);\n    visualProps.style = tslib.__assign(tslib.__assign({}, rawStyles), visualProps.style);\n  }\n\n  return visualProps;\n}\n\nfunction createUseRender(forwardMotionProps) {\n  if (forwardMotionProps === void 0) {\n    forwardMotionProps = false;\n  }\n\n  var useRender = function (Component, props, projectionId, ref, _a, isStatic) {\n    var latestValues = _a.latestValues;\n    var useVisualProps = isSVGComponent(Component) ? useSVGProps : useHTMLProps;\n    var visualProps = useVisualProps(props, latestValues, isStatic);\n    var filteredProps = useMotionValue.filterProps(props, typeof Component === \"string\", forwardMotionProps);\n\n    var elementProps = tslib.__assign(tslib.__assign(tslib.__assign({}, filteredProps), visualProps), {\n      ref: ref\n    });\n\n    if (projectionId) {\n      elementProps[\"data-projection-id\"] = projectionId;\n    }\n\n    return React.createElement(Component, elementProps);\n  };\n\n  return useRender;\n}\n\nvar CAMEL_CASE_PATTERN = /([a-z])([A-Z])/g;\nvar REPLACE_TEMPLATE = \"$1-$2\";\n/**\n * Convert camelCase to dash-case properties.\n */\n\nvar camelToDash = function (str) {\n  return str.replace(CAMEL_CASE_PATTERN, REPLACE_TEMPLATE).toLowerCase();\n};\n\nfunction renderHTML(element, _a, styleProp, projection) {\n  var style = _a.style,\n      vars = _a.vars;\n  Object.assign(element.style, style, projection && projection.getProjectionStyles(styleProp)); // Loop over any CSS variables and assign those.\n\n  for (var key in vars) {\n    element.style.setProperty(key, vars[key]);\n  }\n}\n/**\n * A set of attribute names that are always read/written as camel case.\n */\n\n\nvar camelCaseAttributes = new Set([\"baseFrequency\", \"diffuseConstant\", \"kernelMatrix\", \"kernelUnitLength\", \"keySplines\", \"keyTimes\", \"limitingConeAngle\", \"markerHeight\", \"markerWidth\", \"numOctaves\", \"targetX\", \"targetY\", \"surfaceScale\", \"specularConstant\", \"specularExponent\", \"stdDeviation\", \"tableValues\", \"viewBox\", \"gradientTransform\", \"pathLength\"]);\n\nfunction renderSVG(element, renderState) {\n  renderHTML(element, renderState);\n\n  for (var key in renderState.attrs) {\n    element.setAttribute(!camelCaseAttributes.has(key) ? camelToDash(key) : key, renderState.attrs[key]);\n  }\n}\n\nfunction scrapeMotionValuesFromProps$1(props) {\n  var style = props.style;\n  var newValues = {};\n\n  for (var key in style) {\n    if (useMotionValue.isMotionValue(style[key]) || isForcedMotionValue(key, props)) {\n      newValues[key] = style[key];\n    }\n  }\n\n  return newValues;\n}\n\nfunction scrapeMotionValuesFromProps(props) {\n  var newValues = scrapeMotionValuesFromProps$1(props);\n\n  for (var key in props) {\n    if (useMotionValue.isMotionValue(props[key])) {\n      var targetKey = key === \"x\" || key === \"y\" ? \"attr\" + key.toUpperCase() : key;\n      newValues[targetKey] = props[key];\n    }\n  }\n\n  return newValues;\n}\n\nvar svgMotionConfig = {\n  useVisualState: useMotionValue.makeUseVisualState({\n    scrapeMotionValuesFromProps: scrapeMotionValuesFromProps,\n    createRenderState: createSvgRenderState,\n    onMount: function (props, instance, _a) {\n      var renderState = _a.renderState,\n          latestValues = _a.latestValues;\n\n      try {\n        renderState.dimensions = typeof instance.getBBox === \"function\" ? instance.getBBox() : instance.getBoundingClientRect();\n      } catch (e) {\n        // Most likely trying to measure an unrendered element under Firefox\n        renderState.dimensions = {\n          x: 0,\n          y: 0,\n          width: 0,\n          height: 0\n        };\n      }\n\n      buildSVGAttrs(renderState, latestValues, {\n        enableHardwareAcceleration: false\n      }, props.transformTemplate); // TODO: Replace with direct assignment\n\n      renderSVG(instance, renderState);\n    }\n  })\n};\nvar htmlMotionConfig = {\n  useVisualState: useMotionValue.makeUseVisualState({\n    scrapeMotionValuesFromProps: scrapeMotionValuesFromProps$1,\n    createRenderState: createHtmlRenderState\n  })\n};\n\nfunction createDomMotionConfig(Component, _a, preloadedFeatures, createVisualElement, projectionNodeConstructor) {\n  var _b = _a.forwardMotionProps,\n      forwardMotionProps = _b === void 0 ? false : _b;\n  var baseConfig = isSVGComponent(Component) ? svgMotionConfig : htmlMotionConfig;\n  return tslib.__assign(tslib.__assign({}, baseConfig), {\n    preloadedFeatures: preloadedFeatures,\n    useRender: createUseRender(forwardMotionProps),\n    createVisualElement: createVisualElement,\n    projectionNodeConstructor: projectionNodeConstructor,\n    Component: Component\n  });\n}\n/**\n *\n * @param props\n * @param ref\n * @internal\n */\n\n\nfunction useFocusGesture(_a) {\n  var whileFocus = _a.whileFocus,\n      visualElement = _a.visualElement;\n\n  var onFocus = function () {\n    var _a;\n\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Focus, true);\n  };\n\n  var onBlur = function () {\n    var _a;\n\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Focus, false);\n  };\n\n  useMotionValue.useDomEvent(visualElement, \"focus\", whileFocus ? onFocus : undefined);\n  useMotionValue.useDomEvent(visualElement, \"blur\", whileFocus ? onBlur : undefined);\n}\n\nfunction createHoverEvent(visualElement, isActive, callback) {\n  return function (event, info) {\n    var _a;\n\n    if (!useMotionValue.isMouseEvent(event) || useMotionValue.isDragActive()) return;\n    /**\n     * Ensure we trigger animations before firing event callback\n     */\n\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Hover, isActive);\n    callback === null || callback === void 0 ? void 0 : callback(event, info);\n  };\n}\n\nfunction useHoverGesture(_a) {\n  var onHoverStart = _a.onHoverStart,\n      onHoverEnd = _a.onHoverEnd,\n      whileHover = _a.whileHover,\n      visualElement = _a.visualElement;\n  useMotionValue.usePointerEvent(visualElement, \"pointerenter\", onHoverStart || whileHover ? createHoverEvent(visualElement, true, onHoverStart) : undefined);\n  useMotionValue.usePointerEvent(visualElement, \"pointerleave\", onHoverEnd || whileHover ? createHoverEvent(visualElement, false, onHoverEnd) : undefined);\n}\n/**\n * Recursively traverse up the tree to check whether the provided child node\n * is the parent or a descendant of it.\n *\n * @param parent - Element to find\n * @param child - Element to test against parent\n */\n\n\nvar isNodeOrChild = function (parent, child) {\n  if (!child) {\n    return false;\n  } else if (parent === child) {\n    return true;\n  } else {\n    return isNodeOrChild(parent, child.parentElement);\n  }\n};\n/**\n * @param handlers -\n * @internal\n */\n\n\nfunction useTapGesture(_a) {\n  var onTap = _a.onTap,\n      onTapStart = _a.onTapStart,\n      onTapCancel = _a.onTapCancel,\n      whileTap = _a.whileTap,\n      visualElement = _a.visualElement;\n  var hasPressListeners = onTap || onTapStart || onTapCancel || whileTap;\n  var isPressing = React.useRef(false);\n  var cancelPointerEndListeners = React.useRef(null);\n\n  function removePointerEndListener() {\n    var _a;\n\n    (_a = cancelPointerEndListeners.current) === null || _a === void 0 ? void 0 : _a.call(cancelPointerEndListeners);\n    cancelPointerEndListeners.current = null;\n  }\n\n  function checkPointerEnd() {\n    var _a;\n\n    removePointerEndListener();\n    isPressing.current = false;\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Tap, false);\n    return !useMotionValue.isDragActive();\n  }\n\n  function onPointerUp(event, info) {\n    if (!checkPointerEnd()) return;\n    /**\n     * We only count this as a tap gesture if the event.target is the same\n     * as, or a child of, this component's element\n     */\n\n    !isNodeOrChild(visualElement.getInstance(), event.target) ? onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info) : onTap === null || onTap === void 0 ? void 0 : onTap(event, info);\n  }\n\n  function onPointerCancel(event, info) {\n    if (!checkPointerEnd()) return;\n    onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info);\n  }\n\n  function onPointerDown(event, info) {\n    var _a;\n\n    removePointerEndListener();\n    if (isPressing.current) return;\n    isPressing.current = true;\n    cancelPointerEndListeners.current = popmotion.pipe(useMotionValue.addPointerEvent(window, \"pointerup\", onPointerUp), useMotionValue.addPointerEvent(window, \"pointercancel\", onPointerCancel));\n    /**\n     * Ensure we trigger animations before firing event callback\n     */\n\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Tap, true);\n    onTapStart === null || onTapStart === void 0 ? void 0 : onTapStart(event, info);\n  }\n\n  useMotionValue.usePointerEvent(visualElement, \"pointerdown\", hasPressListeners ? onPointerDown : undefined);\n  useMotionValue.useUnmountEffect(removePointerEndListener);\n}\n\nvar warned = new Set();\n\nfunction warnOnce(condition, message, element) {\n  if (condition || warned.has(message)) return;\n  console.warn(message);\n  if (element) console.warn(element);\n  warned.add(message);\n}\n/**\n * Map an IntersectionHandler callback to an element. We only ever make one handler for one\n * element, so even though these handlers might all be triggered by different\n * observers, we can keep them in the same map.\n */\n\n\nvar observerCallbacks = new WeakMap();\n/**\n * Multiple observers can be created for multiple element/document roots. Each with\n * different settings. So here we store dictionaries of observers to each root,\n * using serialised settings (threshold/margin) as lookup keys.\n */\n\nvar observers = new WeakMap();\n\nvar fireObserverCallback = function (entry) {\n  var _a;\n\n  (_a = observerCallbacks.get(entry.target)) === null || _a === void 0 ? void 0 : _a(entry);\n};\n\nvar fireAllObserverCallbacks = function (entries) {\n  entries.forEach(fireObserverCallback);\n};\n\nfunction initIntersectionObserver(_a) {\n  var root = _a.root,\n      options = tslib.__rest(_a, [\"root\"]);\n\n  var lookupRoot = root || document;\n  /**\n   * If we don't have an observer lookup map for this root, create one.\n   */\n\n  if (!observers.has(lookupRoot)) {\n    observers.set(lookupRoot, {});\n  }\n\n  var rootObservers = observers.get(lookupRoot);\n  var key = JSON.stringify(options);\n  /**\n   * If we don't have an observer for this combination of root and settings,\n   * create one.\n   */\n\n  if (!rootObservers[key]) {\n    rootObservers[key] = new IntersectionObserver(fireAllObserverCallbacks, tslib.__assign({\n      root: root\n    }, options));\n  }\n\n  return rootObservers[key];\n}\n\nfunction observeIntersection(element, options, callback) {\n  var rootInteresectionObserver = initIntersectionObserver(options);\n  observerCallbacks.set(element, callback);\n  rootInteresectionObserver.observe(element);\n  return function () {\n    observerCallbacks.delete(element);\n    rootInteresectionObserver.unobserve(element);\n  };\n}\n\nfunction useViewport(_a) {\n  var visualElement = _a.visualElement,\n      whileInView = _a.whileInView,\n      onViewportEnter = _a.onViewportEnter,\n      onViewportLeave = _a.onViewportLeave,\n      _b = _a.viewport,\n      viewport = _b === void 0 ? {} : _b;\n  var state = React.useRef({\n    hasEnteredView: false,\n    isInView: false\n  });\n  var shouldObserve = Boolean(whileInView || onViewportEnter || onViewportLeave);\n  if (viewport.once && state.current.hasEnteredView) shouldObserve = false;\n  var useObserver = typeof IntersectionObserver === \"undefined\" ? useMissingIntersectionObserver : useIntersectionObserver;\n  useObserver(shouldObserve, state.current, visualElement, viewport);\n}\n\nvar thresholdNames = {\n  some: 0,\n  all: 1\n};\n\nfunction useIntersectionObserver(shouldObserve, state, visualElement, _a) {\n  var root = _a.root,\n      rootMargin = _a.margin,\n      _b = _a.amount,\n      amount = _b === void 0 ? \"some\" : _b,\n      once = _a.once;\n  React.useEffect(function () {\n    if (!shouldObserve) return;\n    var options = {\n      root: root === null || root === void 0 ? void 0 : root.current,\n      rootMargin: rootMargin,\n      threshold: typeof amount === \"number\" ? amount : thresholdNames[amount]\n    };\n\n    var intersectionCallback = function (entry) {\n      var _a;\n\n      var isIntersecting = entry.isIntersecting;\n      /**\n       * If there's been no change in the viewport state, early return.\n       */\n\n      if (state.isInView === isIntersecting) return;\n      state.isInView = isIntersecting;\n      /**\n       * Handle hasEnteredView. If this is only meant to run once, and\n       * element isn't visible, early return. Otherwise set hasEnteredView to true.\n       */\n\n      if (once && !isIntersecting && state.hasEnteredView) {\n        return;\n      } else if (isIntersecting) {\n        state.hasEnteredView = true;\n      }\n\n      (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.InView, isIntersecting);\n      /**\n       * Use the latest committed props rather than the ones in scope\n       * when this observer is created\n       */\n\n      var props = visualElement.getProps();\n      var callback = isIntersecting ? props.onViewportEnter : props.onViewportLeave;\n      callback === null || callback === void 0 ? void 0 : callback(entry);\n    };\n\n    return observeIntersection(visualElement.getInstance(), options, intersectionCallback);\n  }, [shouldObserve, root, rootMargin, amount]);\n}\n/**\n * If IntersectionObserver is missing, we activate inView and fire onViewportEnter\n * on mount. This way, the page will be in the state the author expects users\n * to see it in for everyone.\n */\n\n\nfunction useMissingIntersectionObserver(shouldObserve, state, visualElement) {\n  React.useEffect(function () {\n    if (!shouldObserve) return;\n\n    if (process.env.NODE_ENV !== \"production\") {\n      warnOnce(false, \"IntersectionObserver not available on this device. whileInView animations will trigger on mount.\");\n    }\n    /**\n     * Fire this in an rAF because, at this point, the animation state\n     * won't have flushed for the first time and there's certain logic in\n     * there that behaves differently on the initial animation.\n     *\n     * This hook should be quite rarely called so setting this in an rAF\n     * is preferred to changing the behaviour of the animation state.\n     */\n\n\n    requestAnimationFrame(function () {\n      var _a;\n\n      state.hasEnteredView = true;\n      var onViewportEnter = visualElement.getProps().onViewportEnter;\n      onViewportEnter === null || onViewportEnter === void 0 ? void 0 : onViewportEnter(null);\n      (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.InView, true);\n    });\n  }, [shouldObserve]);\n}\n\nvar gestureAnimations = {\n  inView: useMotionValue.makeRenderlessComponent(useViewport),\n  tap: useMotionValue.makeRenderlessComponent(useTapGesture),\n  focus: useMotionValue.makeRenderlessComponent(useFocusGesture),\n  hover: useMotionValue.makeRenderlessComponent(useHoverGesture)\n};\n/**\n * @internal\n */\n\nvar PanSession =\n/** @class */\nfunction () {\n  function PanSession(event, handlers, _a) {\n    var _this = this;\n\n    var _b = _a === void 0 ? {} : _a,\n        transformPagePoint = _b.transformPagePoint;\n    /**\n     * @internal\n     */\n\n\n    this.startEvent = null;\n    /**\n     * @internal\n     */\n\n    this.lastMoveEvent = null;\n    /**\n     * @internal\n     */\n\n    this.lastMoveEventInfo = null;\n    /**\n     * @internal\n     */\n\n    this.handlers = {};\n\n    this.updatePoint = function () {\n      if (!(_this.lastMoveEvent && _this.lastMoveEventInfo)) return;\n      var info = getPanInfo(_this.lastMoveEventInfo, _this.history);\n      var isPanStarted = _this.startEvent !== null; // Only start panning if the offset is larger than 3 pixels. If we make it\n      // any larger than this we'll want to reset the pointer history\n      // on the first update to avoid visual snapping to the cursoe.\n\n      var isDistancePastThreshold = popmotion.distance(info.offset, {\n        x: 0,\n        y: 0\n      }) >= 3;\n      if (!isPanStarted && !isDistancePastThreshold) return;\n      var point = info.point;\n      var timestamp = sync.getFrameData().timestamp;\n\n      _this.history.push(tslib.__assign(tslib.__assign({}, point), {\n        timestamp: timestamp\n      }));\n\n      var _a = _this.handlers,\n          onStart = _a.onStart,\n          onMove = _a.onMove;\n\n      if (!isPanStarted) {\n        onStart && onStart(_this.lastMoveEvent, info);\n        _this.startEvent = _this.lastMoveEvent;\n      }\n\n      onMove && onMove(_this.lastMoveEvent, info);\n    };\n\n    this.handlePointerMove = function (event, info) {\n      _this.lastMoveEvent = event;\n      _this.lastMoveEventInfo = transformPoint(info, _this.transformPagePoint); // Because Safari doesn't trigger mouseup events when it's above a `<select>`\n\n      if (useMotionValue.isMouseEvent(event) && event.buttons === 0) {\n        _this.handlePointerUp(event, info);\n\n        return;\n      } // Throttle mouse move event to once per frame\n\n\n      sync__default[\"default\"].update(_this.updatePoint, true);\n    };\n\n    this.handlePointerUp = function (event, info) {\n      _this.end();\n\n      var _a = _this.handlers,\n          onEnd = _a.onEnd,\n          onSessionEnd = _a.onSessionEnd;\n      var panInfo = getPanInfo(transformPoint(info, _this.transformPagePoint), _this.history);\n\n      if (_this.startEvent && onEnd) {\n        onEnd(event, panInfo);\n      }\n\n      onSessionEnd && onSessionEnd(event, panInfo);\n    }; // If we have more than one touch, don't start detecting this gesture\n\n\n    if (useMotionValue.isTouchEvent(event) && event.touches.length > 1) return;\n    this.handlers = handlers;\n    this.transformPagePoint = transformPagePoint;\n    var info = useMotionValue.extractEventInfo(event);\n    var initialInfo = transformPoint(info, this.transformPagePoint);\n    var point = initialInfo.point;\n    var timestamp = sync.getFrameData().timestamp;\n    this.history = [tslib.__assign(tslib.__assign({}, point), {\n      timestamp: timestamp\n    })];\n    var onSessionStart = handlers.onSessionStart;\n    onSessionStart && onSessionStart(event, getPanInfo(initialInfo, this.history));\n    this.removeListeners = popmotion.pipe(useMotionValue.addPointerEvent(window, \"pointermove\", this.handlePointerMove), useMotionValue.addPointerEvent(window, \"pointerup\", this.handlePointerUp), useMotionValue.addPointerEvent(window, \"pointercancel\", this.handlePointerUp));\n  }\n\n  PanSession.prototype.updateHandlers = function (handlers) {\n    this.handlers = handlers;\n  };\n\n  PanSession.prototype.end = function () {\n    this.removeListeners && this.removeListeners();\n    sync.cancelSync.update(this.updatePoint);\n  };\n\n  return PanSession;\n}();\n\nfunction transformPoint(info, transformPagePoint) {\n  return transformPagePoint ? {\n    point: transformPagePoint(info.point)\n  } : info;\n}\n\nfunction subtractPoint(a, b) {\n  return {\n    x: a.x - b.x,\n    y: a.y - b.y\n  };\n}\n\nfunction getPanInfo(_a, history) {\n  var point = _a.point;\n  return {\n    point: point,\n    delta: subtractPoint(point, lastDevicePoint(history)),\n    offset: subtractPoint(point, startDevicePoint(history)),\n    velocity: getVelocity(history, 0.1)\n  };\n}\n\nfunction startDevicePoint(history) {\n  return history[0];\n}\n\nfunction lastDevicePoint(history) {\n  return history[history.length - 1];\n}\n\nfunction getVelocity(history, timeDelta) {\n  if (history.length < 2) {\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n\n  var i = history.length - 1;\n  var timestampedPoint = null;\n  var lastPoint = lastDevicePoint(history);\n\n  while (i >= 0) {\n    timestampedPoint = history[i];\n\n    if (lastPoint.timestamp - timestampedPoint.timestamp > useMotionValue.secondsToMilliseconds(timeDelta)) {\n      break;\n    }\n\n    i--;\n  }\n\n  if (!timestampedPoint) {\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n\n  var time = (lastPoint.timestamp - timestampedPoint.timestamp) / 1000;\n\n  if (time === 0) {\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n\n  var currentVelocity = {\n    x: (lastPoint.x - timestampedPoint.x) / time,\n    y: (lastPoint.y - timestampedPoint.y) / time\n  };\n\n  if (currentVelocity.x === Infinity) {\n    currentVelocity.x = 0;\n  }\n\n  if (currentVelocity.y === Infinity) {\n    currentVelocity.y = 0;\n  }\n\n  return currentVelocity;\n}\n/**\n * Apply constraints to a point. These constraints are both physical along an\n * axis, and an elastic factor that determines how much to constrain the point\n * by if it does lie outside the defined parameters.\n */\n\n\nfunction applyConstraints(point, _a, elastic) {\n  var min = _a.min,\n      max = _a.max;\n\n  if (min !== undefined && point < min) {\n    // If we have a min point defined, and this is outside of that, constrain\n    point = elastic ? popmotion.mix(min, point, elastic.min) : Math.max(point, min);\n  } else if (max !== undefined && point > max) {\n    // If we have a max point defined, and this is outside of that, constrain\n    point = elastic ? popmotion.mix(max, point, elastic.max) : Math.min(point, max);\n  }\n\n  return point;\n}\n/**\n * Calculate constraints in terms of the viewport when defined relatively to the\n * measured axis. This is measured from the nearest edge, so a max constraint of 200\n * on an axis with a max value of 300 would return a constraint of 500 - axis length\n */\n\n\nfunction calcRelativeAxisConstraints(axis, min, max) {\n  return {\n    min: min !== undefined ? axis.min + min : undefined,\n    max: max !== undefined ? axis.max + max - (axis.max - axis.min) : undefined\n  };\n}\n/**\n * Calculate constraints in terms of the viewport when\n * defined relatively to the measured bounding box.\n */\n\n\nfunction calcRelativeConstraints(layoutBox, _a) {\n  var top = _a.top,\n      left = _a.left,\n      bottom = _a.bottom,\n      right = _a.right;\n  return {\n    x: calcRelativeAxisConstraints(layoutBox.x, left, right),\n    y: calcRelativeAxisConstraints(layoutBox.y, top, bottom)\n  };\n}\n/**\n * Calculate viewport constraints when defined as another viewport-relative axis\n */\n\n\nfunction calcViewportAxisConstraints(layoutAxis, constraintsAxis) {\n  var _a;\n\n  var min = constraintsAxis.min - layoutAxis.min;\n  var max = constraintsAxis.max - layoutAxis.max; // If the constraints axis is actually smaller than the layout axis then we can\n  // flip the constraints\n\n  if (constraintsAxis.max - constraintsAxis.min < layoutAxis.max - layoutAxis.min) {\n    _a = tslib.__read([max, min], 2), min = _a[0], max = _a[1];\n  }\n\n  return {\n    min: min,\n    max: max\n  };\n}\n/**\n * Calculate viewport constraints when defined as another viewport-relative box\n */\n\n\nfunction calcViewportConstraints(layoutBox, constraintsBox) {\n  return {\n    x: calcViewportAxisConstraints(layoutBox.x, constraintsBox.x),\n    y: calcViewportAxisConstraints(layoutBox.y, constraintsBox.y)\n  };\n}\n/**\n * Calculate a transform origin relative to the source axis, between 0-1, that results\n * in an asthetically pleasing scale/transform needed to project from source to target.\n */\n\n\nfunction calcOrigin(source, target) {\n  var origin = 0.5;\n  var sourceLength = useMotionValue.calcLength(source);\n  var targetLength = useMotionValue.calcLength(target);\n\n  if (targetLength > sourceLength) {\n    origin = popmotion.progress(target.min, target.max - sourceLength, source.min);\n  } else if (sourceLength > targetLength) {\n    origin = popmotion.progress(source.min, source.max - targetLength, target.min);\n  }\n\n  return popmotion.clamp(0, 1, origin);\n}\n/**\n * Rebase the calculated viewport constraints relative to the layout.min point.\n */\n\n\nfunction rebaseAxisConstraints(layout, constraints) {\n  var relativeConstraints = {};\n\n  if (constraints.min !== undefined) {\n    relativeConstraints.min = constraints.min - layout.min;\n  }\n\n  if (constraints.max !== undefined) {\n    relativeConstraints.max = constraints.max - layout.min;\n  }\n\n  return relativeConstraints;\n}\n\nvar defaultElastic = 0.35;\n/**\n * Accepts a dragElastic prop and returns resolved elastic values for each axis.\n */\n\nfunction resolveDragElastic(dragElastic) {\n  if (dragElastic === void 0) {\n    dragElastic = defaultElastic;\n  }\n\n  if (dragElastic === false) {\n    dragElastic = 0;\n  } else if (dragElastic === true) {\n    dragElastic = defaultElastic;\n  }\n\n  return {\n    x: resolveAxisElastic(dragElastic, \"left\", \"right\"),\n    y: resolveAxisElastic(dragElastic, \"top\", \"bottom\")\n  };\n}\n\nfunction resolveAxisElastic(dragElastic, minLabel, maxLabel) {\n  return {\n    min: resolvePointElastic(dragElastic, minLabel),\n    max: resolvePointElastic(dragElastic, maxLabel)\n  };\n}\n\nfunction resolvePointElastic(dragElastic, label) {\n  var _a;\n\n  return typeof dragElastic === \"number\" ? dragElastic : (_a = dragElastic[label]) !== null && _a !== void 0 ? _a : 0;\n}\n/**\n * Bounding boxes tend to be defined as top, left, right, bottom. For various operations\n * it's easier to consider each axis individually. This function returns a bounding box\n * as a map of single-axis min/max values.\n */\n\n\nfunction convertBoundingBoxToBox(_a) {\n  var top = _a.top,\n      left = _a.left,\n      right = _a.right,\n      bottom = _a.bottom;\n  return {\n    x: {\n      min: left,\n      max: right\n    },\n    y: {\n      min: top,\n      max: bottom\n    }\n  };\n}\n\nfunction convertBoxToBoundingBox(_a) {\n  var x = _a.x,\n      y = _a.y;\n  return {\n    top: y.min,\n    right: x.max,\n    bottom: y.max,\n    left: x.min\n  };\n}\n/**\n * Applies a TransformPoint function to a bounding box. TransformPoint is usually a function\n * provided by Framer to allow measured points to be corrected for device scaling. This is used\n * when measuring DOM elements and DOM event points.\n */\n\n\nfunction transformBoxPoints(point, transformPoint) {\n  if (!transformPoint) return point;\n  var topLeft = transformPoint({\n    x: point.left,\n    y: point.top\n  });\n  var bottomRight = transformPoint({\n    x: point.right,\n    y: point.bottom\n  });\n  return {\n    top: topLeft.y,\n    left: topLeft.x,\n    bottom: bottomRight.y,\n    right: bottomRight.x\n  };\n}\n\nfunction measureViewportBox(instance, transformPoint) {\n  return convertBoundingBoxToBox(transformBoxPoints(instance.getBoundingClientRect(), transformPoint));\n}\n\nfunction measurePageBox(element, rootProjectionNode, transformPagePoint) {\n  var viewportBox = measureViewportBox(element, transformPagePoint);\n  var scroll = rootProjectionNode.scroll;\n\n  if (scroll) {\n    useMotionValue.translateAxis(viewportBox.x, scroll.x);\n    useMotionValue.translateAxis(viewportBox.y, scroll.y);\n  }\n\n  return viewportBox;\n}\n\nvar elementDragControls = new WeakMap();\n/**\n *\n */\n// let latestPointerEvent: AnyPointerEvent\n\nvar VisualElementDragControls =\n/** @class */\nfunction () {\n  function VisualElementDragControls(visualElement) {\n    // This is a reference to the global drag gesture lock, ensuring only one component\n    // can \"capture\" the drag of one or both axes.\n    // TODO: Look into moving this into pansession?\n    this.openGlobalLock = null;\n    this.isDragging = false;\n    this.currentDirection = null;\n    this.originPoint = {\n      x: 0,\n      y: 0\n    };\n    /**\n     * The permitted boundaries of travel, in pixels.\n     */\n\n    this.constraints = false;\n    this.hasMutatedConstraints = false;\n    /**\n     * The per-axis resolved elastic values.\n     */\n\n    this.elastic = useMotionValue.createBox();\n    this.visualElement = visualElement;\n  }\n\n  VisualElementDragControls.prototype.start = function (originEvent, _a) {\n    var _this = this;\n\n    var _b = _a === void 0 ? {} : _a,\n        _c = _b.snapToCursor,\n        snapToCursor = _c === void 0 ? false : _c;\n    /**\n     * Don't start dragging if this component is exiting\n     */\n\n\n    if (this.visualElement.isPresent === false) return;\n\n    var onSessionStart = function (event) {\n      // Stop any animations on both axis values immediately. This allows the user to throw and catch\n      // the component.\n      _this.stopAnimation();\n\n      if (snapToCursor) {\n        _this.snapToCursor(useMotionValue.extractEventInfo(event, \"page\").point);\n      }\n    };\n\n    var onStart = function (event, info) {\n      var _a; // Attempt to grab the global drag gesture lock - maybe make this part of PanSession\n\n\n      var _b = _this.getProps(),\n          drag = _b.drag,\n          dragPropagation = _b.dragPropagation,\n          onDragStart = _b.onDragStart;\n\n      if (drag && !dragPropagation) {\n        if (_this.openGlobalLock) _this.openGlobalLock();\n        _this.openGlobalLock = useMotionValue.getGlobalLock(drag); // If we don 't have the lock, don't start dragging\n\n        if (!_this.openGlobalLock) return;\n      }\n\n      _this.isDragging = true;\n      _this.currentDirection = null;\n\n      _this.resolveConstraints();\n\n      if (_this.visualElement.projection) {\n        _this.visualElement.projection.isAnimationBlocked = true;\n        _this.visualElement.projection.target = undefined;\n      }\n      /**\n       * Record gesture origin\n       */\n\n\n      useMotionValue.eachAxis(function (axis) {\n        var _a, _b;\n\n        var current = _this.getAxisMotionValue(axis).get() || 0;\n        /**\n         * If the MotionValue is a percentage value convert to px\n         */\n\n        if (styleValueTypes.percent.test(current)) {\n          var measuredAxis = (_b = (_a = _this.visualElement.projection) === null || _a === void 0 ? void 0 : _a.layout) === null || _b === void 0 ? void 0 : _b.actual[axis];\n\n          if (measuredAxis) {\n            var length_1 = useMotionValue.calcLength(measuredAxis);\n            current = length_1 * (parseFloat(current) / 100);\n          }\n        }\n\n        _this.originPoint[axis] = current;\n      }); // Fire onDragStart event\n\n      onDragStart === null || onDragStart === void 0 ? void 0 : onDragStart(event, info);\n      (_a = _this.visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Drag, true);\n    };\n\n    var onMove = function (event, info) {\n      // latestPointerEvent = event\n      var _a = _this.getProps(),\n          dragPropagation = _a.dragPropagation,\n          dragDirectionLock = _a.dragDirectionLock,\n          onDirectionLock = _a.onDirectionLock,\n          onDrag = _a.onDrag; // If we didn't successfully receive the gesture lock, early return.\n\n\n      if (!dragPropagation && !_this.openGlobalLock) return;\n      var offset = info.offset; // Attempt to detect drag direction if directionLock is true\n\n      if (dragDirectionLock && _this.currentDirection === null) {\n        _this.currentDirection = getCurrentDirection(offset); // If we've successfully set a direction, notify listener\n\n        if (_this.currentDirection !== null) {\n          onDirectionLock === null || onDirectionLock === void 0 ? void 0 : onDirectionLock(_this.currentDirection);\n        }\n\n        return;\n      } // Update each point with the latest position\n\n\n      _this.updateAxis(\"x\", info.point, offset);\n\n      _this.updateAxis(\"y\", info.point, offset);\n      /**\n       * Ideally we would leave the renderer to fire naturally at the end of\n       * this frame but if the element is about to change layout as the result\n       * of a re-render we want to ensure the browser can read the latest\n       * bounding box to ensure the pointer and element don't fall out of sync.\n       */\n\n\n      _this.visualElement.syncRender();\n      /**\n       * This must fire after the syncRender call as it might trigger a state\n       * change which itself might trigger a layout update.\n       */\n\n\n      onDrag === null || onDrag === void 0 ? void 0 : onDrag(event, info);\n    };\n\n    var onSessionEnd = function (event, info) {\n      return _this.stop(event, info);\n    };\n\n    this.panSession = new PanSession(originEvent, {\n      onSessionStart: onSessionStart,\n      onStart: onStart,\n      onMove: onMove,\n      onSessionEnd: onSessionEnd\n    }, {\n      transformPagePoint: this.visualElement.getTransformPagePoint()\n    });\n  };\n\n  VisualElementDragControls.prototype.stop = function (event, info) {\n    var isDragging = this.isDragging;\n    this.cancel();\n    if (!isDragging) return;\n    var velocity = info.velocity;\n    this.startAnimation(velocity);\n    var onDragEnd = this.getProps().onDragEnd;\n    onDragEnd === null || onDragEnd === void 0 ? void 0 : onDragEnd(event, info);\n  };\n\n  VisualElementDragControls.prototype.cancel = function () {\n    var _a, _b;\n\n    this.isDragging = false;\n\n    if (this.visualElement.projection) {\n      this.visualElement.projection.isAnimationBlocked = false;\n    }\n\n    (_a = this.panSession) === null || _a === void 0 ? void 0 : _a.end();\n    this.panSession = undefined;\n    var dragPropagation = this.getProps().dragPropagation;\n\n    if (!dragPropagation && this.openGlobalLock) {\n      this.openGlobalLock();\n      this.openGlobalLock = null;\n    }\n\n    (_b = this.visualElement.animationState) === null || _b === void 0 ? void 0 : _b.setActive(useMotionValue.AnimationType.Drag, false);\n  };\n\n  VisualElementDragControls.prototype.updateAxis = function (axis, _point, offset) {\n    var drag = this.getProps().drag; // If we're not dragging this axis, do an early return.\n\n    if (!offset || !shouldDrag(axis, drag, this.currentDirection)) return;\n    var axisValue = this.getAxisMotionValue(axis);\n    var next = this.originPoint[axis] + offset[axis]; // Apply constraints\n\n    if (this.constraints && this.constraints[axis]) {\n      next = applyConstraints(next, this.constraints[axis], this.elastic[axis]);\n    }\n\n    axisValue.set(next);\n  };\n\n  VisualElementDragControls.prototype.resolveConstraints = function () {\n    var _this = this;\n\n    var _a = this.getProps(),\n        dragConstraints = _a.dragConstraints,\n        dragElastic = _a.dragElastic;\n\n    var layout = (this.visualElement.projection || {}).layout;\n    var prevConstraints = this.constraints;\n\n    if (dragConstraints && useMotionValue.isRefObject(dragConstraints)) {\n      if (!this.constraints) {\n        this.constraints = this.resolveRefConstraints();\n      }\n    } else {\n      if (dragConstraints && layout) {\n        this.constraints = calcRelativeConstraints(layout.actual, dragConstraints);\n      } else {\n        this.constraints = false;\n      }\n    }\n\n    this.elastic = resolveDragElastic(dragElastic);\n    /**\n     * If we're outputting to external MotionValues, we want to rebase the measured constraints\n     * from viewport-relative to component-relative.\n     */\n\n    if (prevConstraints !== this.constraints && layout && this.constraints && !this.hasMutatedConstraints) {\n      useMotionValue.eachAxis(function (axis) {\n        if (_this.getAxisMotionValue(axis)) {\n          _this.constraints[axis] = rebaseAxisConstraints(layout.actual[axis], _this.constraints[axis]);\n        }\n      });\n    }\n  };\n\n  VisualElementDragControls.prototype.resolveRefConstraints = function () {\n    var _a = this.getProps(),\n        constraints = _a.dragConstraints,\n        onMeasureDragConstraints = _a.onMeasureDragConstraints;\n\n    if (!constraints || !useMotionValue.isRefObject(constraints)) return false;\n    var constraintsElement = constraints.current;\n    heyListen.invariant(constraintsElement !== null, \"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.\");\n    var projection = this.visualElement.projection; // TODO\n\n    if (!projection || !projection.layout) return false;\n    var constraintsBox = measurePageBox(constraintsElement, projection.root, this.visualElement.getTransformPagePoint());\n    var measuredConstraints = calcViewportConstraints(projection.layout.actual, constraintsBox);\n    /**\n     * If there's an onMeasureDragConstraints listener we call it and\n     * if different constraints are returned, set constraints to that\n     */\n\n    if (onMeasureDragConstraints) {\n      var userConstraints = onMeasureDragConstraints(convertBoxToBoundingBox(measuredConstraints));\n      this.hasMutatedConstraints = !!userConstraints;\n\n      if (userConstraints) {\n        measuredConstraints = convertBoundingBoxToBox(userConstraints);\n      }\n    }\n\n    return measuredConstraints;\n  };\n\n  VisualElementDragControls.prototype.startAnimation = function (velocity) {\n    var _this = this;\n\n    var _a = this.getProps(),\n        drag = _a.drag,\n        dragMomentum = _a.dragMomentum,\n        dragElastic = _a.dragElastic,\n        dragTransition = _a.dragTransition,\n        dragSnapToOrigin = _a.dragSnapToOrigin,\n        onDragTransitionEnd = _a.onDragTransitionEnd;\n\n    var constraints = this.constraints || {};\n    var momentumAnimations = useMotionValue.eachAxis(function (axis) {\n      var _a;\n\n      if (!shouldDrag(axis, drag, _this.currentDirection)) {\n        return;\n      }\n\n      var transition = (_a = constraints === null || constraints === void 0 ? void 0 : constraints[axis]) !== null && _a !== void 0 ? _a : {};\n      if (dragSnapToOrigin) transition = {\n        min: 0,\n        max: 0\n      };\n      /**\n       * Overdamp the boundary spring if `dragElastic` is disabled. There's still a frame\n       * of spring animations so we should look into adding a disable spring option to `inertia`.\n       * We could do something here where we affect the `bounceStiffness` and `bounceDamping`\n       * using the value of `dragElastic`.\n       */\n\n      var bounceStiffness = dragElastic ? 200 : 1000000;\n      var bounceDamping = dragElastic ? 40 : 10000000;\n\n      var inertia = tslib.__assign(tslib.__assign({\n        type: \"inertia\",\n        velocity: dragMomentum ? velocity[axis] : 0,\n        bounceStiffness: bounceStiffness,\n        bounceDamping: bounceDamping,\n        timeConstant: 750,\n        restDelta: 1,\n        restSpeed: 10\n      }, dragTransition), transition); // If we're not animating on an externally-provided `MotionValue` we can use the\n      // component's animation controls which will handle interactions with whileHover (etc),\n      // otherwise we just have to animate the `MotionValue` itself.\n\n\n      return _this.startAxisValueAnimation(axis, inertia);\n    }); // Run all animations and then resolve the new drag constraints.\n\n    return Promise.all(momentumAnimations).then(onDragTransitionEnd);\n  };\n\n  VisualElementDragControls.prototype.startAxisValueAnimation = function (axis, transition) {\n    var axisValue = this.getAxisMotionValue(axis);\n    return useMotionValue.startAnimation(axis, axisValue, 0, transition);\n  };\n\n  VisualElementDragControls.prototype.stopAnimation = function () {\n    var _this = this;\n\n    useMotionValue.eachAxis(function (axis) {\n      return _this.getAxisMotionValue(axis).stop();\n    });\n  };\n  /**\n   * Drag works differently depending on which props are provided.\n   *\n   * - If _dragX and _dragY are provided, we output the gesture delta directly to those motion values.\n   * - Otherwise, we apply the delta to the x/y motion values.\n   */\n\n\n  VisualElementDragControls.prototype.getAxisMotionValue = function (axis) {\n    var _a, _b;\n\n    var dragKey = \"_drag\" + axis.toUpperCase();\n    var externalMotionValue = this.visualElement.getProps()[dragKey];\n    return externalMotionValue ? externalMotionValue : this.visualElement.getValue(axis, (_b = (_a = this.visualElement.getProps().initial) === null || _a === void 0 ? void 0 : _a[axis]) !== null && _b !== void 0 ? _b : 0);\n  };\n\n  VisualElementDragControls.prototype.snapToCursor = function (point) {\n    var _this = this;\n\n    useMotionValue.eachAxis(function (axis) {\n      var drag = _this.getProps().drag; // If we're not dragging this axis, do an early return.\n\n\n      if (!shouldDrag(axis, drag, _this.currentDirection)) return;\n      var projection = _this.visualElement.projection;\n\n      var axisValue = _this.getAxisMotionValue(axis);\n\n      if (projection && projection.layout) {\n        var _a = projection.layout.actual[axis],\n            min = _a.min,\n            max = _a.max;\n        axisValue.set(point[axis] - popmotion.mix(min, max, 0.5));\n      }\n    });\n  };\n  /**\n   * When the viewport resizes we want to check if the measured constraints\n   * have changed and, if so, reposition the element within those new constraints\n   * relative to where it was before the resize.\n   */\n\n\n  VisualElementDragControls.prototype.scalePositionWithinConstraints = function () {\n    var _this = this;\n\n    var _a;\n\n    var _b = this.getProps(),\n        drag = _b.drag,\n        dragConstraints = _b.dragConstraints;\n\n    var projection = this.visualElement.projection;\n    if (!useMotionValue.isRefObject(dragConstraints) || !projection || !this.constraints) return;\n    /**\n     * Stop current animations as there can be visual glitching if we try to do\n     * this mid-animation\n     */\n\n    this.stopAnimation();\n    /**\n     * Record the relative position of the dragged element relative to the\n     * constraints box and save as a progress value.\n     */\n\n    var boxProgress = {\n      x: 0,\n      y: 0\n    };\n    useMotionValue.eachAxis(function (axis) {\n      var axisValue = _this.getAxisMotionValue(axis);\n\n      if (axisValue) {\n        var latest = axisValue.get();\n        boxProgress[axis] = calcOrigin({\n          min: latest,\n          max: latest\n        }, _this.constraints[axis]);\n      }\n    });\n    /**\n     * Update the layout of this element and resolve the latest drag constraints\n     */\n\n    var transformTemplate = this.visualElement.getProps().transformTemplate;\n    this.visualElement.getInstance().style.transform = transformTemplate ? transformTemplate({}, \"\") : \"none\";\n    (_a = projection.root) === null || _a === void 0 ? void 0 : _a.updateScroll();\n    projection.updateLayout();\n    this.resolveConstraints();\n    /**\n     * For each axis, calculate the current progress of the layout axis\n     * within the new constraints.\n     */\n\n    useMotionValue.eachAxis(function (axis) {\n      if (!shouldDrag(axis, drag, null)) return;\n      /**\n       * Calculate a new transform based on the previous box progress\n       */\n\n      var axisValue = _this.getAxisMotionValue(axis);\n\n      var _a = _this.constraints[axis],\n          min = _a.min,\n          max = _a.max;\n      axisValue.set(popmotion.mix(min, max, boxProgress[axis]));\n    });\n  };\n\n  VisualElementDragControls.prototype.addListeners = function () {\n    var _this = this;\n\n    var _a;\n\n    elementDragControls.set(this.visualElement, this);\n    var element = this.visualElement.getInstance();\n    /**\n     * Attach a pointerdown event listener on this DOM element to initiate drag tracking.\n     */\n\n    var stopPointerListener = useMotionValue.addPointerEvent(element, \"pointerdown\", function (event) {\n      var _a = _this.getProps(),\n          drag = _a.drag,\n          _b = _a.dragListener,\n          dragListener = _b === void 0 ? true : _b;\n\n      drag && dragListener && _this.start(event);\n    });\n\n    var measureDragConstraints = function () {\n      var dragConstraints = _this.getProps().dragConstraints;\n\n      if (useMotionValue.isRefObject(dragConstraints)) {\n        _this.constraints = _this.resolveRefConstraints();\n      }\n    };\n\n    var projection = this.visualElement.projection;\n    var stopMeasureLayoutListener = projection.addEventListener(\"measure\", measureDragConstraints);\n\n    if (projection && !projection.layout) {\n      (_a = projection.root) === null || _a === void 0 ? void 0 : _a.updateScroll();\n      projection.updateLayout();\n    }\n\n    measureDragConstraints();\n    /**\n     * Attach a window resize listener to scale the draggable target within its defined\n     * constraints as the window resizes.\n     */\n\n    var stopResizeListener = useMotionValue.addDomEvent(window, \"resize\", function () {\n      _this.scalePositionWithinConstraints();\n    });\n    /**\n     * If the element's layout changes, calculate the delta and apply that to\n     * the drag gesture's origin point.\n     */\n\n    projection.addEventListener(\"didUpdate\", function (_a) {\n      var delta = _a.delta,\n          hasLayoutChanged = _a.hasLayoutChanged;\n\n      if (_this.isDragging && hasLayoutChanged) {\n        useMotionValue.eachAxis(function (axis) {\n          var motionValue = _this.getAxisMotionValue(axis);\n\n          if (!motionValue) return;\n          _this.originPoint[axis] += delta[axis].translate;\n          motionValue.set(motionValue.get() + delta[axis].translate);\n        });\n\n        _this.visualElement.syncRender();\n      }\n    });\n    return function () {\n      stopResizeListener();\n      stopPointerListener();\n      stopMeasureLayoutListener();\n    };\n  };\n\n  VisualElementDragControls.prototype.getProps = function () {\n    var props = this.visualElement.getProps();\n    var _a = props.drag,\n        drag = _a === void 0 ? false : _a,\n        _b = props.dragDirectionLock,\n        dragDirectionLock = _b === void 0 ? false : _b,\n        _c = props.dragPropagation,\n        dragPropagation = _c === void 0 ? false : _c,\n        _d = props.dragConstraints,\n        dragConstraints = _d === void 0 ? false : _d,\n        _e = props.dragElastic,\n        dragElastic = _e === void 0 ? defaultElastic : _e,\n        _f = props.dragMomentum,\n        dragMomentum = _f === void 0 ? true : _f;\n    return tslib.__assign(tslib.__assign({}, props), {\n      drag: drag,\n      dragDirectionLock: dragDirectionLock,\n      dragPropagation: dragPropagation,\n      dragConstraints: dragConstraints,\n      dragElastic: dragElastic,\n      dragMomentum: dragMomentum\n    });\n  };\n\n  return VisualElementDragControls;\n}();\n\nfunction shouldDrag(direction, drag, currentDirection) {\n  return (drag === true || drag === direction) && (currentDirection === null || currentDirection === direction);\n}\n/**\n * Based on an x/y offset determine the current drag direction. If both axis' offsets are lower\n * than the provided threshold, return `null`.\n *\n * @param offset - The x/y offset from origin.\n * @param lockThreshold - (Optional) - the minimum absolute offset before we can determine a drag direction.\n */\n\n\nfunction getCurrentDirection(offset, lockThreshold) {\n  if (lockThreshold === void 0) {\n    lockThreshold = 10;\n  }\n\n  var direction = null;\n\n  if (Math.abs(offset.y) > lockThreshold) {\n    direction = \"y\";\n  } else if (Math.abs(offset.x) > lockThreshold) {\n    direction = \"x\";\n  }\n\n  return direction;\n}\n/**\n * A hook that allows an element to be dragged.\n *\n * @internal\n */\n\n\nfunction useDrag(props) {\n  var groupDragControls = props.dragControls,\n      visualElement = props.visualElement;\n  var dragControls = useMotionValue.useConstant(function () {\n    return new VisualElementDragControls(visualElement);\n  }); // If we've been provided a DragControls for manual control over the drag gesture,\n  // subscribe this component to it on mount.\n\n  React.useEffect(function () {\n    return groupDragControls && groupDragControls.subscribe(dragControls);\n  }, [dragControls, groupDragControls]); // Apply the event listeners to the element\n\n  React.useEffect(function () {\n    return dragControls.addListeners();\n  }, [dragControls]);\n}\n/**\n *\n * @param handlers -\n * @param ref -\n *\n * @internalremarks\n * Currently this sets new pan gesture functions every render. The memo route has been explored\n * in the past but ultimately we're still creating new functions every render. An optimisation\n * to explore is creating the pan gestures and loading them into a `ref`.\n *\n * @internal\n */\n\n\nfunction usePanGesture(_a) {\n  var onPan = _a.onPan,\n      onPanStart = _a.onPanStart,\n      onPanEnd = _a.onPanEnd,\n      onPanSessionStart = _a.onPanSessionStart,\n      visualElement = _a.visualElement;\n  var hasPanEvents = onPan || onPanStart || onPanEnd || onPanSessionStart;\n  var panSession = React.useRef(null);\n  var transformPagePoint = React.useContext(useMotionValue.MotionConfigContext).transformPagePoint;\n  var handlers = {\n    onSessionStart: onPanSessionStart,\n    onStart: onPanStart,\n    onMove: onPan,\n    onEnd: function (event, info) {\n      panSession.current = null;\n      onPanEnd && onPanEnd(event, info);\n    }\n  };\n  React.useEffect(function () {\n    if (panSession.current !== null) {\n      panSession.current.updateHandlers(handlers);\n    }\n  });\n\n  function onPointerDown(event) {\n    panSession.current = new PanSession(event, handlers, {\n      transformPagePoint: transformPagePoint\n    });\n  }\n\n  useMotionValue.usePointerEvent(visualElement, \"pointerdown\", hasPanEvents && onPointerDown);\n  useMotionValue.useUnmountEffect(function () {\n    return panSession.current && panSession.current.end();\n  });\n}\n\nvar drag = {\n  pan: useMotionValue.makeRenderlessComponent(usePanGesture),\n  drag: useMotionValue.makeRenderlessComponent(useDrag)\n};\n\nfunction isCSSVariable(value) {\n  return typeof value === \"string\" && value.startsWith(\"var(--\");\n}\n/**\n * Parse Framer's special CSS variable format into a CSS token and a fallback.\n *\n * ```\n * `var(--foo, #fff)` => [`--foo`, '#fff']\n * ```\n *\n * @param current\n */\n\n\nvar cssVariableRegex = /var\\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\\)/;\n\nfunction parseCSSVariable(current) {\n  var match = cssVariableRegex.exec(current);\n  if (!match) return [,];\n\n  var _a = tslib.__read(match, 3),\n      token = _a[1],\n      fallback = _a[2];\n\n  return [token, fallback];\n}\n\nvar maxDepth = 4;\n\nfunction getVariableValue(current, element, depth) {\n  if (depth === void 0) {\n    depth = 1;\n  }\n\n  heyListen.invariant(depth <= maxDepth, \"Max CSS variable fallback depth detected in property \\\"\".concat(current, \"\\\". This may indicate a circular fallback dependency.\"));\n\n  var _a = tslib.__read(parseCSSVariable(current), 2),\n      token = _a[0],\n      fallback = _a[1]; // No CSS variable detected\n\n\n  if (!token) return; // Attempt to read this CSS variable off the element\n\n  var resolved = window.getComputedStyle(element).getPropertyValue(token);\n\n  if (resolved) {\n    return resolved.trim();\n  } else if (isCSSVariable(fallback)) {\n    // The fallback might itself be a CSS variable, in which case we attempt to resolve it too.\n    return getVariableValue(fallback, element, depth + 1);\n  } else {\n    return fallback;\n  }\n}\n/**\n * Resolve CSS variables from\n *\n * @internal\n */\n\n\nfunction resolveCSSVariables(visualElement, _a, transitionEnd) {\n  var _b;\n\n  var target = tslib.__rest(_a, []);\n\n  var element = visualElement.getInstance();\n  if (!(element instanceof Element)) return {\n    target: target,\n    transitionEnd: transitionEnd\n  }; // If `transitionEnd` isn't `undefined`, clone it. We could clone `target` and `transitionEnd`\n  // only if they change but I think this reads clearer and this isn't a performance-critical path.\n\n  if (transitionEnd) {\n    transitionEnd = tslib.__assign({}, transitionEnd);\n  } // Go through existing `MotionValue`s and ensure any existing CSS variables are resolved\n\n\n  visualElement.forEachValue(function (value) {\n    var current = value.get();\n    if (!isCSSVariable(current)) return;\n    var resolved = getVariableValue(current, element);\n    if (resolved) value.set(resolved);\n  }); // Cycle through every target property and resolve CSS variables. Currently\n  // we only read single-var properties like `var(--foo)`, not `calc(var(--foo) + 20px)`\n\n  for (var key in target) {\n    var current = target[key];\n    if (!isCSSVariable(current)) continue;\n    var resolved = getVariableValue(current, element);\n    if (!resolved) continue; // Clone target if it hasn't already been\n\n    target[key] = resolved; // If the user hasn't already set this key on `transitionEnd`, set it to the unresolved\n    // CSS variable. This will ensure that after the animation the component will reflect\n    // changes in the value of the CSS variable.\n\n    if (transitionEnd) (_b = transitionEnd[key]) !== null && _b !== void 0 ? _b : transitionEnd[key] = current;\n  }\n\n  return {\n    target: target,\n    transitionEnd: transitionEnd\n  };\n}\n\nvar positionalKeys = new Set([\"width\", \"height\", \"top\", \"left\", \"right\", \"bottom\", \"x\", \"y\"]);\n\nvar isPositionalKey = function (key) {\n  return positionalKeys.has(key);\n};\n\nvar hasPositionalKey = function (target) {\n  return Object.keys(target).some(isPositionalKey);\n};\n\nvar setAndResetVelocity = function (value, to) {\n  // Looks odd but setting it twice doesn't render, it'll just\n  // set both prev and current to the latest value\n  value.set(to, false);\n  value.set(to);\n};\n\nvar isNumOrPxType = function (v) {\n  return v === styleValueTypes.number || v === styleValueTypes.px;\n};\n\nvar BoundingBoxDimension;\n\n(function (BoundingBoxDimension) {\n  BoundingBoxDimension[\"width\"] = \"width\";\n  BoundingBoxDimension[\"height\"] = \"height\";\n  BoundingBoxDimension[\"left\"] = \"left\";\n  BoundingBoxDimension[\"right\"] = \"right\";\n  BoundingBoxDimension[\"top\"] = \"top\";\n  BoundingBoxDimension[\"bottom\"] = \"bottom\";\n})(BoundingBoxDimension || (BoundingBoxDimension = {}));\n\nvar getPosFromMatrix = function (matrix, pos) {\n  return parseFloat(matrix.split(\", \")[pos]);\n};\n\nvar getTranslateFromMatrix = function (pos2, pos3) {\n  return function (_bbox, _a) {\n    var transform = _a.transform;\n    if (transform === \"none\" || !transform) return 0;\n    var matrix3d = transform.match(/^matrix3d\\((.+)\\)$/);\n\n    if (matrix3d) {\n      return getPosFromMatrix(matrix3d[1], pos3);\n    } else {\n      var matrix = transform.match(/^matrix\\((.+)\\)$/);\n\n      if (matrix) {\n        return getPosFromMatrix(matrix[1], pos2);\n      } else {\n        return 0;\n      }\n    }\n  };\n};\n\nvar transformKeys = new Set([\"x\", \"y\", \"z\"]);\nvar nonTranslationalTransformKeys = useMotionValue.transformProps.filter(function (key) {\n  return !transformKeys.has(key);\n});\n\nfunction removeNonTranslationalTransform(visualElement) {\n  var removedTransforms = [];\n  nonTranslationalTransformKeys.forEach(function (key) {\n    var value = visualElement.getValue(key);\n\n    if (value !== undefined) {\n      removedTransforms.push([key, value.get()]);\n      value.set(key.startsWith(\"scale\") ? 1 : 0);\n    }\n  }); // Apply changes to element before measurement\n\n  if (removedTransforms.length) visualElement.syncRender();\n  return removedTransforms;\n}\n\nvar positionalValues = {\n  // Dimensions\n  width: function (_a, _b) {\n    var x = _a.x;\n    var _c = _b.paddingLeft,\n        paddingLeft = _c === void 0 ? \"0\" : _c,\n        _d = _b.paddingRight,\n        paddingRight = _d === void 0 ? \"0\" : _d;\n    return x.max - x.min - parseFloat(paddingLeft) - parseFloat(paddingRight);\n  },\n  height: function (_a, _b) {\n    var y = _a.y;\n    var _c = _b.paddingTop,\n        paddingTop = _c === void 0 ? \"0\" : _c,\n        _d = _b.paddingBottom,\n        paddingBottom = _d === void 0 ? \"0\" : _d;\n    return y.max - y.min - parseFloat(paddingTop) - parseFloat(paddingBottom);\n  },\n  top: function (_bbox, _a) {\n    var top = _a.top;\n    return parseFloat(top);\n  },\n  left: function (_bbox, _a) {\n    var left = _a.left;\n    return parseFloat(left);\n  },\n  bottom: function (_a, _b) {\n    var y = _a.y;\n    var top = _b.top;\n    return parseFloat(top) + (y.max - y.min);\n  },\n  right: function (_a, _b) {\n    var x = _a.x;\n    var left = _b.left;\n    return parseFloat(left) + (x.max - x.min);\n  },\n  // Transform\n  x: getTranslateFromMatrix(4, 13),\n  y: getTranslateFromMatrix(5, 14)\n};\n\nvar convertChangedValueTypes = function (target, visualElement, changedKeys) {\n  var originBbox = visualElement.measureViewportBox();\n  var element = visualElement.getInstance();\n  var elementComputedStyle = getComputedStyle(element);\n  var display = elementComputedStyle.display;\n  var origin = {}; // If the element is currently set to display: \"none\", make it visible before\n  // measuring the target bounding box\n\n  if (display === \"none\") {\n    visualElement.setStaticValue(\"display\", target.display || \"block\");\n  }\n  /**\n   * Record origins before we render and update styles\n   */\n\n\n  changedKeys.forEach(function (key) {\n    origin[key] = positionalValues[key](originBbox, elementComputedStyle);\n  }); // Apply the latest values (as set in checkAndConvertChangedValueTypes)\n\n  visualElement.syncRender();\n  var targetBbox = visualElement.measureViewportBox();\n  changedKeys.forEach(function (key) {\n    // Restore styles to their **calculated computed style**, not their actual\n    // originally set style. This allows us to animate between equivalent pixel units.\n    var value = visualElement.getValue(key);\n    setAndResetVelocity(value, origin[key]);\n    target[key] = positionalValues[key](targetBbox, elementComputedStyle);\n  });\n  return target;\n};\n\nvar checkAndConvertChangedValueTypes = function (visualElement, target, origin, transitionEnd) {\n  if (origin === void 0) {\n    origin = {};\n  }\n\n  if (transitionEnd === void 0) {\n    transitionEnd = {};\n  }\n\n  target = tslib.__assign({}, target);\n  transitionEnd = tslib.__assign({}, transitionEnd);\n  var targetPositionalKeys = Object.keys(target).filter(isPositionalKey); // We want to remove any transform values that could affect the element's bounding box before\n  // it's measured. We'll reapply these later.\n\n  var removedTransformValues = [];\n  var hasAttemptedToRemoveTransformValues = false;\n  var changedValueTypeKeys = [];\n  targetPositionalKeys.forEach(function (key) {\n    var value = visualElement.getValue(key);\n    if (!visualElement.hasValue(key)) return;\n    var from = origin[key];\n    var fromType = useMotionValue.findDimensionValueType(from);\n    var to = target[key];\n    var toType; // TODO: The current implementation of this basically throws an error\n    // if you try and do value conversion via keyframes. There's probably\n    // a way of doing this but the performance implications would need greater scrutiny,\n    // as it'd be doing multiple resize-remeasure operations.\n\n    if (useMotionValue.isKeyframesTarget(to)) {\n      var numKeyframes = to.length;\n      var fromIndex = to[0] === null ? 1 : 0;\n      from = to[fromIndex];\n      fromType = useMotionValue.findDimensionValueType(from);\n\n      for (var i = fromIndex; i < numKeyframes; i++) {\n        if (!toType) {\n          toType = useMotionValue.findDimensionValueType(to[i]);\n          heyListen.invariant(toType === fromType || isNumOrPxType(fromType) && isNumOrPxType(toType), \"Keyframes must be of the same dimension as the current value\");\n        } else {\n          heyListen.invariant(useMotionValue.findDimensionValueType(to[i]) === toType, \"All keyframes must be of the same type\");\n        }\n      }\n    } else {\n      toType = useMotionValue.findDimensionValueType(to);\n    }\n\n    if (fromType !== toType) {\n      // If they're both just number or px, convert them both to numbers rather than\n      // relying on resize/remeasure to convert (which is wasteful in this situation)\n      if (isNumOrPxType(fromType) && isNumOrPxType(toType)) {\n        var current = value.get();\n\n        if (typeof current === \"string\") {\n          value.set(parseFloat(current));\n        }\n\n        if (typeof to === \"string\") {\n          target[key] = parseFloat(to);\n        } else if (Array.isArray(to) && toType === styleValueTypes.px) {\n          target[key] = to.map(parseFloat);\n        }\n      } else if ((fromType === null || fromType === void 0 ? void 0 : fromType.transform) && (toType === null || toType === void 0 ? void 0 : toType.transform) && (from === 0 || to === 0)) {\n        // If one or the other value is 0, it's safe to coerce it to the\n        // type of the other without measurement\n        if (from === 0) {\n          value.set(toType.transform(from));\n        } else {\n          target[key] = fromType.transform(to);\n        }\n      } else {\n        // If we're going to do value conversion via DOM measurements, we first\n        // need to remove non-positional transform values that could affect the bbox measurements.\n        if (!hasAttemptedToRemoveTransformValues) {\n          removedTransformValues = removeNonTranslationalTransform(visualElement);\n          hasAttemptedToRemoveTransformValues = true;\n        }\n\n        changedValueTypeKeys.push(key);\n        transitionEnd[key] = transitionEnd[key] !== undefined ? transitionEnd[key] : target[key];\n        setAndResetVelocity(value, to);\n      }\n    }\n  });\n\n  if (changedValueTypeKeys.length) {\n    var convertedTarget = convertChangedValueTypes(target, visualElement, changedValueTypeKeys); // If we removed transform values, reapply them before the next render\n\n    if (removedTransformValues.length) {\n      removedTransformValues.forEach(function (_a) {\n        var _b = tslib.__read(_a, 2),\n            key = _b[0],\n            value = _b[1];\n\n        visualElement.getValue(key).set(value);\n      });\n    } // Reapply original values\n\n\n    visualElement.syncRender();\n    return {\n      target: convertedTarget,\n      transitionEnd: transitionEnd\n    };\n  } else {\n    return {\n      target: target,\n      transitionEnd: transitionEnd\n    };\n  }\n};\n/**\n * Convert value types for x/y/width/height/top/left/bottom/right\n *\n * Allows animation between `'auto'` -> `'100%'` or `0` -> `'calc(50% - 10vw)'`\n *\n * @internal\n */\n\n\nfunction unitConversion(visualElement, target, origin, transitionEnd) {\n  return hasPositionalKey(target) ? checkAndConvertChangedValueTypes(visualElement, target, origin, transitionEnd) : {\n    target: target,\n    transitionEnd: transitionEnd\n  };\n}\n/**\n * Parse a DOM variant to make it animatable. This involves resolving CSS variables\n * and ensuring animations like \"20%\" => \"calc(50vw)\" are performed in pixels.\n */\n\n\nvar parseDomVariant = function (visualElement, target, origin, transitionEnd) {\n  var resolved = resolveCSSVariables(visualElement, target, transitionEnd);\n  target = resolved.target;\n  transitionEnd = resolved.transitionEnd;\n  return unitConversion(visualElement, target, origin, transitionEnd);\n};\n\nfunction getComputedStyle$1(element) {\n  return window.getComputedStyle(element);\n}\n\nvar htmlConfig = {\n  treeType: \"dom\",\n  readValueFromInstance: function (domElement, key) {\n    if (useMotionValue.isTransformProp(key)) {\n      var defaultType = useMotionValue.getDefaultValueType(key);\n      return defaultType ? defaultType.default || 0 : 0;\n    } else {\n      var computedStyle = getComputedStyle$1(domElement);\n      return (isCSSVariable$1(key) ? computedStyle.getPropertyValue(key) : computedStyle[key]) || 0;\n    }\n  },\n  sortNodePosition: function (a, b) {\n    /**\n     * compareDocumentPosition returns a bitmask, by using the bitwise &\n     * we're returning true if 2 in that bitmask is set to true. 2 is set\n     * to true if b preceeds a.\n     */\n    return a.compareDocumentPosition(b) & 2 ? 1 : -1;\n  },\n  getBaseTarget: function (props, key) {\n    var _a;\n\n    return (_a = props.style) === null || _a === void 0 ? void 0 : _a[key];\n  },\n  measureViewportBox: function (element, _a) {\n    var transformPagePoint = _a.transformPagePoint;\n    return measureViewportBox(element, transformPagePoint);\n  },\n\n  /**\n   * Reset the transform on the current Element. This is called as part\n   * of a batched process across the entire layout tree. To remove this write\n   * cycle it'd be interesting to see if it's possible to \"undo\" all the current\n   * layout transforms up the tree in the same way this.getBoundingBoxWithoutTransforms\n   * works\n   */\n  resetTransform: function (element, domElement, props) {\n    var transformTemplate = props.transformTemplate;\n    domElement.style.transform = transformTemplate ? transformTemplate({}, \"\") : \"none\"; // Ensure that whatever happens next, we restore our transform on the next frame\n\n    element.scheduleRender();\n  },\n  restoreTransform: function (instance, mutableState) {\n    instance.style.transform = mutableState.style.transform;\n  },\n  removeValueFromRenderState: function (key, _a) {\n    var vars = _a.vars,\n        style = _a.style;\n    delete vars[key];\n    delete style[key];\n  },\n\n  /**\n   * Ensure that HTML and Framer-specific value types like `px`->`%` and `Color`\n   * can be animated by Motion.\n   */\n  makeTargetAnimatable: function (element, _a, _b, isMounted) {\n    var transformValues = _b.transformValues;\n\n    if (isMounted === void 0) {\n      isMounted = true;\n    }\n\n    var transition = _a.transition,\n        transitionEnd = _a.transitionEnd,\n        target = tslib.__rest(_a, [\"transition\", \"transitionEnd\"]);\n\n    var origin = useMotionValue.getOrigin(target, transition || {}, element);\n    /**\n     * If Framer has provided a function to convert `Color` etc value types, convert them\n     */\n\n    if (transformValues) {\n      if (transitionEnd) transitionEnd = transformValues(transitionEnd);\n      if (target) target = transformValues(target);\n      if (origin) origin = transformValues(origin);\n    }\n\n    if (isMounted) {\n      useMotionValue.checkTargetForNewValues(element, target, origin);\n      var parsed = parseDomVariant(element, target, origin, transitionEnd);\n      transitionEnd = parsed.transitionEnd;\n      target = parsed.target;\n    }\n\n    return tslib.__assign({\n      transition: transition,\n      transitionEnd: transitionEnd\n    }, target);\n  },\n  scrapeMotionValuesFromProps: scrapeMotionValuesFromProps$1,\n  build: function (element, renderState, latestValues, options, props) {\n    if (element.isVisible !== undefined) {\n      renderState.style.visibility = element.isVisible ? \"visible\" : \"hidden\";\n    }\n\n    buildHTMLStyles(renderState, latestValues, options, props.transformTemplate);\n  },\n  render: renderHTML\n};\nvar htmlVisualElement = useMotionValue.visualElement(htmlConfig);\nvar svgVisualElement = useMotionValue.visualElement(tslib.__assign(tslib.__assign({}, htmlConfig), {\n  getBaseTarget: function (props, key) {\n    return props[key];\n  },\n  readValueFromInstance: function (domElement, key) {\n    var _a;\n\n    if (useMotionValue.isTransformProp(key)) {\n      return ((_a = useMotionValue.getDefaultValueType(key)) === null || _a === void 0 ? void 0 : _a.default) || 0;\n    }\n\n    key = !camelCaseAttributes.has(key) ? camelToDash(key) : key;\n    return domElement.getAttribute(key);\n  },\n  scrapeMotionValuesFromProps: scrapeMotionValuesFromProps,\n  build: function (_element, renderState, latestValues, options, props) {\n    buildSVGAttrs(renderState, latestValues, options, props.transformTemplate);\n  },\n  render: renderSVG\n}));\n\nvar createDomVisualElement = function (Component, options) {\n  return isSVGComponent(Component) ? svgVisualElement(options, {\n    enableHardwareAcceleration: false\n  }) : htmlVisualElement(options, {\n    enableHardwareAcceleration: true\n  });\n};\n\nfunction pixelsToPercent(pixels, axis) {\n  if (axis.max === axis.min) return 0;\n  return pixels / (axis.max - axis.min) * 100;\n}\n/**\n * We always correct borderRadius as a percentage rather than pixels to reduce paints.\n * For example, if you are projecting a box that is 100px wide with a 10px borderRadius\n * into a box that is 200px wide with a 20px borderRadius, that is actually a 10%\n * borderRadius in both states. If we animate between the two in pixels that will trigger\n * a paint each time. If we animate between the two in percentage we'll avoid a paint.\n */\n\n\nvar correctBorderRadius = {\n  correct: function (latest, node) {\n    if (!node.target) return latest;\n    /**\n     * If latest is a string, if it's a percentage we can return immediately as it's\n     * going to be stretched appropriately. Otherwise, if it's a pixel, convert it to a number.\n     */\n\n    if (typeof latest === \"string\") {\n      if (styleValueTypes.px.test(latest)) {\n        latest = parseFloat(latest);\n      } else {\n        return latest;\n      }\n    }\n    /**\n     * If latest is a number, it's a pixel value. We use the current viewportBox to calculate that\n     * pixel value as a percentage of each axis\n     */\n\n\n    var x = pixelsToPercent(latest, node.target.x);\n    var y = pixelsToPercent(latest, node.target.y);\n    return \"\".concat(x, \"% \").concat(y, \"%\");\n  }\n};\nvar varToken = \"_$css\";\nvar correctBoxShadow = {\n  correct: function (latest, _a) {\n    var treeScale = _a.treeScale,\n        projectionDelta = _a.projectionDelta;\n    var original = latest;\n    /**\n     * We need to first strip and store CSS variables from the string.\n     */\n\n    var containsCSSVariables = latest.includes(\"var(\");\n    var cssVariables = [];\n\n    if (containsCSSVariables) {\n      latest = latest.replace(cssVariableRegex, function (match) {\n        cssVariables.push(match);\n        return varToken;\n      });\n    }\n\n    var shadow = styleValueTypes.complex.parse(latest); // TODO: Doesn't support multiple shadows\n\n    if (shadow.length > 5) return original;\n    var template = styleValueTypes.complex.createTransformer(latest);\n    var offset = typeof shadow[0] !== \"number\" ? 1 : 0; // Calculate the overall context scale\n\n    var xScale = projectionDelta.x.scale * treeScale.x;\n    var yScale = projectionDelta.y.scale * treeScale.y;\n    shadow[0 + offset] /= xScale;\n    shadow[1 + offset] /= yScale;\n    /**\n     * Ideally we'd correct x and y scales individually, but because blur and\n     * spread apply to both we have to take a scale average and apply that instead.\n     * We could potentially improve the outcome of this by incorporating the ratio between\n     * the two scales.\n     */\n\n    var averageScale = popmotion.mix(xScale, yScale, 0.5); // Blur\n\n    if (typeof shadow[2 + offset] === \"number\") shadow[2 + offset] /= averageScale; // Spread\n\n    if (typeof shadow[3 + offset] === \"number\") shadow[3 + offset] /= averageScale;\n    var output = template(shadow);\n\n    if (containsCSSVariables) {\n      var i_1 = 0;\n      output = output.replace(varToken, function () {\n        var cssVariable = cssVariables[i_1];\n        i_1++;\n        return cssVariable;\n      });\n    }\n\n    return output;\n  }\n};\n\nvar MeasureLayoutWithContext =\n/** @class */\nfunction (_super) {\n  tslib.__extends(MeasureLayoutWithContext, _super);\n\n  function MeasureLayoutWithContext() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * This only mounts projection nodes for components that\n   * need measuring, we might want to do it for all components\n   * in order to incorporate transforms\n   */\n\n\n  MeasureLayoutWithContext.prototype.componentDidMount = function () {\n    var _this = this;\n\n    var _a = this.props,\n        visualElement = _a.visualElement,\n        layoutGroup = _a.layoutGroup,\n        switchLayoutGroup = _a.switchLayoutGroup,\n        layoutId = _a.layoutId;\n    var projection = visualElement.projection;\n    useMotionValue.addScaleCorrector(defaultScaleCorrectors);\n\n    if (projection) {\n      if (layoutGroup === null || layoutGroup === void 0 ? void 0 : layoutGroup.group) layoutGroup.group.add(projection);\n\n      if ((switchLayoutGroup === null || switchLayoutGroup === void 0 ? void 0 : switchLayoutGroup.register) && layoutId) {\n        switchLayoutGroup.register(projection);\n      }\n\n      projection.root.didUpdate();\n      projection.addEventListener(\"animationComplete\", function () {\n        _this.safeToRemove();\n      });\n      projection.setOptions(tslib.__assign(tslib.__assign({}, projection.options), {\n        onExitComplete: function () {\n          return _this.safeToRemove();\n        }\n      }));\n    }\n\n    useMotionValue.globalProjectionState.hasEverUpdated = true;\n  };\n\n  MeasureLayoutWithContext.prototype.getSnapshotBeforeUpdate = function (prevProps) {\n    var _this = this;\n\n    var _a = this.props,\n        layoutDependency = _a.layoutDependency,\n        visualElement = _a.visualElement,\n        drag = _a.drag,\n        isPresent = _a.isPresent;\n    var projection = visualElement.projection;\n    if (!projection) return null;\n    /**\n     * TODO: We use this data in relegate to determine whether to\n     * promote a previous element. There's no guarantee its presence data\n     * will have updated by this point - if a bug like this arises it will\n     * have to be that we markForRelegation and then find a new lead some other way,\n     * perhaps in didUpdate\n     */\n\n    projection.isPresent = isPresent;\n\n    if (drag || prevProps.layoutDependency !== layoutDependency || layoutDependency === undefined) {\n      projection.willUpdate();\n    } else {\n      this.safeToRemove();\n    }\n\n    if (prevProps.isPresent !== isPresent) {\n      if (isPresent) {\n        projection.promote();\n      } else if (!projection.relegate()) {\n        /**\n         * If there's another stack member taking over from this one,\n         * it's in charge of the exit animation and therefore should\n         * be in charge of the safe to remove. Otherwise we call it here.\n         */\n        sync__default[\"default\"].postRender(function () {\n          var _a;\n\n          if (!((_a = projection.getStack()) === null || _a === void 0 ? void 0 : _a.members.length)) {\n            _this.safeToRemove();\n          }\n        });\n      }\n    }\n\n    return null;\n  };\n\n  MeasureLayoutWithContext.prototype.componentDidUpdate = function () {\n    var projection = this.props.visualElement.projection;\n\n    if (projection) {\n      projection.root.didUpdate();\n\n      if (!projection.currentAnimation && projection.isLead()) {\n        this.safeToRemove();\n      }\n    }\n  };\n\n  MeasureLayoutWithContext.prototype.componentWillUnmount = function () {\n    var _a = this.props,\n        visualElement = _a.visualElement,\n        layoutGroup = _a.layoutGroup,\n        promoteContext = _a.switchLayoutGroup;\n    var projection = visualElement.projection;\n\n    if (projection) {\n      projection.scheduleCheckAfterUnmount();\n      if (layoutGroup === null || layoutGroup === void 0 ? void 0 : layoutGroup.group) layoutGroup.group.remove(projection);\n      if (promoteContext === null || promoteContext === void 0 ? void 0 : promoteContext.deregister) promoteContext.deregister(projection);\n    }\n  };\n\n  MeasureLayoutWithContext.prototype.safeToRemove = function () {\n    var safeToRemove = this.props.safeToRemove;\n    safeToRemove === null || safeToRemove === void 0 ? void 0 : safeToRemove();\n  };\n\n  MeasureLayoutWithContext.prototype.render = function () {\n    return null;\n  };\n\n  return MeasureLayoutWithContext;\n}(React__default[\"default\"].Component);\n\nfunction MeasureLayout(props) {\n  var _a = tslib.__read(useMotionValue.usePresence(), 2),\n      isPresent = _a[0],\n      safeToRemove = _a[1];\n\n  var layoutGroup = React.useContext(useMotionValue.LayoutGroupContext);\n  return React__default[\"default\"].createElement(MeasureLayoutWithContext, tslib.__assign({}, props, {\n    layoutGroup: layoutGroup,\n    switchLayoutGroup: React.useContext(useMotionValue.SwitchLayoutGroupContext),\n    isPresent: isPresent,\n    safeToRemove: safeToRemove\n  }));\n}\n\nvar defaultScaleCorrectors = {\n  borderRadius: tslib.__assign(tslib.__assign({}, correctBorderRadius), {\n    applyTo: [\"borderTopLeftRadius\", \"borderTopRightRadius\", \"borderBottomLeftRadius\", \"borderBottomRightRadius\"]\n  }),\n  borderTopLeftRadius: correctBorderRadius,\n  borderTopRightRadius: correctBorderRadius,\n  borderBottomLeftRadius: correctBorderRadius,\n  borderBottomRightRadius: correctBorderRadius,\n  boxShadow: correctBoxShadow\n};\nvar layoutFeatures = {\n  measureLayout: MeasureLayout\n};\nvar DocumentProjectionNode = useMotionValue.createProjectionNode({\n  attachResizeListener: function (ref, notify) {\n    ref.addEventListener(\"resize\", notify, {\n      passive: true\n    });\n    return function () {\n      return ref.removeEventListener(\"resize\", notify);\n    };\n  },\n  measureScroll: function () {\n    return {\n      x: document.documentElement.scrollLeft || document.body.scrollLeft,\n      y: document.documentElement.scrollTop || document.body.scrollTop\n    };\n  }\n});\nvar rootProjectionNode = {\n  current: undefined\n};\nvar HTMLProjectionNode = useMotionValue.createProjectionNode({\n  measureScroll: function (instance) {\n    return {\n      x: instance.scrollLeft,\n      y: instance.scrollTop\n    };\n  },\n  defaultParent: function () {\n    if (!rootProjectionNode.current) {\n      var documentNode = new DocumentProjectionNode(0, {});\n      documentNode.mount(window);\n      documentNode.setOptions({\n        layoutScroll: true\n      });\n      rootProjectionNode.current = documentNode;\n    }\n\n    return rootProjectionNode.current;\n  },\n  resetTransform: function (instance, value) {\n    instance.style.transform = value !== null && value !== void 0 ? value : \"none\";\n  }\n});\n\nvar featureBundle = tslib.__assign(tslib.__assign(tslib.__assign(tslib.__assign({}, useMotionValue.animations), gestureAnimations), drag), layoutFeatures);\n/**\n * HTML & SVG components, optimised for use with gestures and animation. These can be used as\n * drop-in replacements for any HTML & SVG component, all CSS & SVG properties are supported.\n *\n * @public\n */\n\n\nvar motion = /*@__PURE__*/createMotionProxy(function (Component, config) {\n  return createDomMotionConfig(Component, config, featureBundle, createDomVisualElement, HTMLProjectionNode);\n});\n/**\n * Create a DOM `motion` component with the provided string. This is primarily intended\n * as a full alternative to `motion` for consumers who have to support environments that don't\n * support `Proxy`.\n *\n * ```javascript\n * import { createDomMotionComponent } from \"framer-motion\"\n *\n * const motion = {\n *   div: createDomMotionComponent('div')\n * }\n * ```\n *\n * @public\n */\n\nfunction createDomMotionComponent(key) {\n  return useMotionValue.createMotionComponent(createDomMotionConfig(key, {\n    forwardMotionProps: false\n  }, featureBundle, createDomVisualElement, HTMLProjectionNode));\n}\n/**\n * @public\n */\n\n\nvar m = createMotionProxy(createDomMotionConfig);\nvar presenceId = 0;\n\nfunction getPresenceId() {\n  var id = presenceId;\n  presenceId++;\n  return id;\n}\n\nvar PresenceChild = function (_a) {\n  var children = _a.children,\n      initial = _a.initial,\n      isPresent = _a.isPresent,\n      onExitComplete = _a.onExitComplete,\n      custom = _a.custom,\n      presenceAffectsLayout = _a.presenceAffectsLayout;\n  var presenceChildren = useMotionValue.useConstant(newChildrenMap);\n  var id = useMotionValue.useConstant(getPresenceId);\n  var context = React.useMemo(function () {\n    return {\n      id: id,\n      initial: initial,\n      isPresent: isPresent,\n      custom: custom,\n      onExitComplete: function (childId) {\n        var e_1, _a;\n\n        presenceChildren.set(childId, true);\n\n        try {\n          for (var _b = tslib.__values(presenceChildren.values()), _c = _b.next(); !_c.done; _c = _b.next()) {\n            var isComplete = _c.value;\n            if (!isComplete) return; // can stop searching when any is incomplete\n          }\n        } catch (e_1_1) {\n          e_1 = {\n            error: e_1_1\n          };\n        } finally {\n          try {\n            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n          } finally {\n            if (e_1) throw e_1.error;\n          }\n        }\n\n        onExitComplete === null || onExitComplete === void 0 ? void 0 : onExitComplete();\n      },\n      register: function (childId) {\n        presenceChildren.set(childId, false);\n        return function () {\n          return presenceChildren.delete(childId);\n        };\n      }\n    };\n  },\n  /**\n   * If the presence of a child affects the layout of the components around it,\n   * we want to make a new context value to ensure they get re-rendered\n   * so they can detect that layout change.\n   */\n  presenceAffectsLayout ? undefined : [isPresent]);\n  React.useMemo(function () {\n    presenceChildren.forEach(function (_, key) {\n      return presenceChildren.set(key, false);\n    });\n  }, [isPresent]);\n  /**\n   * If there's no `motion` components to fire exit animations, we want to remove this\n   * component immediately.\n   */\n\n  React__namespace.useEffect(function () {\n    !isPresent && !presenceChildren.size && (onExitComplete === null || onExitComplete === void 0 ? void 0 : onExitComplete());\n  }, [isPresent]);\n  return React__namespace.createElement(useMotionValue.PresenceContext.Provider, {\n    value: context\n  }, children);\n};\n\nfunction newChildrenMap() {\n  return new Map();\n}\n\nfunction getChildKey(child) {\n  return child.key || \"\";\n}\n\nfunction updateChildLookup(children, allChildren) {\n  var seenChildren = process.env.NODE_ENV !== \"production\" ? new Set() : null;\n  children.forEach(function (child) {\n    var key = getChildKey(child);\n\n    if (process.env.NODE_ENV !== \"production\" && seenChildren) {\n      if (seenChildren.has(key)) {\n        console.warn(\"Children of AnimatePresence require unique keys. \\\"\".concat(key, \"\\\" is a duplicate.\"));\n      }\n\n      seenChildren.add(key);\n    }\n\n    allChildren.set(key, child);\n  });\n}\n\nfunction onlyElements(children) {\n  var filtered = []; // We use forEach here instead of map as map mutates the component key by preprending `.$`\n\n  React.Children.forEach(children, function (child) {\n    if (React.isValidElement(child)) filtered.push(child);\n  });\n  return filtered;\n}\n/**\n * `AnimatePresence` enables the animation of components that have been removed from the tree.\n *\n * When adding/removing more than a single child, every child **must** be given a unique `key` prop.\n *\n * Any `motion` components that have an `exit` property defined will animate out when removed from\n * the tree.\n *\n * ```jsx\n * import { motion, AnimatePresence } from 'framer-motion'\n *\n * export const Items = ({ items }) => (\n *   <AnimatePresence>\n *     {items.map(item => (\n *       <motion.div\n *         key={item.id}\n *         initial={{ opacity: 0 }}\n *         animate={{ opacity: 1 }}\n *         exit={{ opacity: 0 }}\n *       />\n *     ))}\n *   </AnimatePresence>\n * )\n * ```\n *\n * You can sequence exit animations throughout a tree using variants.\n *\n * If a child contains multiple `motion` components with `exit` props, it will only unmount the child\n * once all `motion` components have finished animating out. Likewise, any components using\n * `usePresence` all need to call `safeToRemove`.\n *\n * @public\n */\n\n\nvar AnimatePresence = function (_a) {\n  var children = _a.children,\n      custom = _a.custom,\n      _b = _a.initial,\n      initial = _b === void 0 ? true : _b,\n      onExitComplete = _a.onExitComplete,\n      exitBeforeEnter = _a.exitBeforeEnter,\n      _c = _a.presenceAffectsLayout,\n      presenceAffectsLayout = _c === void 0 ? true : _c; // We want to force a re-render once all exiting animations have finished. We\n  // either use a local forceRender function, or one from a parent context if it exists.\n\n  var _d = tslib.__read(useMotionValue.useForceUpdate(), 1),\n      forceRender = _d[0];\n\n  var forceRenderLayoutGroup = React.useContext(useMotionValue.LayoutGroupContext).forceRender;\n  if (forceRenderLayoutGroup) forceRender = forceRenderLayoutGroup;\n  var isInitialRender = React.useRef(true);\n  var isMounted = React.useRef(true);\n  React.useEffect(function () {\n    return function () {\n      isMounted.current = false;\n    };\n  }, []); // Filter out any children that aren't ReactElements. We can only track ReactElements with a props.key\n\n  var filteredChildren = onlyElements(children); // Keep a living record of the children we're actually rendering so we\n  // can diff to figure out which are entering and exiting\n\n  var presentChildren = React.useRef(filteredChildren); // A lookup table to quickly reference components by key\n\n  var allChildren = React.useRef(new Map()).current; // A living record of all currently exiting components.\n\n  var exiting = React.useRef(new Set()).current;\n  updateChildLookup(filteredChildren, allChildren); // If this is the initial component render, just deal with logic surrounding whether\n  // we play onMount animations or not.\n\n  if (isInitialRender.current) {\n    isInitialRender.current = false;\n    return React__namespace.createElement(React__namespace.Fragment, null, filteredChildren.map(function (child) {\n      return React__namespace.createElement(PresenceChild, {\n        key: getChildKey(child),\n        isPresent: true,\n        initial: initial ? undefined : false,\n        presenceAffectsLayout: presenceAffectsLayout\n      }, child);\n    }));\n  } // If this is a subsequent render, deal with entering and exiting children\n\n\n  var childrenToRender = tslib.__spreadArray([], tslib.__read(filteredChildren), false); // Diff the keys of the currently-present and target children to update our\n  // exiting list.\n\n\n  var presentKeys = presentChildren.current.map(getChildKey);\n  var targetKeys = filteredChildren.map(getChildKey); // Diff the present children with our target children and mark those that are exiting\n\n  var numPresent = presentKeys.length;\n\n  for (var i = 0; i < numPresent; i++) {\n    var key = presentKeys[i];\n\n    if (targetKeys.indexOf(key) === -1) {\n      exiting.add(key);\n    } else {\n      // In case this key has re-entered, remove from the exiting list\n      exiting.delete(key);\n    }\n  } // If we currently have exiting children, and we're deferring rendering incoming children\n  // until after all current children have exiting, empty the childrenToRender array\n\n\n  if (exitBeforeEnter && exiting.size) {\n    childrenToRender = [];\n  } // Loop through all currently exiting components and clone them to overwrite `animate`\n  // with any `exit` prop they might have defined.\n\n\n  exiting.forEach(function (key) {\n    // If this component is actually entering again, early return\n    if (targetKeys.indexOf(key) !== -1) return;\n    var child = allChildren.get(key);\n    if (!child) return;\n    var insertionIndex = presentKeys.indexOf(key);\n\n    var onExit = function () {\n      allChildren.delete(key);\n      exiting.delete(key); // Remove this child from the present children\n\n      var removeIndex = presentChildren.current.findIndex(function (presentChild) {\n        return presentChild.key === key;\n      });\n      presentChildren.current.splice(removeIndex, 1); // Defer re-rendering until all exiting children have indeed left\n\n      if (!exiting.size) {\n        presentChildren.current = filteredChildren;\n\n        if (isMounted.current === false) {\n          return;\n        }\n\n        forceRender();\n        onExitComplete && onExitComplete();\n      }\n    };\n\n    childrenToRender.splice(insertionIndex, 0, React__namespace.createElement(PresenceChild, {\n      key: getChildKey(child),\n      isPresent: false,\n      onExitComplete: onExit,\n      custom: custom,\n      presenceAffectsLayout: presenceAffectsLayout\n    }, child));\n  }); // Add `MotionContext` even to children that don't need it to ensure we're rendering\n  // the same tree between renders\n\n  childrenToRender = childrenToRender.map(function (child) {\n    var key = child.key;\n    return exiting.has(key) ? child : React__namespace.createElement(PresenceChild, {\n      key: getChildKey(child),\n      isPresent: true,\n      presenceAffectsLayout: presenceAffectsLayout\n    }, child);\n  });\n  presentChildren.current = childrenToRender;\n\n  if (process.env.NODE_ENV !== \"production\" && exitBeforeEnter && childrenToRender.length > 1) {\n    console.warn(\"You're attempting to animate multiple children within AnimatePresence, but its exitBeforeEnter prop is set to true. This will lead to odd visual behaviour.\");\n  }\n\n  return React__namespace.createElement(React__namespace.Fragment, null, exiting.size ? childrenToRender : childrenToRender.map(function (child) {\n    return React.cloneElement(child);\n  }));\n};\n/**\n * @internal\n * @deprecated\n */\n\n\nvar DeprecatedLayoutGroupContext = React.createContext(null);\n\nvar notify = function (node) {\n  return !node.isLayoutDirty && node.willUpdate(false);\n};\n\nfunction nodeGroup() {\n  var nodes = new Set();\n  var subscriptions = new WeakMap();\n\n  var dirtyAll = function () {\n    return nodes.forEach(notify);\n  };\n\n  return {\n    add: function (node) {\n      nodes.add(node);\n      subscriptions.set(node, node.addEventListener(\"willUpdate\", dirtyAll));\n    },\n    remove: function (node) {\n      var _a;\n\n      nodes.delete(node);\n      (_a = subscriptions.get(node)) === null || _a === void 0 ? void 0 : _a();\n      subscriptions.delete(node);\n      dirtyAll();\n    },\n    dirty: dirtyAll\n  };\n}\n\nvar LayoutGroup = function (_a) {\n  var _b, _c;\n\n  var children = _a.children,\n      id = _a.id,\n      _d = _a.inheritId,\n      inheritId = _d === void 0 ? true : _d;\n  var layoutGroupContext = React.useContext(useMotionValue.LayoutGroupContext);\n  var deprecatedLayoutGroupContext = React.useContext(DeprecatedLayoutGroupContext);\n\n  var _e = tslib.__read(useMotionValue.useForceUpdate(), 2),\n      forceRender = _e[0],\n      key = _e[1];\n\n  var context = React.useRef(null);\n  var upstreamId = (_b = layoutGroupContext.id) !== null && _b !== void 0 ? _b : deprecatedLayoutGroupContext;\n\n  if (context.current === null) {\n    if (inheritId && upstreamId) {\n      id = id ? upstreamId + \"-\" + id : upstreamId;\n    }\n\n    context.current = {\n      id: id,\n      group: inheritId ? (_c = layoutGroupContext === null || layoutGroupContext === void 0 ? void 0 : layoutGroupContext.group) !== null && _c !== void 0 ? _c : nodeGroup() : nodeGroup()\n    };\n  }\n\n  var memoizedContext = React.useMemo(function () {\n    return tslib.__assign(tslib.__assign({}, context.current), {\n      forceRender: forceRender\n    });\n  }, [key]);\n  return React__namespace.createElement(useMotionValue.LayoutGroupContext.Provider, {\n    value: memoizedContext\n  }, children);\n};\n\nvar id = 0;\n\nvar AnimateSharedLayout = function (_a) {\n  var children = _a.children;\n  return React__namespace.createElement(LayoutGroup, {\n    id: useMotionValue.useConstant(function () {\n      return \"asl-\".concat(id++);\n    })\n  }, children);\n};\n/**\n * `MotionConfig` is used to set configuration options for all children `motion` components.\n *\n * ```jsx\n * import { motion, MotionConfig } from \"framer-motion\"\n *\n * export function App() {\n *   return (\n *     <MotionConfig transition={{ type: \"spring\" }}>\n *       <motion.div animate={{ x: 100 }} />\n *     </MotionConfig>\n *   )\n * }\n * ```\n *\n * @public\n */\n\n\nfunction MotionConfig(_a) {\n  var children = _a.children,\n      isValidProp = _a.isValidProp,\n      config = tslib.__rest(_a, [\"children\", \"isValidProp\"]);\n\n  isValidProp && useMotionValue.loadExternalIsValidProp(isValidProp);\n  /**\n   * Inherit props from any parent MotionConfig components\n   */\n\n  config = tslib.__assign(tslib.__assign({}, React.useContext(useMotionValue.MotionConfigContext)), config);\n  /**\n   * Don't allow isStatic to change between renders as it affects how many hooks\n   * motion components fire.\n   */\n\n  config.isStatic = useMotionValue.useConstant(function () {\n    return config.isStatic;\n  });\n  /**\n   * Creating a new config context object will re-render every `motion` component\n   * every time it renders. So we only want to create a new one sparingly.\n   */\n\n  var context = React.useMemo(function () {\n    return config;\n  }, [JSON.stringify(config.transition), config.transformPagePoint]);\n  return React__namespace.createElement(useMotionValue.MotionConfigContext.Provider, {\n    value: context\n  }, children);\n}\n/**\n * Used in conjunction with the `m` component to reduce bundle size.\n *\n * `m` is a version of the `motion` component that only loads functionality\n * critical for the initial render.\n *\n * `LazyMotion` can then be used to either synchronously or asynchronously\n * load animation and gesture support.\n *\n * ```jsx\n * // Synchronous loading\n * import { LazyMotion, m, domAnimations } from \"framer-motion\"\n *\n * function App() {\n *   return (\n *     <LazyMotion features={domAnimations}>\n *       <m.div animate={{ scale: 2 }} />\n *     </LazyMotion>\n *   )\n * }\n *\n * // Asynchronous loading\n * import { LazyMotion, m } from \"framer-motion\"\n *\n * function App() {\n *   return (\n *     <LazyMotion features={() => import('./path/to/domAnimations')}>\n *       <m.div animate={{ scale: 2 }} />\n *     </LazyMotion>\n *   )\n * }\n * ```\n *\n * @public\n */\n\n\nfunction LazyMotion(_a) {\n  var children = _a.children,\n      features = _a.features,\n      _b = _a.strict,\n      strict = _b === void 0 ? false : _b;\n\n  var _c = tslib.__read(React.useState(!isLazyBundle(features)), 2),\n      setIsLoaded = _c[1];\n\n  var loadedRenderer = React.useRef(undefined);\n  /**\n   * If this is a synchronous load, load features immediately\n   */\n\n  if (!isLazyBundle(features)) {\n    var renderer = features.renderer,\n        loadedFeatures = tslib.__rest(features, [\"renderer\"]);\n\n    loadedRenderer.current = renderer;\n    useMotionValue.loadFeatures(loadedFeatures);\n  }\n\n  React.useEffect(function () {\n    if (isLazyBundle(features)) {\n      features().then(function (_a) {\n        var renderer = _a.renderer,\n            loadedFeatures = tslib.__rest(_a, [\"renderer\"]);\n\n        useMotionValue.loadFeatures(loadedFeatures);\n        loadedRenderer.current = renderer;\n        setIsLoaded(true);\n      });\n    }\n  }, []);\n  return React__namespace.createElement(useMotionValue.LazyContext.Provider, {\n    value: {\n      renderer: loadedRenderer.current,\n      strict: strict\n    }\n  }, children);\n}\n\nfunction isLazyBundle(features) {\n  return typeof features === \"function\";\n}\n\nvar ReorderContext = React.createContext(null);\n\nfunction checkReorder(order, value, offset, velocity) {\n  if (!velocity) return order;\n  var index = order.findIndex(function (item) {\n    return item.value === value;\n  });\n  if (index === -1) return order;\n  var nextOffset = velocity > 0 ? 1 : -1;\n  var nextItem = order[index + nextOffset];\n  if (!nextItem) return order;\n  var item = order[index];\n  var nextLayout = nextItem.layout;\n  var nextItemCenter = popmotion.mix(nextLayout.min, nextLayout.max, 0.5);\n\n  if (nextOffset === 1 && item.layout.max + offset > nextItemCenter || nextOffset === -1 && item.layout.min + offset < nextItemCenter) {\n    return useMotionValue.moveItem(order, index, index + nextOffset);\n  }\n\n  return order;\n}\n\nfunction ReorderGroup(_a, externalRef) {\n  var children = _a.children,\n      _b = _a.as,\n      as = _b === void 0 ? \"ul\" : _b,\n      _c = _a.axis,\n      axis = _c === void 0 ? \"y\" : _c,\n      onReorder = _a.onReorder,\n      values = _a.values,\n      props = tslib.__rest(_a, [\"children\", \"as\", \"axis\", \"onReorder\", \"values\"]);\n\n  var Component = useMotionValue.useConstant(function () {\n    return motion(as);\n  });\n  var order = [];\n  var isReordering = React.useRef(false);\n  heyListen.invariant(Boolean(values), \"Reorder.Group must be provided a values prop\");\n  var context = {\n    axis: axis,\n    registerItem: function (value, layout) {\n      /**\n       * Ensure entries can't add themselves more than once\n       */\n      if (layout && order.findIndex(function (entry) {\n        return value === entry.value;\n      }) === -1) {\n        order.push({\n          value: value,\n          layout: layout[axis]\n        });\n        order.sort(compareMin);\n      }\n    },\n    updateOrder: function (id, offset, velocity) {\n      if (isReordering.current) return;\n      var newOrder = checkReorder(order, id, offset, velocity);\n\n      if (order !== newOrder) {\n        isReordering.current = true;\n        onReorder(newOrder.map(getValue).filter(function (value) {\n          return values.indexOf(value) !== -1;\n        }));\n      }\n    }\n  };\n  React.useEffect(function () {\n    isReordering.current = false;\n  });\n  return React__namespace.createElement(Component, tslib.__assign({}, props, {\n    ref: externalRef\n  }), React__namespace.createElement(ReorderContext.Provider, {\n    value: context\n  }, children));\n}\n\nvar Group = React.forwardRef(ReorderGroup);\n\nfunction getValue(item) {\n  return item.value;\n}\n\nfunction compareMin(a, b) {\n  return a.layout.min - b.layout.min;\n}\n\nvar isCustomValueType = function (v) {\n  return typeof v === \"object\" && v.mix;\n};\n\nvar getMixer = function (v) {\n  return isCustomValueType(v) ? v.mix : undefined;\n};\n\nfunction transform() {\n  var args = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    args[_i] = arguments[_i];\n  }\n\n  var useImmediate = !Array.isArray(args[0]);\n  var argOffset = useImmediate ? 0 : -1;\n  var inputValue = args[0 + argOffset];\n  var inputRange = args[1 + argOffset];\n  var outputRange = args[2 + argOffset];\n  var options = args[3 + argOffset];\n  var interpolator = popmotion.interpolate(inputRange, outputRange, tslib.__assign({\n    mixer: getMixer(outputRange[0])\n  }, options));\n  return useImmediate ? interpolator(inputValue) : interpolator;\n}\n\nfunction useOnChange(value, callback) {\n  React.useEffect(function () {\n    if (useMotionValue.isMotionValue(value)) return value.onChange(callback);\n  }, [callback]);\n}\n\nfunction useMultiOnChange(values, handler) {\n  React.useEffect(function () {\n    var subscriptions = values.map(function (value) {\n      return value.onChange(handler);\n    });\n    return function () {\n      return subscriptions.forEach(function (unsubscribe) {\n        return unsubscribe();\n      });\n    };\n  });\n}\n\nfunction useCombineMotionValues(values, combineValues) {\n  /**\n   * Initialise the returned motion value. This remains the same between renders.\n   */\n  var value = useMotionValue.useMotionValue(combineValues());\n  /**\n   * Create a function that will update the template motion value with the latest values.\n   * This is pre-bound so whenever a motion value updates it can schedule its\n   * execution in Framesync. If it's already been scheduled it won't be fired twice\n   * in a single frame.\n   */\n\n  var updateValue = function () {\n    return value.set(combineValues());\n  };\n  /**\n   * Synchronously update the motion value with the latest values during the render.\n   * This ensures that within a React render, the styles applied to the DOM are up-to-date.\n   */\n\n\n  updateValue();\n  /**\n   * Subscribe to all motion values found within the template. Whenever any of them change,\n   * schedule an update.\n   */\n\n  useMultiOnChange(values, function () {\n    return sync__default[\"default\"].update(updateValue, false, true);\n  });\n  return value;\n}\n\nfunction useTransform(input, inputRangeOrTransformer, outputRange, options) {\n  var transformer = typeof inputRangeOrTransformer === \"function\" ? inputRangeOrTransformer : transform(inputRangeOrTransformer, outputRange, options);\n  return Array.isArray(input) ? useListTransform(input, transformer) : useListTransform([input], function (_a) {\n    var _b = tslib.__read(_a, 1),\n        latest = _b[0];\n\n    return transformer(latest);\n  });\n}\n\nfunction useListTransform(values, transformer) {\n  var latest = useMotionValue.useConstant(function () {\n    return [];\n  });\n  return useCombineMotionValues(values, function () {\n    latest.length = 0;\n    var numValues = values.length;\n\n    for (var i = 0; i < numValues; i++) {\n      latest[i] = values[i].get();\n    }\n\n    return transformer(latest);\n  });\n}\n\nfunction useDefaultMotionValue(value, defaultValue) {\n  if (defaultValue === void 0) {\n    defaultValue = 0;\n  }\n\n  return useMotionValue.isMotionValue(value) ? value : useMotionValue.useMotionValue(defaultValue);\n}\n\nfunction ReorderItem(_a, externalRef) {\n  var children = _a.children,\n      style = _a.style,\n      value = _a.value,\n      _b = _a.as,\n      as = _b === void 0 ? \"li\" : _b,\n      onDrag = _a.onDrag,\n      props = tslib.__rest(_a, [\"children\", \"style\", \"value\", \"as\", \"onDrag\"]);\n\n  var Component = useMotionValue.useConstant(function () {\n    return motion(as);\n  });\n  var context = React.useContext(ReorderContext);\n  var point = {\n    x: useDefaultMotionValue(style === null || style === void 0 ? void 0 : style.x),\n    y: useDefaultMotionValue(style === null || style === void 0 ? void 0 : style.y)\n  };\n  var zIndex = useTransform([point.x, point.y], function (_a) {\n    var _b = tslib.__read(_a, 2),\n        latestX = _b[0],\n        latestY = _b[1];\n\n    return latestX || latestY ? 1 : \"unset\";\n  });\n  var layout = React.useRef(null);\n  heyListen.invariant(Boolean(context), \"Reorder.Item must be a child of Reorder.Group\");\n  var _c = context,\n      axis = _c.axis,\n      registerItem = _c.registerItem,\n      updateOrder = _c.updateOrder;\n  React.useEffect(function () {\n    registerItem(value, layout.current);\n  }, [context]);\n  return React__namespace.createElement(Component, tslib.__assign({\n    drag: axis\n  }, props, {\n    dragSnapToOrigin: true,\n    style: tslib.__assign(tslib.__assign({}, style), {\n      x: point.x,\n      y: point.y,\n      zIndex: zIndex\n    }),\n    layout: true,\n    onDrag: function (event, gesturePoint) {\n      var velocity = gesturePoint.velocity;\n      velocity[axis] && updateOrder(value, point[axis].get(), velocity[axis]);\n      onDrag === null || onDrag === void 0 ? void 0 : onDrag(event, gesturePoint);\n    },\n    onLayoutMeasure: function (measured) {\n      layout.current = measured;\n    },\n    ref: externalRef\n  }), children);\n}\n\nvar Item = React.forwardRef(ReorderItem);\nvar Reorder = {\n  Group: Group,\n  Item: Item\n};\n/**\n * @public\n */\n\nvar domAnimation = tslib.__assign(tslib.__assign({\n  renderer: createDomVisualElement\n}, useMotionValue.animations), gestureAnimations);\n/**\n * @public\n */\n\n\nvar domMax = tslib.__assign(tslib.__assign(tslib.__assign(tslib.__assign({}, domAnimation), drag), layoutFeatures), {\n  projectionNodeConstructor: HTMLProjectionNode\n});\n/**\n * Combine multiple motion values into a new one using a string template literal.\n *\n * ```jsx\n * import {\n *   motion,\n *   useSpring,\n *   useMotionValue,\n *   useMotionTemplate\n * } from \"framer-motion\"\n *\n * function Component() {\n *   const shadowX = useSpring(0)\n *   const shadowY = useMotionValue(0)\n *   const shadow = useMotionTemplate`drop-shadow(${shadowX}px ${shadowY}px 20px rgba(0,0,0,0.3))`\n *\n *   return <motion.div style={{ filter: shadow }} />\n * }\n * ```\n *\n * @public\n */\n\n\nfunction useMotionTemplate(fragments) {\n  var values = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    values[_i - 1] = arguments[_i];\n  }\n  /**\n   * Create a function that will build a string from the latest motion values.\n   */\n\n\n  var numFragments = fragments.length;\n\n  function buildValue() {\n    var output = \"\";\n\n    for (var i = 0; i < numFragments; i++) {\n      output += fragments[i];\n      var value = values[i];\n      if (value) output += values[i].get();\n    }\n\n    return output;\n  }\n\n  return useCombineMotionValues(values, buildValue);\n}\n/**\n * Creates a `MotionValue` that, when `set`, will use a spring animation to animate to its new state.\n *\n * It can either work as a stand-alone `MotionValue` by initialising it with a value, or as a subscriber\n * to another `MotionValue`.\n *\n * @remarks\n *\n * ```jsx\n * const x = useSpring(0, { stiffness: 300 })\n * const y = useSpring(x, { damping: 10 })\n * ```\n *\n * @param inputValue - `MotionValue` or number. If provided a `MotionValue`, when the input `MotionValue` changes, the created `MotionValue` will spring towards that value.\n * @param springConfig - Configuration options for the spring.\n * @returns `MotionValue`\n *\n * @public\n */\n\n\nfunction useSpring(source, config) {\n  if (config === void 0) {\n    config = {};\n  }\n\n  var isStatic = React.useContext(useMotionValue.MotionConfigContext).isStatic;\n  var activeSpringAnimation = React.useRef(null);\n  var value = useMotionValue.useMotionValue(useMotionValue.isMotionValue(source) ? source.get() : source);\n  React.useMemo(function () {\n    return value.attach(function (v, set) {\n      /**\n       * A more hollistic approach to this might be to use isStatic to fix VisualElement animations\n       * at that level, but this will work for now\n       */\n      if (isStatic) return set(v);\n\n      if (activeSpringAnimation.current) {\n        activeSpringAnimation.current.stop();\n      }\n\n      activeSpringAnimation.current = popmotion.animate(tslib.__assign(tslib.__assign({\n        from: value.get(),\n        to: v,\n        velocity: value.getVelocity()\n      }, config), {\n        onUpdate: set\n      }));\n      return value.get();\n    });\n  }, Object.values(config));\n  useOnChange(source, function (v) {\n    return value.set(parseFloat(v));\n  });\n  return value;\n}\n/**\n * Creates a `MotionValue` that updates when the velocity of the provided `MotionValue` changes.\n *\n * ```javascript\n * const x = useMotionValue(0)\n * const xVelocity = useVelocity(x)\n * const xAcceleration = useVelocity(xVelocity)\n * ```\n *\n * @public\n */\n\n\nfunction useVelocity(value) {\n  var velocity = useMotionValue.useMotionValue(value.getVelocity());\n  React.useEffect(function () {\n    return value.velocityUpdateSubscribers.add(function (newVelocity) {\n      velocity.set(newVelocity);\n    });\n  }, [value]);\n  return velocity;\n}\n\nfunction createScrollMotionValues() {\n  return {\n    scrollX: useMotionValue.motionValue(0),\n    scrollY: useMotionValue.motionValue(0),\n    scrollXProgress: useMotionValue.motionValue(0),\n    scrollYProgress: useMotionValue.motionValue(0)\n  };\n}\n\nfunction setProgress(offset, maxOffset, value) {\n  value.set(!offset || !maxOffset ? 0 : offset / maxOffset);\n}\n\nfunction createScrollUpdater(values, getOffsets) {\n  var update = function () {\n    var _a = getOffsets(),\n        xOffset = _a.xOffset,\n        yOffset = _a.yOffset,\n        xMaxOffset = _a.xMaxOffset,\n        yMaxOffset = _a.yMaxOffset; // Set absolute positions\n\n\n    values.scrollX.set(xOffset);\n    values.scrollY.set(yOffset); // Set 0-1 progress\n\n    setProgress(xOffset, xMaxOffset, values.scrollXProgress);\n    setProgress(yOffset, yMaxOffset, values.scrollYProgress);\n  };\n\n  update();\n  return update;\n}\n\nvar getElementScrollOffsets = function (element) {\n  return function () {\n    return {\n      xOffset: element.scrollLeft,\n      yOffset: element.scrollTop,\n      xMaxOffset: element.scrollWidth - element.offsetWidth,\n      yMaxOffset: element.scrollHeight - element.offsetHeight\n    };\n  };\n};\n/**\n * Returns MotionValues that update when the provided element scrolls:\n *\n * - `scrollX`  Horizontal scroll distance in pixels.\n * - `scrollY`  Vertical scroll distance in pixels.\n * - `scrollXProgress`  Horizontal scroll progress between `0` and `1`.\n * - `scrollYProgress`  Vertical scroll progress between `0` and `1`.\n *\n * This element must be set to `overflow: scroll` on either or both axes to report scroll offset.\n *\n * ```jsx\n * export const MyComponent = () => {\n *   const ref = useRef()\n *   const { scrollYProgress } = useElementScroll(ref)\n *\n *   return (\n *     <div ref={ref}>\n *       <motion.div style={{ scaleX: scrollYProgress }} />\n *     </div>\n *   )\n * }\n * ```\n *\n * @public\n */\n\n\nfunction useElementScroll(ref) {\n  var values = useMotionValue.useConstant(createScrollMotionValues);\n  useMotionValue.useIsomorphicLayoutEffect(function () {\n    var element = ref.current;\n    heyListen.invariant(!!element, \"ref provided to useScroll must be passed into a HTML element.\");\n    if (!element) return;\n    var updateScrollValues = createScrollUpdater(values, getElementScrollOffsets(element));\n    var scrollListener = useMotionValue.addDomEvent(element, \"scroll\", updateScrollValues, {\n      passive: true\n    });\n    var resizeListener = useMotionValue.addDomEvent(element, \"resize\", updateScrollValues);\n    return function () {\n      scrollListener && scrollListener();\n      resizeListener && resizeListener();\n    };\n  }, []);\n  return values;\n}\n\nvar viewportScrollValues;\n\nfunction getViewportScrollOffsets() {\n  return {\n    xOffset: window.pageXOffset,\n    yOffset: window.pageYOffset,\n    xMaxOffset: document.body.clientWidth - window.innerWidth,\n    yMaxOffset: document.body.clientHeight - window.innerHeight\n  };\n}\n\nvar hasListeners = false;\n\nfunction addEventListeners() {\n  hasListeners = true;\n  if (typeof window === \"undefined\") return;\n  var updateScrollValues = createScrollUpdater(viewportScrollValues, getViewportScrollOffsets);\n  useMotionValue.addDomEvent(window, \"scroll\", updateScrollValues, {\n    passive: true\n  });\n  useMotionValue.addDomEvent(window, \"resize\", updateScrollValues);\n}\n/**\n * Returns MotionValues that update when the viewport scrolls:\n *\n * - `scrollX`  Horizontal scroll distance in pixels.\n * - `scrollY`  Vertical scroll distance in pixels.\n * - `scrollXProgress`  Horizontal scroll progress between `0` and `1`.\n * - `scrollYProgress`  Vertical scroll progress between `0` and `1`.\n *\n * **Warning:** Setting `body` or `html` to `height: 100%` or similar will break the `Progress`\n * values as this breaks the browser's capability to accurately measure the page length.\n *\n * ```jsx\n * export const MyComponent = () => {\n *   const { scrollYProgress } = useViewportScroll()\n *   return <motion.div style={{ scaleX: scrollYProgress }} />\n * }\n * ```\n *\n * @public\n */\n\n\nfunction useViewportScroll() {\n  /**\n   * Lazy-initialise the viewport scroll values\n   */\n  if (!viewportScrollValues) {\n    viewportScrollValues = createScrollMotionValues();\n  }\n\n  useMotionValue.useIsomorphicLayoutEffect(function () {\n    !hasListeners && addEventListeners();\n  }, []);\n  return viewportScrollValues;\n}\n\nvar getCurrentTime = typeof performance !== \"undefined\" ? function () {\n  return performance.now();\n} : function () {\n  return Date.now();\n};\n\nfunction useAnimationFrame(callback) {\n  var initialTimestamp = useMotionValue.useConstant(getCurrentTime);\n  React.useEffect(function () {\n    var provideTimeSinceStart = function (_a) {\n      var timestamp = _a.timestamp;\n      callback(timestamp - initialTimestamp);\n    };\n\n    sync__default[\"default\"].update(provideTimeSinceStart, true);\n    return function () {\n      return sync.cancelSync.update(provideTimeSinceStart);\n    };\n  }, [callback]);\n}\n\nfunction useTime() {\n  var time = useMotionValue.useMotionValue(0);\n  useAnimationFrame(function (t) {\n    return time.set(t);\n  });\n  return time;\n} // Does this device prefer reduced motion? Returns `null` server-side.\n\n\nvar prefersReducedMotion;\n\nfunction initPrefersReducedMotion() {\n  prefersReducedMotion = useMotionValue.motionValue(null);\n  if (typeof window === \"undefined\") return;\n\n  if (window.matchMedia) {\n    var motionMediaQuery_1 = window.matchMedia(\"(prefers-reduced-motion)\");\n\n    var setReducedMotionPreferences = function () {\n      return prefersReducedMotion.set(motionMediaQuery_1.matches);\n    };\n\n    motionMediaQuery_1.addListener(setReducedMotionPreferences);\n    setReducedMotionPreferences();\n  } else {\n    prefersReducedMotion.set(false);\n  }\n}\n/**\n * A hook that returns `true` if we should be using reduced motion based on the current device's Reduced Motion setting.\n *\n * This can be used to implement changes to your UI based on Reduced Motion. For instance, replacing motion-sickness inducing\n * `x`/`y` animations with `opacity`, disabling the autoplay of background videos, or turning off parallax motion.\n *\n * It will actively respond to changes and re-render your components with the latest setting.\n *\n * ```jsx\n * export function Sidebar({ isOpen }) {\n *   const shouldReduceMotion = useReducedMotion()\n *   const closedX = shouldReduceMotion ? 0 : \"-100%\"\n *\n *   return (\n *     <motion.div animate={{\n *       opacity: isOpen ? 1 : 0,\n *       x: isOpen ? 0 : closedX\n *     }} />\n *   )\n * }\n * ```\n *\n * @return boolean\n *\n * @public\n */\n\n\nfunction useReducedMotion() {\n  /**\n   * Lazy initialisation of prefersReducedMotion\n   */\n  !prefersReducedMotion && initPrefersReducedMotion();\n\n  var _a = tslib.__read(React.useState(prefersReducedMotion.get()), 2),\n      shouldReduceMotion = _a[0],\n      setShouldReduceMotion = _a[1];\n\n  useOnChange(prefersReducedMotion, setShouldReduceMotion);\n  return shouldReduceMotion;\n}\n/**\n * @public\n */\n\n\nfunction animationControls() {\n  /**\n   * Track whether the host component has mounted.\n   */\n  var hasMounted = false;\n  /**\n   * Pending animations that are started before a component is mounted.\n   * TODO: Remove this as animations should only run in effects\n   */\n\n  var pendingAnimations = [];\n  /**\n   * A collection of linked component animation controls.\n   */\n\n  var subscribers = new Set();\n  var controls = {\n    subscribe: function (visualElement) {\n      subscribers.add(visualElement);\n      return function () {\n        return void subscribers.delete(visualElement);\n      };\n    },\n    start: function (definition, transitionOverride) {\n      /**\n       * TODO: We only perform this hasMounted check because in Framer we used to\n       * encourage the ability to start an animation within the render phase. This\n       * isn't behaviour concurrent-safe so when we make Framer concurrent-safe\n       * we can ditch this.\n       */\n      if (hasMounted) {\n        var animations_1 = [];\n        subscribers.forEach(function (visualElement) {\n          animations_1.push(useMotionValue.animateVisualElement(visualElement, definition, {\n            transitionOverride: transitionOverride\n          }));\n        });\n        return Promise.all(animations_1);\n      } else {\n        return new Promise(function (resolve) {\n          pendingAnimations.push({\n            animation: [definition, transitionOverride],\n            resolve: resolve\n          });\n        });\n      }\n    },\n    set: function (definition) {\n      heyListen.invariant(hasMounted, \"controls.set() should only be called after a component has mounted. Consider calling within a useEffect hook.\");\n      return subscribers.forEach(function (visualElement) {\n        useMotionValue.setValues(visualElement, definition);\n      });\n    },\n    stop: function () {\n      subscribers.forEach(function (visualElement) {\n        useMotionValue.stopAnimation(visualElement);\n      });\n    },\n    mount: function () {\n      hasMounted = true;\n      pendingAnimations.forEach(function (_a) {\n        var animation = _a.animation,\n            resolve = _a.resolve;\n        controls.start.apply(controls, tslib.__spreadArray([], tslib.__read(animation), false)).then(resolve);\n      });\n      return function () {\n        hasMounted = false;\n        controls.stop();\n      };\n    }\n  };\n  return controls;\n}\n/**\n * Creates `AnimationControls`, which can be used to manually start, stop\n * and sequence animations on one or more components.\n *\n * The returned `AnimationControls` should be passed to the `animate` property\n * of the components you want to animate.\n *\n * These components can then be animated with the `start` method.\n *\n * ```jsx\n * import * as React from 'react'\n * import { motion, useAnimation } from 'framer-motion'\n *\n * export function MyComponent(props) {\n *    const controls = useAnimation()\n *\n *    controls.start({\n *        x: 100,\n *        transition: { duration: 0.5 },\n *    })\n *\n *    return <motion.div animate={controls} />\n * }\n * ```\n *\n * @returns Animation controller with `start` and `stop` methods\n *\n * @public\n */\n\n\nfunction useAnimation() {\n  var controls = useMotionValue.useConstant(animationControls);\n  React.useEffect(controls.mount, []);\n  return controls;\n}\n/**\n * Cycles through a series of visual properties. Can be used to toggle between or cycle through animations. It works similar to `useState` in React. It is provided an initial array of possible states, and returns an array of two arguments.\n *\n * An index value can be passed to the returned `cycle` function to cycle to a specific index.\n *\n * ```jsx\n * import * as React from \"react\"\n * import { motion, useCycle } from \"framer-motion\"\n *\n * export const MyComponent = () => {\n *   const [x, cycleX] = useCycle(0, 50, 100)\n *\n *   return (\n *     <motion.div\n *       animate={{ x: x }}\n *       onTap={() => cycleX()}\n *      />\n *    )\n * }\n * ```\n *\n * @param items - items to cycle through\n * @returns [currentState, cycleState]\n *\n * @public\n */\n\n\nfunction useCycle() {\n  var items = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    items[_i] = arguments[_i];\n  }\n\n  var index = React.useRef(0);\n\n  var _a = tslib.__read(React.useState(items[index.current]), 2),\n      item = _a[0],\n      setItem = _a[1];\n\n  return [item, function (next) {\n    index.current = typeof next !== \"number\" ? popmotion.wrap(0, items.length, index.current + 1) : next;\n    setItem(items[index.current]);\n  }];\n}\n/**\n * Can manually trigger a drag gesture on one or more `drag`-enabled `motion` components.\n *\n * ```jsx\n * const dragControls = useDragControls()\n *\n * function startDrag(event) {\n *   dragControls.start(event, { snapToCursor: true })\n * }\n *\n * return (\n *   <>\n *     <div onPointerDown={startDrag} />\n *     <motion.div drag=\"x\" dragControls={dragControls} />\n *   </>\n * )\n * ```\n *\n * @public\n */\n\n\nvar DragControls =\n/** @class */\nfunction () {\n  function DragControls() {\n    this.componentControls = new Set();\n  }\n  /**\n   * Subscribe a component's internal `VisualElementDragControls` to the user-facing API.\n   *\n   * @internal\n   */\n\n\n  DragControls.prototype.subscribe = function (controls) {\n    var _this = this;\n\n    this.componentControls.add(controls);\n    return function () {\n      return _this.componentControls.delete(controls);\n    };\n  };\n  /**\n   * Start a drag gesture on every `motion` component that has this set of drag controls\n   * passed into it via the `dragControls` prop.\n   *\n   * ```jsx\n   * dragControls.start(e, {\n   *   snapToCursor: true\n   * })\n   * ```\n   *\n   * @param event - PointerEvent\n   * @param options - Options\n   *\n   * @public\n   */\n\n\n  DragControls.prototype.start = function (event, options) {\n    this.componentControls.forEach(function (controls) {\n      controls.start(event.nativeEvent || event, options);\n    });\n  };\n\n  return DragControls;\n}();\n\nvar createDragControls = function () {\n  return new DragControls();\n};\n/**\n * Usually, dragging is initiated by pressing down on a `motion` component with a `drag` prop\n * and moving it. For some use-cases, for instance clicking at an arbitrary point on a video scrubber, we\n * might want to initiate that dragging from a different component than the draggable one.\n *\n * By creating a `dragControls` using the `useDragControls` hook, we can pass this into\n * the draggable component's `dragControls` prop. It exposes a `start` method\n * that can start dragging from pointer events on other components.\n *\n * ```jsx\n * const dragControls = useDragControls()\n *\n * function startDrag(event) {\n *   dragControls.start(event, { snapToCursor: true })\n * }\n *\n * return (\n *   <>\n *     <div onPointerDown={startDrag} />\n *     <motion.div drag=\"x\" dragControls={dragControls} />\n *   </>\n * )\n * ```\n *\n * @public\n */\n\n\nfunction useDragControls() {\n  return useMotionValue.useConstant(createDragControls);\n}\n\nfunction useInstantLayoutTransition() {\n  return startTransition;\n}\n\nfunction startTransition(cb) {\n  if (!rootProjectionNode.current) return;\n  rootProjectionNode.current.isUpdating = false;\n  rootProjectionNode.current.blockUpdate();\n  cb === null || cb === void 0 ? void 0 : cb();\n}\n\nfunction useInstantTransition() {\n  var _a = tslib.__read(useMotionValue.useForceUpdate(), 2),\n      forceUpdate = _a[0],\n      forcedRenderCount = _a[1];\n\n  var startInstantLayoutTransition = useInstantLayoutTransition();\n  React.useEffect(function () {\n    /**\n     * Unblock after two animation frames, otherwise this will unblock too soon.\n     */\n    sync__default[\"default\"].postRender(function () {\n      return sync__default[\"default\"].postRender(function () {\n        return useMotionValue.instantAnimationState.current = false;\n      });\n    });\n  }, [forcedRenderCount]);\n  return function (callback) {\n    startInstantLayoutTransition(function () {\n      useMotionValue.instantAnimationState.current = true;\n      forceUpdate();\n      callback();\n    });\n  };\n}\n\nfunction useResetProjection() {\n  var reset = React__namespace.useCallback(function () {\n    var root = rootProjectionNode.current;\n    if (!root) return;\n    root.resetTree();\n  }, []);\n  return reset;\n}\n\nvar createObject = function () {\n  return {};\n};\n\nvar stateVisualElement = useMotionValue.visualElement({\n  build: function () {},\n  measureViewportBox: useMotionValue.createBox,\n  resetTransform: function () {},\n  restoreTransform: function () {},\n  removeValueFromRenderState: function () {},\n  render: function () {},\n  scrapeMotionValuesFromProps: createObject,\n  readValueFromInstance: function (_state, key, options) {\n    return options.initialState[key] || 0;\n  },\n  makeTargetAnimatable: function (element, _a) {\n    var transition = _a.transition,\n        transitionEnd = _a.transitionEnd,\n        target = tslib.__rest(_a, [\"transition\", \"transitionEnd\"]);\n\n    var origin = useMotionValue.getOrigin(target, transition || {}, element);\n    useMotionValue.checkTargetForNewValues(element, target, origin);\n    return tslib.__assign({\n      transition: transition,\n      transitionEnd: transitionEnd\n    }, target);\n  }\n});\nvar useVisualState = useMotionValue.makeUseVisualState({\n  scrapeMotionValuesFromProps: createObject,\n  createRenderState: createObject\n});\n/**\n * This is not an officially supported API and may be removed\n * on any version.\n * @internal\n */\n\nfunction useAnimatedState(initialState) {\n  var _a = tslib.__read(React.useState(initialState), 2),\n      animationState = _a[0],\n      setAnimationState = _a[1];\n\n  var visualState = useVisualState({}, false);\n  var element = useMotionValue.useConstant(function () {\n    return stateVisualElement({\n      props: {},\n      visualState: visualState\n    }, {\n      initialState: initialState\n    });\n  });\n  React.useEffect(function () {\n    element.mount({});\n    return element.unmount();\n  }, []);\n  React.useEffect(function () {\n    element.setProps({\n      onUpdate: function (v) {\n        return setAnimationState(tslib.__assign({}, v));\n      }\n    });\n  });\n  var startAnimation = useMotionValue.useConstant(function () {\n    return function (animationDefinition) {\n      return useMotionValue.animateVisualElement(element, animationDefinition);\n    };\n  });\n  return [animationState, startAnimation];\n} // Keep things reasonable and avoid scale: Infinity. In practise we might need\n// to add another value, opacity, that could interpolate scaleX/Y [0,0.01] => [0,1]\n// to simply hide content at unreasonable scales.\n\n\nvar maxScale = 100000;\n\nvar invertScale = function (scale) {\n  return scale > 0.001 ? 1 / scale : maxScale;\n};\n\nvar hasWarned = false;\n/**\n * Returns a `MotionValue` each for `scaleX` and `scaleY` that update with the inverse\n * of their respective parent scales.\n *\n * This is useful for undoing the distortion of content when scaling a parent component.\n *\n * By default, `useInvertedScale` will automatically fetch `scaleX` and `scaleY` from the nearest parent.\n * By passing other `MotionValue`s in as `useInvertedScale({ scaleX, scaleY })`, it will invert the output\n * of those instead.\n *\n * ```jsx\n * const MyComponent = () => {\n *   const { scaleX, scaleY } = useInvertedScale()\n *   return <motion.div style={{ scaleX, scaleY }} />\n * }\n * ```\n *\n * @deprecated\n * @internal\n */\n\nfunction useInvertedScale(scale) {\n  var parentScaleX = useMotionValue.useMotionValue(1);\n  var parentScaleY = useMotionValue.useMotionValue(1);\n  var visualElement = useMotionValue.useVisualElementContext();\n  heyListen.invariant(!!(scale || visualElement), \"If no scale values are provided, useInvertedScale must be used within a child of another motion component.\");\n  heyListen.warning(hasWarned, \"useInvertedScale is deprecated and will be removed in 3.0. Use the layout prop instead.\");\n  hasWarned = true;\n\n  if (scale) {\n    parentScaleX = scale.scaleX || parentScaleX;\n    parentScaleY = scale.scaleY || parentScaleY;\n  } else if (visualElement) {\n    parentScaleX = visualElement.getValue(\"scaleX\", 1);\n    parentScaleY = visualElement.getValue(\"scaleY\", 1);\n  }\n\n  var scaleX = useTransform(parentScaleX, invertScale);\n  var scaleY = useTransform(parentScaleY, invertScale);\n  return {\n    scaleX: scaleX,\n    scaleY: scaleY\n  };\n}\n\nexports.FlatTree = useMotionValue.FlatTree;\nexports.LayoutGroupContext = useMotionValue.LayoutGroupContext;\nexports.MotionConfigContext = useMotionValue.MotionConfigContext;\nexports.MotionContext = useMotionValue.MotionContext;\nexports.MotionValue = useMotionValue.MotionValue;\nexports.PresenceContext = useMotionValue.PresenceContext;\nexports.SwitchLayoutGroupContext = useMotionValue.SwitchLayoutGroupContext;\nexports.addScaleCorrector = useMotionValue.addScaleCorrector;\nexports.animate = useMotionValue.animate;\nexports.animateVisualElement = useMotionValue.animateVisualElement;\nexports.createMotionComponent = useMotionValue.createMotionComponent;\nexports.isValidMotionProp = useMotionValue.isValidMotionProp;\nexports.motionValue = useMotionValue.motionValue;\nexports.resolveMotionValue = useMotionValue.resolveMotionValue;\nexports.useDomEvent = useMotionValue.useDomEvent;\nexports.useIsPresent = useMotionValue.useIsPresent;\nexports.useMotionValue = useMotionValue.useMotionValue;\nexports.usePresence = useMotionValue.usePresence;\nexports.visualElement = useMotionValue.visualElement;\nexports.AnimatePresence = AnimatePresence;\nexports.AnimateSharedLayout = AnimateSharedLayout;\nexports.DeprecatedLayoutGroupContext = DeprecatedLayoutGroupContext;\nexports.DragControls = DragControls;\nexports.LayoutGroup = LayoutGroup;\nexports.LazyMotion = LazyMotion;\nexports.MotionConfig = MotionConfig;\nexports.Reorder = Reorder;\nexports.animationControls = animationControls;\nexports.createDomMotionComponent = createDomMotionComponent;\nexports.domAnimation = domAnimation;\nexports.domMax = domMax;\nexports.m = m;\nexports.motion = motion;\nexports.transform = transform;\nexports.useAnimation = useAnimation;\nexports.useAnimationFrame = useAnimationFrame;\nexports.useCycle = useCycle;\nexports.useDeprecatedAnimatedState = useAnimatedState;\nexports.useDeprecatedInvertedScale = useInvertedScale;\nexports.useDragControls = useDragControls;\nexports.useElementScroll = useElementScroll;\nexports.useInstantLayoutTransition = useInstantLayoutTransition;\nexports.useInstantTransition = useInstantTransition;\nexports.useMotionTemplate = useMotionTemplate;\nexports.useReducedMotion = useReducedMotion;\nexports.useResetProjection = useResetProjection;\nexports.useSpring = useSpring;\nexports.useTime = useTime;\nexports.useTransform = useTransform;\nexports.useVelocity = useVelocity;\nexports.useViewportScroll = useViewportScroll;","map":{"version":3,"sources":["C:/Users/HP/Desktop/bootcamp/bootcamp/node_modules/framer-motion/dist/cjs/index.js"],"names":["Object","defineProperty","exports","value","tslib","require","useMotionValue","React","styleValueTypes","popmotion","heyListen","sync","_interopDefaultLegacy","e","_interopNamespace","__esModule","n","create","keys","forEach","k","d","getOwnPropertyDescriptor","get","enumerable","freeze","React__default","React__namespace","sync__default","createMotionProxy","createConfig","custom","Component","customMotionComponentConfig","createMotionComponent","Proxy","componentCache","Map","_target","key","has","set","lowercaseSVGElements","isSVGComponent","includes","indexOf","test","isForcedMotionValue","_a","layout","layoutId","isTransformProp","isTransformOriginProp","undefined","scaleCorrectors","translateAlias","x","y","z","transformPerspective","buildTransform","_b","transformIsDefault","transformTemplate","transform","transformKeys","_c","enableHardwareAcceleration","_d","allowTransformNone","transformString","sort","sortTransformProps","transformHasZ","numTransformKeys","length","i","concat","trim","buildTransformOrigin","originX","originY","originZ","isCSSVariable$1","startsWith","getValueAsType","type","buildHTMLStyles","state","latestValues","options","style","vars","transformOrigin","hasTransform","hasTransformOrigin","transformIsNone","valueType","numberValueTypes","valueAsType","push","default","createHtmlRenderState","copyRawValuesOnly","target","source","props","isMotionValue","useInitialMotionValues","visualState","isStatic","useMemo","__assign","useStyle","styleProp","assign","transformValues","useHTMLProps","htmlProps","Boolean","drag","dragListener","draggable","userSelect","WebkitUserSelect","WebkitTouchCallout","touchAction","calcOrigin$1","origin","offset","size","px","calcSVGTransformOrigin","dimensions","pxOriginX","width","pxOriginY","height","dashKeys","array","camelKeys","buildSVGPath","attrs","spacing","useDashCase","pathLength","pathSpacing","buildSVGAttrs","attrX","attrY","pathOffset","latest","__rest","createSvgRenderState","useSVGProps","visualProps","rawStyles","createUseRender","forwardMotionProps","useRender","projectionId","ref","useVisualProps","filteredProps","filterProps","elementProps","createElement","CAMEL_CASE_PATTERN","REPLACE_TEMPLATE","camelToDash","str","replace","toLowerCase","renderHTML","element","projection","getProjectionStyles","setProperty","camelCaseAttributes","Set","renderSVG","renderState","setAttribute","scrapeMotionValuesFromProps$1","newValues","scrapeMotionValuesFromProps","targetKey","toUpperCase","svgMotionConfig","useVisualState","makeUseVisualState","createRenderState","onMount","instance","getBBox","getBoundingClientRect","htmlMotionConfig","createDomMotionConfig","preloadedFeatures","createVisualElement","projectionNodeConstructor","baseConfig","useFocusGesture","whileFocus","visualElement","onFocus","animationState","setActive","AnimationType","Focus","onBlur","useDomEvent","createHoverEvent","isActive","callback","event","info","isMouseEvent","isDragActive","Hover","useHoverGesture","onHoverStart","onHoverEnd","whileHover","usePointerEvent","isNodeOrChild","parent","child","parentElement","useTapGesture","onTap","onTapStart","onTapCancel","whileTap","hasPressListeners","isPressing","useRef","cancelPointerEndListeners","removePointerEndListener","current","call","checkPointerEnd","Tap","onPointerUp","getInstance","onPointerCancel","onPointerDown","pipe","addPointerEvent","window","useUnmountEffect","warned","warnOnce","condition","message","console","warn","add","observerCallbacks","WeakMap","observers","fireObserverCallback","entry","fireAllObserverCallbacks","entries","initIntersectionObserver","root","lookupRoot","document","rootObservers","JSON","stringify","IntersectionObserver","observeIntersection","rootInteresectionObserver","observe","delete","unobserve","useViewport","whileInView","onViewportEnter","onViewportLeave","viewport","hasEnteredView","isInView","shouldObserve","once","useObserver","useMissingIntersectionObserver","useIntersectionObserver","thresholdNames","some","all","rootMargin","margin","amount","useEffect","threshold","intersectionCallback","isIntersecting","InView","getProps","process","env","NODE_ENV","requestAnimationFrame","gestureAnimations","inView","makeRenderlessComponent","tap","focus","hover","PanSession","handlers","_this","transformPagePoint","startEvent","lastMoveEvent","lastMoveEventInfo","updatePoint","getPanInfo","history","isPanStarted","isDistancePastThreshold","distance","point","timestamp","getFrameData","onStart","onMove","handlePointerMove","transformPoint","buttons","handlePointerUp","update","end","onEnd","onSessionEnd","panInfo","isTouchEvent","touches","extractEventInfo","initialInfo","onSessionStart","removeListeners","prototype","updateHandlers","cancelSync","subtractPoint","a","b","delta","lastDevicePoint","startDevicePoint","velocity","getVelocity","timeDelta","timestampedPoint","lastPoint","secondsToMilliseconds","time","currentVelocity","Infinity","applyConstraints","elastic","min","max","mix","Math","calcRelativeAxisConstraints","axis","calcRelativeConstraints","layoutBox","top","left","bottom","right","calcViewportAxisConstraints","layoutAxis","constraintsAxis","__read","calcViewportConstraints","constraintsBox","calcOrigin","sourceLength","calcLength","targetLength","progress","clamp","rebaseAxisConstraints","constraints","relativeConstraints","defaultElastic","resolveDragElastic","dragElastic","resolveAxisElastic","minLabel","maxLabel","resolvePointElastic","label","convertBoundingBoxToBox","convertBoxToBoundingBox","transformBoxPoints","topLeft","bottomRight","measureViewportBox","measurePageBox","rootProjectionNode","viewportBox","scroll","translateAxis","elementDragControls","VisualElementDragControls","openGlobalLock","isDragging","currentDirection","originPoint","hasMutatedConstraints","createBox","start","originEvent","snapToCursor","isPresent","stopAnimation","dragPropagation","onDragStart","getGlobalLock","resolveConstraints","isAnimationBlocked","eachAxis","getAxisMotionValue","percent","measuredAxis","actual","length_1","parseFloat","Drag","dragDirectionLock","onDirectionLock","onDrag","getCurrentDirection","updateAxis","syncRender","stop","panSession","getTransformPagePoint","cancel","startAnimation","onDragEnd","_point","shouldDrag","axisValue","next","dragConstraints","prevConstraints","isRefObject","resolveRefConstraints","onMeasureDragConstraints","constraintsElement","invariant","measuredConstraints","userConstraints","dragMomentum","dragTransition","dragSnapToOrigin","onDragTransitionEnd","momentumAnimations","transition","bounceStiffness","bounceDamping","inertia","timeConstant","restDelta","restSpeed","startAxisValueAnimation","Promise","then","dragKey","externalMotionValue","getValue","initial","scalePositionWithinConstraints","boxProgress","updateScroll","updateLayout","addListeners","stopPointerListener","measureDragConstraints","stopMeasureLayoutListener","addEventListener","stopResizeListener","addDomEvent","hasLayoutChanged","motionValue","translate","_e","_f","direction","lockThreshold","abs","useDrag","groupDragControls","dragControls","useConstant","subscribe","usePanGesture","onPan","onPanStart","onPanEnd","onPanSessionStart","hasPanEvents","useContext","MotionConfigContext","pan","isCSSVariable","cssVariableRegex","parseCSSVariable","match","exec","token","fallback","maxDepth","getVariableValue","depth","resolved","getComputedStyle","getPropertyValue","resolveCSSVariables","transitionEnd","Element","forEachValue","positionalKeys","isPositionalKey","hasPositionalKey","setAndResetVelocity","to","isNumOrPxType","v","number","BoundingBoxDimension","getPosFromMatrix","matrix","pos","split","getTranslateFromMatrix","pos2","pos3","_bbox","matrix3d","nonTranslationalTransformKeys","transformProps","filter","removeNonTranslationalTransform","removedTransforms","positionalValues","paddingLeft","paddingRight","paddingTop","paddingBottom","convertChangedValueTypes","changedKeys","originBbox","elementComputedStyle","display","setStaticValue","targetBbox","checkAndConvertChangedValueTypes","targetPositionalKeys","removedTransformValues","hasAttemptedToRemoveTransformValues","changedValueTypeKeys","hasValue","from","fromType","findDimensionValueType","toType","isKeyframesTarget","numKeyframes","fromIndex","Array","isArray","map","convertedTarget","unitConversion","parseDomVariant","getComputedStyle$1","htmlConfig","treeType","readValueFromInstance","domElement","defaultType","getDefaultValueType","computedStyle","sortNodePosition","compareDocumentPosition","getBaseTarget","resetTransform","scheduleRender","restoreTransform","mutableState","removeValueFromRenderState","makeTargetAnimatable","isMounted","getOrigin","checkTargetForNewValues","parsed","build","isVisible","visibility","render","htmlVisualElement","svgVisualElement","getAttribute","_element","createDomVisualElement","pixelsToPercent","pixels","correctBorderRadius","correct","node","varToken","correctBoxShadow","treeScale","projectionDelta","original","containsCSSVariables","cssVariables","shadow","complex","parse","template","createTransformer","xScale","scale","yScale","averageScale","output","i_1","cssVariable","MeasureLayoutWithContext","_super","__extends","apply","arguments","componentDidMount","layoutGroup","switchLayoutGroup","addScaleCorrector","defaultScaleCorrectors","group","register","didUpdate","safeToRemove","setOptions","onExitComplete","globalProjectionState","hasEverUpdated","getSnapshotBeforeUpdate","prevProps","layoutDependency","willUpdate","promote","relegate","postRender","getStack","members","componentDidUpdate","currentAnimation","isLead","componentWillUnmount","promoteContext","scheduleCheckAfterUnmount","remove","deregister","MeasureLayout","usePresence","LayoutGroupContext","SwitchLayoutGroupContext","borderRadius","applyTo","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","boxShadow","layoutFeatures","measureLayout","DocumentProjectionNode","createProjectionNode","attachResizeListener","notify","passive","removeEventListener","measureScroll","documentElement","scrollLeft","body","scrollTop","HTMLProjectionNode","defaultParent","documentNode","mount","layoutScroll","featureBundle","animations","motion","config","createDomMotionComponent","m","presenceId","getPresenceId","id","PresenceChild","children","presenceAffectsLayout","presenceChildren","newChildrenMap","context","childId","e_1","__values","values","done","isComplete","e_1_1","error","return","_","PresenceContext","Provider","getChildKey","updateChildLookup","allChildren","seenChildren","onlyElements","filtered","Children","isValidElement","AnimatePresence","exitBeforeEnter","useForceUpdate","forceRender","forceRenderLayoutGroup","isInitialRender","filteredChildren","presentChildren","exiting","Fragment","childrenToRender","__spreadArray","presentKeys","targetKeys","numPresent","insertionIndex","onExit","removeIndex","findIndex","presentChild","splice","cloneElement","DeprecatedLayoutGroupContext","createContext","isLayoutDirty","nodeGroup","nodes","subscriptions","dirtyAll","dirty","LayoutGroup","inheritId","layoutGroupContext","deprecatedLayoutGroupContext","upstreamId","memoizedContext","AnimateSharedLayout","MotionConfig","isValidProp","loadExternalIsValidProp","LazyMotion","features","strict","useState","isLazyBundle","setIsLoaded","loadedRenderer","renderer","loadedFeatures","loadFeatures","LazyContext","ReorderContext","checkReorder","order","index","item","nextOffset","nextItem","nextLayout","nextItemCenter","moveItem","ReorderGroup","externalRef","as","onReorder","isReordering","registerItem","compareMin","updateOrder","newOrder","Group","forwardRef","isCustomValueType","getMixer","args","_i","useImmediate","argOffset","inputValue","inputRange","outputRange","interpolator","interpolate","mixer","useOnChange","onChange","useMultiOnChange","handler","unsubscribe","useCombineMotionValues","combineValues","updateValue","useTransform","input","inputRangeOrTransformer","transformer","useListTransform","numValues","useDefaultMotionValue","defaultValue","ReorderItem","zIndex","latestX","latestY","gesturePoint","onLayoutMeasure","measured","Item","Reorder","domAnimation","domMax","useMotionTemplate","fragments","numFragments","buildValue","useSpring","activeSpringAnimation","attach","animate","onUpdate","useVelocity","velocityUpdateSubscribers","newVelocity","createScrollMotionValues","scrollX","scrollY","scrollXProgress","scrollYProgress","setProgress","maxOffset","createScrollUpdater","getOffsets","xOffset","yOffset","xMaxOffset","yMaxOffset","getElementScrollOffsets","scrollWidth","offsetWidth","scrollHeight","offsetHeight","useElementScroll","useIsomorphicLayoutEffect","updateScrollValues","scrollListener","resizeListener","viewportScrollValues","getViewportScrollOffsets","pageXOffset","pageYOffset","clientWidth","innerWidth","clientHeight","innerHeight","hasListeners","addEventListeners","useViewportScroll","getCurrentTime","performance","now","Date","useAnimationFrame","initialTimestamp","provideTimeSinceStart","useTime","t","prefersReducedMotion","initPrefersReducedMotion","matchMedia","motionMediaQuery_1","setReducedMotionPreferences","matches","addListener","useReducedMotion","shouldReduceMotion","setShouldReduceMotion","animationControls","hasMounted","pendingAnimations","subscribers","controls","definition","transitionOverride","animations_1","animateVisualElement","resolve","animation","setValues","useAnimation","useCycle","items","setItem","wrap","DragControls","componentControls","nativeEvent","createDragControls","useDragControls","useInstantLayoutTransition","startTransition","cb","isUpdating","blockUpdate","useInstantTransition","forceUpdate","forcedRenderCount","startInstantLayoutTransition","instantAnimationState","useResetProjection","reset","useCallback","resetTree","createObject","stateVisualElement","_state","initialState","useAnimatedState","setAnimationState","unmount","setProps","animationDefinition","maxScale","invertScale","hasWarned","useInvertedScale","parentScaleX","parentScaleY","useVisualElementContext","warning","scaleX","scaleY","FlatTree","MotionContext","MotionValue","isValidMotionProp","resolveMotionValue","useIsPresent","useDeprecatedAnimatedState","useDeprecatedInvertedScale"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar tslib = require('tslib');\nvar useMotionValue = require('./use-motion-value-4144a8cf.js');\nvar React = require('react');\nvar styleValueTypes = require('style-value-types');\nvar popmotion = require('popmotion');\nvar heyListen = require('hey-listen');\nvar sync = require('framesync');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nfunction _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = Object.create(null);\n    if (e) {\n        Object.keys(e).forEach(function (k) {\n            if (k !== 'default') {\n                var d = Object.getOwnPropertyDescriptor(e, k);\n                Object.defineProperty(n, k, d.get ? d : {\n                    enumerable: true,\n                    get: function () { return e[k]; }\n                });\n            }\n        });\n    }\n    n[\"default\"] = e;\n    return Object.freeze(n);\n}\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\nvar React__namespace = /*#__PURE__*/_interopNamespace(React);\nvar sync__default = /*#__PURE__*/_interopDefaultLegacy(sync);\n\n/**\n * Convert any React component into a `motion` component. The provided component\n * **must** use `React.forwardRef` to the underlying DOM component you want to animate.\n *\n * ```jsx\n * const Component = React.forwardRef((props, ref) => {\n *   return <div ref={ref} />\n * })\n *\n * const MotionComponent = motion(Component)\n * ```\n *\n * @public\n */\nfunction createMotionProxy(createConfig) {\n    function custom(Component, customMotionComponentConfig) {\n        if (customMotionComponentConfig === void 0) { customMotionComponentConfig = {}; }\n        return useMotionValue.createMotionComponent(createConfig(Component, customMotionComponentConfig));\n    }\n    if (typeof Proxy === \"undefined\") {\n        return custom;\n    }\n    /**\n     * A cache of generated `motion` components, e.g `motion.div`, `motion.input` etc.\n     * Rather than generating them anew every render.\n     */\n    var componentCache = new Map();\n    return new Proxy(custom, {\n        /**\n         * Called when `motion` is referenced with a prop: `motion.div`, `motion.input` etc.\n         * The prop name is passed through as `key` and we can use that to generate a `motion`\n         * DOM component with that name.\n         */\n        get: function (_target, key) {\n            /**\n             * If this element doesn't exist in the component cache, create it and cache.\n             */\n            if (!componentCache.has(key)) {\n                componentCache.set(key, custom(key));\n            }\n            return componentCache.get(key);\n        },\n    });\n}\n\n/**\n * We keep these listed seperately as we use the lowercase tag names as part\n * of the runtime bundle to detect SVG components\n */\nvar lowercaseSVGElements = [\n    \"animate\",\n    \"circle\",\n    \"defs\",\n    \"desc\",\n    \"ellipse\",\n    \"g\",\n    \"image\",\n    \"line\",\n    \"filter\",\n    \"marker\",\n    \"mask\",\n    \"metadata\",\n    \"path\",\n    \"pattern\",\n    \"polygon\",\n    \"polyline\",\n    \"rect\",\n    \"stop\",\n    \"svg\",\n    \"switch\",\n    \"symbol\",\n    \"text\",\n    \"tspan\",\n    \"use\",\n    \"view\",\n];\n\nfunction isSVGComponent(Component) {\n    if (\n    /**\n     * If it's not a string, it's a custom React component. Currently we only support\n     * HTML custom React components.\n     */\n    typeof Component !== \"string\" ||\n        /**\n         * If it contains a dash, the element is a custom HTML webcomponent.\n         */\n        Component.includes(\"-\")) {\n        return false;\n    }\n    else if (\n    /**\n     * If it's in our list of lowercase SVG tags, it's an SVG component\n     */\n    lowercaseSVGElements.indexOf(Component) > -1 ||\n        /**\n         * If it contains a capital letter, it's an SVG component\n         */\n        /[A-Z]/.test(Component)) {\n        return true;\n    }\n    return false;\n}\n\nfunction isForcedMotionValue(key, _a) {\n    var layout = _a.layout, layoutId = _a.layoutId;\n    return (useMotionValue.isTransformProp(key) ||\n        useMotionValue.isTransformOriginProp(key) ||\n        ((layout || layoutId !== undefined) &&\n            (!!useMotionValue.scaleCorrectors[key] || key === \"opacity\")));\n}\n\nvar translateAlias = {\n    x: \"translateX\",\n    y: \"translateY\",\n    z: \"translateZ\",\n    transformPerspective: \"perspective\",\n};\n/**\n * Build a CSS transform style from individual x/y/scale etc properties.\n *\n * This outputs with a default order of transforms/scales/rotations, this can be customised by\n * providing a transformTemplate function.\n */\nfunction buildTransform(_a, _b, transformIsDefault, transformTemplate) {\n    var transform = _a.transform, transformKeys = _a.transformKeys;\n    var _c = _b.enableHardwareAcceleration, enableHardwareAcceleration = _c === void 0 ? true : _c, _d = _b.allowTransformNone, allowTransformNone = _d === void 0 ? true : _d;\n    // The transform string we're going to build into.\n    var transformString = \"\";\n    // Transform keys into their default order - this will determine the output order.\n    transformKeys.sort(useMotionValue.sortTransformProps);\n    // Track whether the defined transform has a defined z so we don't add a\n    // second to enable hardware acceleration\n    var transformHasZ = false;\n    // Loop over each transform and build them into transformString\n    var numTransformKeys = transformKeys.length;\n    for (var i = 0; i < numTransformKeys; i++) {\n        var key = transformKeys[i];\n        transformString += \"\".concat(translateAlias[key] || key, \"(\").concat(transform[key], \") \");\n        if (key === \"z\")\n            transformHasZ = true;\n    }\n    if (!transformHasZ && enableHardwareAcceleration) {\n        transformString += \"translateZ(0)\";\n    }\n    else {\n        transformString = transformString.trim();\n    }\n    // If we have a custom `transform` template, pass our transform values and\n    // generated transformString to that before returning\n    if (transformTemplate) {\n        transformString = transformTemplate(transform, transformIsDefault ? \"\" : transformString);\n    }\n    else if (allowTransformNone && transformIsDefault) {\n        transformString = \"none\";\n    }\n    return transformString;\n}\n/**\n * Build a transformOrigin style. Uses the same defaults as the browser for\n * undefined origins.\n */\nfunction buildTransformOrigin(_a) {\n    var _b = _a.originX, originX = _b === void 0 ? \"50%\" : _b, _c = _a.originY, originY = _c === void 0 ? \"50%\" : _c, _d = _a.originZ, originZ = _d === void 0 ? 0 : _d;\n    return \"\".concat(originX, \" \").concat(originY, \" \").concat(originZ);\n}\n\n/**\n * Returns true if the provided key is a CSS variable\n */\nfunction isCSSVariable$1(key) {\n    return key.startsWith(\"--\");\n}\n\n/**\n * Provided a value and a ValueType, returns the value as that value type.\n */\nvar getValueAsType = function (value, type) {\n    return type && typeof value === \"number\"\n        ? type.transform(value)\n        : value;\n};\n\nfunction buildHTMLStyles(state, latestValues, options, transformTemplate) {\n    var _a;\n    var style = state.style, vars = state.vars, transform = state.transform, transformKeys = state.transformKeys, transformOrigin = state.transformOrigin;\n    // Empty the transformKeys array. As we're throwing out refs to its items\n    // this might not be as cheap as suspected. Maybe using the array as a buffer\n    // with a manual incrementation would be better.\n    transformKeys.length = 0;\n    // Track whether we encounter any transform or transformOrigin values.\n    var hasTransform = false;\n    var hasTransformOrigin = false;\n    // Does the calculated transform essentially equal \"none\"?\n    var transformIsNone = true;\n    /**\n     * Loop over all our latest animated values and decide whether to handle them\n     * as a style or CSS variable.\n     *\n     * Transforms and transform origins are kept seperately for further processing.\n     */\n    for (var key in latestValues) {\n        var value = latestValues[key];\n        /**\n         * If this is a CSS variable we don't do any further processing.\n         */\n        if (isCSSVariable$1(key)) {\n            vars[key] = value;\n            continue;\n        }\n        // Convert the value to its default value type, ie 0 -> \"0px\"\n        var valueType = useMotionValue.numberValueTypes[key];\n        var valueAsType = getValueAsType(value, valueType);\n        if (useMotionValue.isTransformProp(key)) {\n            // If this is a transform, flag to enable further transform processing\n            hasTransform = true;\n            transform[key] = valueAsType;\n            transformKeys.push(key);\n            // If we already know we have a non-default transform, early return\n            if (!transformIsNone)\n                continue;\n            // Otherwise check to see if this is a default transform\n            if (value !== ((_a = valueType.default) !== null && _a !== void 0 ? _a : 0))\n                transformIsNone = false;\n        }\n        else if (useMotionValue.isTransformOriginProp(key)) {\n            transformOrigin[key] = valueAsType;\n            // If this is a transform origin, flag and enable further transform-origin processing\n            hasTransformOrigin = true;\n        }\n        else {\n            style[key] = valueAsType;\n        }\n    }\n    if (hasTransform) {\n        style.transform = buildTransform(state, options, transformIsNone, transformTemplate);\n    }\n    else if (transformTemplate) {\n        style.transform = transformTemplate({}, \"\");\n    }\n    else if (!latestValues.transform && style.transform) {\n        style.transform = \"none\";\n    }\n    if (hasTransformOrigin) {\n        style.transformOrigin = buildTransformOrigin(transformOrigin);\n    }\n}\n\nvar createHtmlRenderState = function () { return ({\n    style: {},\n    transform: {},\n    transformKeys: [],\n    transformOrigin: {},\n    vars: {},\n}); };\n\nfunction copyRawValuesOnly(target, source, props) {\n    for (var key in source) {\n        if (!useMotionValue.isMotionValue(source[key]) && !isForcedMotionValue(key, props)) {\n            target[key] = source[key];\n        }\n    }\n}\nfunction useInitialMotionValues(_a, visualState, isStatic) {\n    var transformTemplate = _a.transformTemplate;\n    return React.useMemo(function () {\n        var state = createHtmlRenderState();\n        buildHTMLStyles(state, visualState, { enableHardwareAcceleration: !isStatic }, transformTemplate);\n        var vars = state.vars, style = state.style;\n        return tslib.__assign(tslib.__assign({}, vars), style);\n    }, [visualState]);\n}\nfunction useStyle(props, visualState, isStatic) {\n    var styleProp = props.style || {};\n    var style = {};\n    /**\n     * Copy non-Motion Values straight into style\n     */\n    copyRawValuesOnly(style, styleProp, props);\n    Object.assign(style, useInitialMotionValues(props, visualState, isStatic));\n    if (props.transformValues) {\n        style = props.transformValues(style);\n    }\n    return style;\n}\nfunction useHTMLProps(props, visualState, isStatic) {\n    // The `any` isn't ideal but it is the type of createElement props argument\n    var htmlProps = {};\n    var style = useStyle(props, visualState, isStatic);\n    if (Boolean(props.drag) && props.dragListener !== false) {\n        // Disable the ghost element when a user drags\n        htmlProps.draggable = false;\n        // Disable text selection\n        style.userSelect =\n            style.WebkitUserSelect =\n                style.WebkitTouchCallout =\n                    \"none\";\n        // Disable scrolling on the draggable direction\n        style.touchAction =\n            props.drag === true\n                ? \"none\"\n                : \"pan-\".concat(props.drag === \"x\" ? \"y\" : \"x\");\n    }\n    htmlProps.style = style;\n    return htmlProps;\n}\n\nfunction calcOrigin$1(origin, offset, size) {\n    return typeof origin === \"string\"\n        ? origin\n        : styleValueTypes.px.transform(offset + size * origin);\n}\n/**\n * The SVG transform origin defaults are different to CSS and is less intuitive,\n * so we use the measured dimensions of the SVG to reconcile these.\n */\nfunction calcSVGTransformOrigin(dimensions, originX, originY) {\n    var pxOriginX = calcOrigin$1(originX, dimensions.x, dimensions.width);\n    var pxOriginY = calcOrigin$1(originY, dimensions.y, dimensions.height);\n    return \"\".concat(pxOriginX, \" \").concat(pxOriginY);\n}\n\nvar dashKeys = {\n    offset: \"stroke-dashoffset\",\n    array: \"stroke-dasharray\",\n};\nvar camelKeys = {\n    offset: \"strokeDashoffset\",\n    array: \"strokeDasharray\",\n};\n/**\n * Build SVG path properties. Uses the path's measured length to convert\n * our custom pathLength, pathSpacing and pathOffset into stroke-dashoffset\n * and stroke-dasharray attributes.\n *\n * This function is mutative to reduce per-frame GC.\n */\nfunction buildSVGPath(attrs, length, spacing, offset, useDashCase) {\n    if (spacing === void 0) { spacing = 1; }\n    if (offset === void 0) { offset = 0; }\n    if (useDashCase === void 0) { useDashCase = true; }\n    // Normalise path length by setting SVG attribute pathLength to 1\n    attrs.pathLength = 1;\n    // We use dash case when setting attributes directly to the DOM node and camel case\n    // when defining props on a React component.\n    var keys = useDashCase ? dashKeys : camelKeys;\n    // Build the dash offset\n    attrs[keys.offset] = styleValueTypes.px.transform(-offset);\n    // Build the dash array\n    var pathLength = styleValueTypes.px.transform(length);\n    var pathSpacing = styleValueTypes.px.transform(spacing);\n    attrs[keys.array] = \"\".concat(pathLength, \" \").concat(pathSpacing);\n}\n\n/**\n * Build SVG visual attrbutes, like cx and style.transform\n */\nfunction buildSVGAttrs(state, _a, options, transformTemplate) {\n    var attrX = _a.attrX, attrY = _a.attrY, originX = _a.originX, originY = _a.originY, pathLength = _a.pathLength, _b = _a.pathSpacing, pathSpacing = _b === void 0 ? 1 : _b, _c = _a.pathOffset, pathOffset = _c === void 0 ? 0 : _c, \n    // This is object creation, which we try to avoid per-frame.\n    latest = tslib.__rest(_a, [\"attrX\", \"attrY\", \"originX\", \"originY\", \"pathLength\", \"pathSpacing\", \"pathOffset\"]);\n    buildHTMLStyles(state, latest, options, transformTemplate);\n    state.attrs = state.style;\n    state.style = {};\n    var attrs = state.attrs, style = state.style, dimensions = state.dimensions;\n    /**\n     * However, we apply transforms as CSS transforms. So if we detect a transform we take it from attrs\n     * and copy it into style.\n     */\n    if (attrs.transform) {\n        if (dimensions)\n            style.transform = attrs.transform;\n        delete attrs.transform;\n    }\n    // Parse transformOrigin\n    if (dimensions &&\n        (originX !== undefined || originY !== undefined || style.transform)) {\n        style.transformOrigin = calcSVGTransformOrigin(dimensions, originX !== undefined ? originX : 0.5, originY !== undefined ? originY : 0.5);\n    }\n    // Treat x/y not as shortcuts but as actual attributes\n    if (attrX !== undefined)\n        attrs.x = attrX;\n    if (attrY !== undefined)\n        attrs.y = attrY;\n    // Build SVG path if one has been defined\n    if (pathLength !== undefined) {\n        buildSVGPath(attrs, pathLength, pathSpacing, pathOffset, false);\n    }\n}\n\nvar createSvgRenderState = function () { return (tslib.__assign(tslib.__assign({}, createHtmlRenderState()), { attrs: {} })); };\n\nfunction useSVGProps(props, visualState) {\n    var visualProps = React.useMemo(function () {\n        var state = createSvgRenderState();\n        buildSVGAttrs(state, visualState, { enableHardwareAcceleration: false }, props.transformTemplate);\n        return tslib.__assign(tslib.__assign({}, state.attrs), { style: tslib.__assign({}, state.style) });\n    }, [visualState]);\n    if (props.style) {\n        var rawStyles = {};\n        copyRawValuesOnly(rawStyles, props.style, props);\n        visualProps.style = tslib.__assign(tslib.__assign({}, rawStyles), visualProps.style);\n    }\n    return visualProps;\n}\n\nfunction createUseRender(forwardMotionProps) {\n    if (forwardMotionProps === void 0) { forwardMotionProps = false; }\n    var useRender = function (Component, props, projectionId, ref, _a, isStatic) {\n        var latestValues = _a.latestValues;\n        var useVisualProps = isSVGComponent(Component)\n            ? useSVGProps\n            : useHTMLProps;\n        var visualProps = useVisualProps(props, latestValues, isStatic);\n        var filteredProps = useMotionValue.filterProps(props, typeof Component === \"string\", forwardMotionProps);\n        var elementProps = tslib.__assign(tslib.__assign(tslib.__assign({}, filteredProps), visualProps), { ref: ref });\n        if (projectionId) {\n            elementProps[\"data-projection-id\"] = projectionId;\n        }\n        return React.createElement(Component, elementProps);\n    };\n    return useRender;\n}\n\nvar CAMEL_CASE_PATTERN = /([a-z])([A-Z])/g;\nvar REPLACE_TEMPLATE = \"$1-$2\";\n/**\n * Convert camelCase to dash-case properties.\n */\nvar camelToDash = function (str) {\n    return str.replace(CAMEL_CASE_PATTERN, REPLACE_TEMPLATE).toLowerCase();\n};\n\nfunction renderHTML(element, _a, styleProp, projection) {\n    var style = _a.style, vars = _a.vars;\n    Object.assign(element.style, style, projection && projection.getProjectionStyles(styleProp));\n    // Loop over any CSS variables and assign those.\n    for (var key in vars) {\n        element.style.setProperty(key, vars[key]);\n    }\n}\n\n/**\n * A set of attribute names that are always read/written as camel case.\n */\nvar camelCaseAttributes = new Set([\n    \"baseFrequency\",\n    \"diffuseConstant\",\n    \"kernelMatrix\",\n    \"kernelUnitLength\",\n    \"keySplines\",\n    \"keyTimes\",\n    \"limitingConeAngle\",\n    \"markerHeight\",\n    \"markerWidth\",\n    \"numOctaves\",\n    \"targetX\",\n    \"targetY\",\n    \"surfaceScale\",\n    \"specularConstant\",\n    \"specularExponent\",\n    \"stdDeviation\",\n    \"tableValues\",\n    \"viewBox\",\n    \"gradientTransform\",\n    \"pathLength\",\n]);\n\nfunction renderSVG(element, renderState) {\n    renderHTML(element, renderState);\n    for (var key in renderState.attrs) {\n        element.setAttribute(!camelCaseAttributes.has(key) ? camelToDash(key) : key, renderState.attrs[key]);\n    }\n}\n\nfunction scrapeMotionValuesFromProps$1(props) {\n    var style = props.style;\n    var newValues = {};\n    for (var key in style) {\n        if (useMotionValue.isMotionValue(style[key]) || isForcedMotionValue(key, props)) {\n            newValues[key] = style[key];\n        }\n    }\n    return newValues;\n}\n\nfunction scrapeMotionValuesFromProps(props) {\n    var newValues = scrapeMotionValuesFromProps$1(props);\n    for (var key in props) {\n        if (useMotionValue.isMotionValue(props[key])) {\n            var targetKey = key === \"x\" || key === \"y\" ? \"attr\" + key.toUpperCase() : key;\n            newValues[targetKey] = props[key];\n        }\n    }\n    return newValues;\n}\n\nvar svgMotionConfig = {\n    useVisualState: useMotionValue.makeUseVisualState({\n        scrapeMotionValuesFromProps: scrapeMotionValuesFromProps,\n        createRenderState: createSvgRenderState,\n        onMount: function (props, instance, _a) {\n            var renderState = _a.renderState, latestValues = _a.latestValues;\n            try {\n                renderState.dimensions =\n                    typeof instance.getBBox ===\n                        \"function\"\n                        ? instance.getBBox()\n                        : instance.getBoundingClientRect();\n            }\n            catch (e) {\n                // Most likely trying to measure an unrendered element under Firefox\n                renderState.dimensions = {\n                    x: 0,\n                    y: 0,\n                    width: 0,\n                    height: 0,\n                };\n            }\n            buildSVGAttrs(renderState, latestValues, { enableHardwareAcceleration: false }, props.transformTemplate);\n            // TODO: Replace with direct assignment\n            renderSVG(instance, renderState);\n        },\n    }),\n};\n\nvar htmlMotionConfig = {\n    useVisualState: useMotionValue.makeUseVisualState({\n        scrapeMotionValuesFromProps: scrapeMotionValuesFromProps$1,\n        createRenderState: createHtmlRenderState,\n    }),\n};\n\nfunction createDomMotionConfig(Component, _a, preloadedFeatures, createVisualElement, projectionNodeConstructor) {\n    var _b = _a.forwardMotionProps, forwardMotionProps = _b === void 0 ? false : _b;\n    var baseConfig = isSVGComponent(Component)\n        ? svgMotionConfig\n        : htmlMotionConfig;\n    return tslib.__assign(tslib.__assign({}, baseConfig), { preloadedFeatures: preloadedFeatures, useRender: createUseRender(forwardMotionProps), createVisualElement: createVisualElement, projectionNodeConstructor: projectionNodeConstructor, Component: Component });\n}\n\n/**\n *\n * @param props\n * @param ref\n * @internal\n */\nfunction useFocusGesture(_a) {\n    var whileFocus = _a.whileFocus, visualElement = _a.visualElement;\n    var onFocus = function () {\n        var _a;\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Focus, true);\n    };\n    var onBlur = function () {\n        var _a;\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Focus, false);\n    };\n    useMotionValue.useDomEvent(visualElement, \"focus\", whileFocus ? onFocus : undefined);\n    useMotionValue.useDomEvent(visualElement, \"blur\", whileFocus ? onBlur : undefined);\n}\n\nfunction createHoverEvent(visualElement, isActive, callback) {\n    return function (event, info) {\n        var _a;\n        if (!useMotionValue.isMouseEvent(event) || useMotionValue.isDragActive())\n            return;\n        /**\n         * Ensure we trigger animations before firing event callback\n         */\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Hover, isActive);\n        callback === null || callback === void 0 ? void 0 : callback(event, info);\n    };\n}\nfunction useHoverGesture(_a) {\n    var onHoverStart = _a.onHoverStart, onHoverEnd = _a.onHoverEnd, whileHover = _a.whileHover, visualElement = _a.visualElement;\n    useMotionValue.usePointerEvent(visualElement, \"pointerenter\", onHoverStart || whileHover\n        ? createHoverEvent(visualElement, true, onHoverStart)\n        : undefined);\n    useMotionValue.usePointerEvent(visualElement, \"pointerleave\", onHoverEnd || whileHover\n        ? createHoverEvent(visualElement, false, onHoverEnd)\n        : undefined);\n}\n\n/**\n * Recursively traverse up the tree to check whether the provided child node\n * is the parent or a descendant of it.\n *\n * @param parent - Element to find\n * @param child - Element to test against parent\n */\nvar isNodeOrChild = function (parent, child) {\n    if (!child) {\n        return false;\n    }\n    else if (parent === child) {\n        return true;\n    }\n    else {\n        return isNodeOrChild(parent, child.parentElement);\n    }\n};\n\n/**\n * @param handlers -\n * @internal\n */\nfunction useTapGesture(_a) {\n    var onTap = _a.onTap, onTapStart = _a.onTapStart, onTapCancel = _a.onTapCancel, whileTap = _a.whileTap, visualElement = _a.visualElement;\n    var hasPressListeners = onTap || onTapStart || onTapCancel || whileTap;\n    var isPressing = React.useRef(false);\n    var cancelPointerEndListeners = React.useRef(null);\n    function removePointerEndListener() {\n        var _a;\n        (_a = cancelPointerEndListeners.current) === null || _a === void 0 ? void 0 : _a.call(cancelPointerEndListeners);\n        cancelPointerEndListeners.current = null;\n    }\n    function checkPointerEnd() {\n        var _a;\n        removePointerEndListener();\n        isPressing.current = false;\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Tap, false);\n        return !useMotionValue.isDragActive();\n    }\n    function onPointerUp(event, info) {\n        if (!checkPointerEnd())\n            return;\n        /**\n         * We only count this as a tap gesture if the event.target is the same\n         * as, or a child of, this component's element\n         */\n        !isNodeOrChild(visualElement.getInstance(), event.target)\n            ? onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info)\n            : onTap === null || onTap === void 0 ? void 0 : onTap(event, info);\n    }\n    function onPointerCancel(event, info) {\n        if (!checkPointerEnd())\n            return;\n        onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info);\n    }\n    function onPointerDown(event, info) {\n        var _a;\n        removePointerEndListener();\n        if (isPressing.current)\n            return;\n        isPressing.current = true;\n        cancelPointerEndListeners.current = popmotion.pipe(useMotionValue.addPointerEvent(window, \"pointerup\", onPointerUp), useMotionValue.addPointerEvent(window, \"pointercancel\", onPointerCancel));\n        /**\n         * Ensure we trigger animations before firing event callback\n         */\n        (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Tap, true);\n        onTapStart === null || onTapStart === void 0 ? void 0 : onTapStart(event, info);\n    }\n    useMotionValue.usePointerEvent(visualElement, \"pointerdown\", hasPressListeners ? onPointerDown : undefined);\n    useMotionValue.useUnmountEffect(removePointerEndListener);\n}\n\nvar warned = new Set();\nfunction warnOnce(condition, message, element) {\n    if (condition || warned.has(message))\n        return;\n    console.warn(message);\n    if (element)\n        console.warn(element);\n    warned.add(message);\n}\n\n/**\n * Map an IntersectionHandler callback to an element. We only ever make one handler for one\n * element, so even though these handlers might all be triggered by different\n * observers, we can keep them in the same map.\n */\nvar observerCallbacks = new WeakMap();\n/**\n * Multiple observers can be created for multiple element/document roots. Each with\n * different settings. So here we store dictionaries of observers to each root,\n * using serialised settings (threshold/margin) as lookup keys.\n */\nvar observers = new WeakMap();\nvar fireObserverCallback = function (entry) {\n    var _a;\n    (_a = observerCallbacks.get(entry.target)) === null || _a === void 0 ? void 0 : _a(entry);\n};\nvar fireAllObserverCallbacks = function (entries) {\n    entries.forEach(fireObserverCallback);\n};\nfunction initIntersectionObserver(_a) {\n    var root = _a.root, options = tslib.__rest(_a, [\"root\"]);\n    var lookupRoot = root || document;\n    /**\n     * If we don't have an observer lookup map for this root, create one.\n     */\n    if (!observers.has(lookupRoot)) {\n        observers.set(lookupRoot, {});\n    }\n    var rootObservers = observers.get(lookupRoot);\n    var key = JSON.stringify(options);\n    /**\n     * If we don't have an observer for this combination of root and settings,\n     * create one.\n     */\n    if (!rootObservers[key]) {\n        rootObservers[key] = new IntersectionObserver(fireAllObserverCallbacks, tslib.__assign({ root: root }, options));\n    }\n    return rootObservers[key];\n}\nfunction observeIntersection(element, options, callback) {\n    var rootInteresectionObserver = initIntersectionObserver(options);\n    observerCallbacks.set(element, callback);\n    rootInteresectionObserver.observe(element);\n    return function () {\n        observerCallbacks.delete(element);\n        rootInteresectionObserver.unobserve(element);\n    };\n}\n\nfunction useViewport(_a) {\n    var visualElement = _a.visualElement, whileInView = _a.whileInView, onViewportEnter = _a.onViewportEnter, onViewportLeave = _a.onViewportLeave, _b = _a.viewport, viewport = _b === void 0 ? {} : _b;\n    var state = React.useRef({\n        hasEnteredView: false,\n        isInView: false,\n    });\n    var shouldObserve = Boolean(whileInView || onViewportEnter || onViewportLeave);\n    if (viewport.once && state.current.hasEnteredView)\n        shouldObserve = false;\n    var useObserver = typeof IntersectionObserver === \"undefined\"\n        ? useMissingIntersectionObserver\n        : useIntersectionObserver;\n    useObserver(shouldObserve, state.current, visualElement, viewport);\n}\nvar thresholdNames = {\n    some: 0,\n    all: 1,\n};\nfunction useIntersectionObserver(shouldObserve, state, visualElement, _a) {\n    var root = _a.root, rootMargin = _a.margin, _b = _a.amount, amount = _b === void 0 ? \"some\" : _b, once = _a.once;\n    React.useEffect(function () {\n        if (!shouldObserve)\n            return;\n        var options = {\n            root: root === null || root === void 0 ? void 0 : root.current,\n            rootMargin: rootMargin,\n            threshold: typeof amount === \"number\" ? amount : thresholdNames[amount],\n        };\n        var intersectionCallback = function (entry) {\n            var _a;\n            var isIntersecting = entry.isIntersecting;\n            /**\n             * If there's been no change in the viewport state, early return.\n             */\n            if (state.isInView === isIntersecting)\n                return;\n            state.isInView = isIntersecting;\n            /**\n             * Handle hasEnteredView. If this is only meant to run once, and\n             * element isn't visible, early return. Otherwise set hasEnteredView to true.\n             */\n            if (once && !isIntersecting && state.hasEnteredView) {\n                return;\n            }\n            else if (isIntersecting) {\n                state.hasEnteredView = true;\n            }\n            (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.InView, isIntersecting);\n            /**\n             * Use the latest committed props rather than the ones in scope\n             * when this observer is created\n             */\n            var props = visualElement.getProps();\n            var callback = isIntersecting\n                ? props.onViewportEnter\n                : props.onViewportLeave;\n            callback === null || callback === void 0 ? void 0 : callback(entry);\n        };\n        return observeIntersection(visualElement.getInstance(), options, intersectionCallback);\n    }, [shouldObserve, root, rootMargin, amount]);\n}\n/**\n * If IntersectionObserver is missing, we activate inView and fire onViewportEnter\n * on mount. This way, the page will be in the state the author expects users\n * to see it in for everyone.\n */\nfunction useMissingIntersectionObserver(shouldObserve, state, visualElement) {\n    React.useEffect(function () {\n        if (!shouldObserve)\n            return;\n        if (process.env.NODE_ENV !== \"production\") {\n            warnOnce(false, \"IntersectionObserver not available on this device. whileInView animations will trigger on mount.\");\n        }\n        /**\n         * Fire this in an rAF because, at this point, the animation state\n         * won't have flushed for the first time and there's certain logic in\n         * there that behaves differently on the initial animation.\n         *\n         * This hook should be quite rarely called so setting this in an rAF\n         * is preferred to changing the behaviour of the animation state.\n         */\n        requestAnimationFrame(function () {\n            var _a;\n            state.hasEnteredView = true;\n            var onViewportEnter = visualElement.getProps().onViewportEnter;\n            onViewportEnter === null || onViewportEnter === void 0 ? void 0 : onViewportEnter(null);\n            (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.InView, true);\n        });\n    }, [shouldObserve]);\n}\n\nvar gestureAnimations = {\n    inView: useMotionValue.makeRenderlessComponent(useViewport),\n    tap: useMotionValue.makeRenderlessComponent(useTapGesture),\n    focus: useMotionValue.makeRenderlessComponent(useFocusGesture),\n    hover: useMotionValue.makeRenderlessComponent(useHoverGesture),\n};\n\n/**\n * @internal\n */\nvar PanSession = /** @class */ (function () {\n    function PanSession(event, handlers, _a) {\n        var _this = this;\n        var _b = _a === void 0 ? {} : _a, transformPagePoint = _b.transformPagePoint;\n        /**\n         * @internal\n         */\n        this.startEvent = null;\n        /**\n         * @internal\n         */\n        this.lastMoveEvent = null;\n        /**\n         * @internal\n         */\n        this.lastMoveEventInfo = null;\n        /**\n         * @internal\n         */\n        this.handlers = {};\n        this.updatePoint = function () {\n            if (!(_this.lastMoveEvent && _this.lastMoveEventInfo))\n                return;\n            var info = getPanInfo(_this.lastMoveEventInfo, _this.history);\n            var isPanStarted = _this.startEvent !== null;\n            // Only start panning if the offset is larger than 3 pixels. If we make it\n            // any larger than this we'll want to reset the pointer history\n            // on the first update to avoid visual snapping to the cursoe.\n            var isDistancePastThreshold = popmotion.distance(info.offset, { x: 0, y: 0 }) >= 3;\n            if (!isPanStarted && !isDistancePastThreshold)\n                return;\n            var point = info.point;\n            var timestamp = sync.getFrameData().timestamp;\n            _this.history.push(tslib.__assign(tslib.__assign({}, point), { timestamp: timestamp }));\n            var _a = _this.handlers, onStart = _a.onStart, onMove = _a.onMove;\n            if (!isPanStarted) {\n                onStart && onStart(_this.lastMoveEvent, info);\n                _this.startEvent = _this.lastMoveEvent;\n            }\n            onMove && onMove(_this.lastMoveEvent, info);\n        };\n        this.handlePointerMove = function (event, info) {\n            _this.lastMoveEvent = event;\n            _this.lastMoveEventInfo = transformPoint(info, _this.transformPagePoint);\n            // Because Safari doesn't trigger mouseup events when it's above a `<select>`\n            if (useMotionValue.isMouseEvent(event) && event.buttons === 0) {\n                _this.handlePointerUp(event, info);\n                return;\n            }\n            // Throttle mouse move event to once per frame\n            sync__default[\"default\"].update(_this.updatePoint, true);\n        };\n        this.handlePointerUp = function (event, info) {\n            _this.end();\n            var _a = _this.handlers, onEnd = _a.onEnd, onSessionEnd = _a.onSessionEnd;\n            var panInfo = getPanInfo(transformPoint(info, _this.transformPagePoint), _this.history);\n            if (_this.startEvent && onEnd) {\n                onEnd(event, panInfo);\n            }\n            onSessionEnd && onSessionEnd(event, panInfo);\n        };\n        // If we have more than one touch, don't start detecting this gesture\n        if (useMotionValue.isTouchEvent(event) && event.touches.length > 1)\n            return;\n        this.handlers = handlers;\n        this.transformPagePoint = transformPagePoint;\n        var info = useMotionValue.extractEventInfo(event);\n        var initialInfo = transformPoint(info, this.transformPagePoint);\n        var point = initialInfo.point;\n        var timestamp = sync.getFrameData().timestamp;\n        this.history = [tslib.__assign(tslib.__assign({}, point), { timestamp: timestamp })];\n        var onSessionStart = handlers.onSessionStart;\n        onSessionStart &&\n            onSessionStart(event, getPanInfo(initialInfo, this.history));\n        this.removeListeners = popmotion.pipe(useMotionValue.addPointerEvent(window, \"pointermove\", this.handlePointerMove), useMotionValue.addPointerEvent(window, \"pointerup\", this.handlePointerUp), useMotionValue.addPointerEvent(window, \"pointercancel\", this.handlePointerUp));\n    }\n    PanSession.prototype.updateHandlers = function (handlers) {\n        this.handlers = handlers;\n    };\n    PanSession.prototype.end = function () {\n        this.removeListeners && this.removeListeners();\n        sync.cancelSync.update(this.updatePoint);\n    };\n    return PanSession;\n}());\nfunction transformPoint(info, transformPagePoint) {\n    return transformPagePoint ? { point: transformPagePoint(info.point) } : info;\n}\nfunction subtractPoint(a, b) {\n    return { x: a.x - b.x, y: a.y - b.y };\n}\nfunction getPanInfo(_a, history) {\n    var point = _a.point;\n    return {\n        point: point,\n        delta: subtractPoint(point, lastDevicePoint(history)),\n        offset: subtractPoint(point, startDevicePoint(history)),\n        velocity: getVelocity(history, 0.1),\n    };\n}\nfunction startDevicePoint(history) {\n    return history[0];\n}\nfunction lastDevicePoint(history) {\n    return history[history.length - 1];\n}\nfunction getVelocity(history, timeDelta) {\n    if (history.length < 2) {\n        return { x: 0, y: 0 };\n    }\n    var i = history.length - 1;\n    var timestampedPoint = null;\n    var lastPoint = lastDevicePoint(history);\n    while (i >= 0) {\n        timestampedPoint = history[i];\n        if (lastPoint.timestamp - timestampedPoint.timestamp >\n            useMotionValue.secondsToMilliseconds(timeDelta)) {\n            break;\n        }\n        i--;\n    }\n    if (!timestampedPoint) {\n        return { x: 0, y: 0 };\n    }\n    var time = (lastPoint.timestamp - timestampedPoint.timestamp) / 1000;\n    if (time === 0) {\n        return { x: 0, y: 0 };\n    }\n    var currentVelocity = {\n        x: (lastPoint.x - timestampedPoint.x) / time,\n        y: (lastPoint.y - timestampedPoint.y) / time,\n    };\n    if (currentVelocity.x === Infinity) {\n        currentVelocity.x = 0;\n    }\n    if (currentVelocity.y === Infinity) {\n        currentVelocity.y = 0;\n    }\n    return currentVelocity;\n}\n\n/**\n * Apply constraints to a point. These constraints are both physical along an\n * axis, and an elastic factor that determines how much to constrain the point\n * by if it does lie outside the defined parameters.\n */\nfunction applyConstraints(point, _a, elastic) {\n    var min = _a.min, max = _a.max;\n    if (min !== undefined && point < min) {\n        // If we have a min point defined, and this is outside of that, constrain\n        point = elastic ? popmotion.mix(min, point, elastic.min) : Math.max(point, min);\n    }\n    else if (max !== undefined && point > max) {\n        // If we have a max point defined, and this is outside of that, constrain\n        point = elastic ? popmotion.mix(max, point, elastic.max) : Math.min(point, max);\n    }\n    return point;\n}\n/**\n * Calculate constraints in terms of the viewport when defined relatively to the\n * measured axis. This is measured from the nearest edge, so a max constraint of 200\n * on an axis with a max value of 300 would return a constraint of 500 - axis length\n */\nfunction calcRelativeAxisConstraints(axis, min, max) {\n    return {\n        min: min !== undefined ? axis.min + min : undefined,\n        max: max !== undefined\n            ? axis.max + max - (axis.max - axis.min)\n            : undefined,\n    };\n}\n/**\n * Calculate constraints in terms of the viewport when\n * defined relatively to the measured bounding box.\n */\nfunction calcRelativeConstraints(layoutBox, _a) {\n    var top = _a.top, left = _a.left, bottom = _a.bottom, right = _a.right;\n    return {\n        x: calcRelativeAxisConstraints(layoutBox.x, left, right),\n        y: calcRelativeAxisConstraints(layoutBox.y, top, bottom),\n    };\n}\n/**\n * Calculate viewport constraints when defined as another viewport-relative axis\n */\nfunction calcViewportAxisConstraints(layoutAxis, constraintsAxis) {\n    var _a;\n    var min = constraintsAxis.min - layoutAxis.min;\n    var max = constraintsAxis.max - layoutAxis.max;\n    // If the constraints axis is actually smaller than the layout axis then we can\n    // flip the constraints\n    if (constraintsAxis.max - constraintsAxis.min <\n        layoutAxis.max - layoutAxis.min) {\n        _a = tslib.__read([max, min], 2), min = _a[0], max = _a[1];\n    }\n    return { min: min, max: max };\n}\n/**\n * Calculate viewport constraints when defined as another viewport-relative box\n */\nfunction calcViewportConstraints(layoutBox, constraintsBox) {\n    return {\n        x: calcViewportAxisConstraints(layoutBox.x, constraintsBox.x),\n        y: calcViewportAxisConstraints(layoutBox.y, constraintsBox.y),\n    };\n}\n/**\n * Calculate a transform origin relative to the source axis, between 0-1, that results\n * in an asthetically pleasing scale/transform needed to project from source to target.\n */\nfunction calcOrigin(source, target) {\n    var origin = 0.5;\n    var sourceLength = useMotionValue.calcLength(source);\n    var targetLength = useMotionValue.calcLength(target);\n    if (targetLength > sourceLength) {\n        origin = popmotion.progress(target.min, target.max - sourceLength, source.min);\n    }\n    else if (sourceLength > targetLength) {\n        origin = popmotion.progress(source.min, source.max - targetLength, target.min);\n    }\n    return popmotion.clamp(0, 1, origin);\n}\n/**\n * Rebase the calculated viewport constraints relative to the layout.min point.\n */\nfunction rebaseAxisConstraints(layout, constraints) {\n    var relativeConstraints = {};\n    if (constraints.min !== undefined) {\n        relativeConstraints.min = constraints.min - layout.min;\n    }\n    if (constraints.max !== undefined) {\n        relativeConstraints.max = constraints.max - layout.min;\n    }\n    return relativeConstraints;\n}\nvar defaultElastic = 0.35;\n/**\n * Accepts a dragElastic prop and returns resolved elastic values for each axis.\n */\nfunction resolveDragElastic(dragElastic) {\n    if (dragElastic === void 0) { dragElastic = defaultElastic; }\n    if (dragElastic === false) {\n        dragElastic = 0;\n    }\n    else if (dragElastic === true) {\n        dragElastic = defaultElastic;\n    }\n    return {\n        x: resolveAxisElastic(dragElastic, \"left\", \"right\"),\n        y: resolveAxisElastic(dragElastic, \"top\", \"bottom\"),\n    };\n}\nfunction resolveAxisElastic(dragElastic, minLabel, maxLabel) {\n    return {\n        min: resolvePointElastic(dragElastic, minLabel),\n        max: resolvePointElastic(dragElastic, maxLabel),\n    };\n}\nfunction resolvePointElastic(dragElastic, label) {\n    var _a;\n    return typeof dragElastic === \"number\"\n        ? dragElastic\n        : (_a = dragElastic[label]) !== null && _a !== void 0 ? _a : 0;\n}\n\n/**\n * Bounding boxes tend to be defined as top, left, right, bottom. For various operations\n * it's easier to consider each axis individually. This function returns a bounding box\n * as a map of single-axis min/max values.\n */\nfunction convertBoundingBoxToBox(_a) {\n    var top = _a.top, left = _a.left, right = _a.right, bottom = _a.bottom;\n    return {\n        x: { min: left, max: right },\n        y: { min: top, max: bottom },\n    };\n}\nfunction convertBoxToBoundingBox(_a) {\n    var x = _a.x, y = _a.y;\n    return { top: y.min, right: x.max, bottom: y.max, left: x.min };\n}\n/**\n * Applies a TransformPoint function to a bounding box. TransformPoint is usually a function\n * provided by Framer to allow measured points to be corrected for device scaling. This is used\n * when measuring DOM elements and DOM event points.\n */\nfunction transformBoxPoints(point, transformPoint) {\n    if (!transformPoint)\n        return point;\n    var topLeft = transformPoint({ x: point.left, y: point.top });\n    var bottomRight = transformPoint({ x: point.right, y: point.bottom });\n    return {\n        top: topLeft.y,\n        left: topLeft.x,\n        bottom: bottomRight.y,\n        right: bottomRight.x,\n    };\n}\n\nfunction measureViewportBox(instance, transformPoint) {\n    return convertBoundingBoxToBox(transformBoxPoints(instance.getBoundingClientRect(), transformPoint));\n}\nfunction measurePageBox(element, rootProjectionNode, transformPagePoint) {\n    var viewportBox = measureViewportBox(element, transformPagePoint);\n    var scroll = rootProjectionNode.scroll;\n    if (scroll) {\n        useMotionValue.translateAxis(viewportBox.x, scroll.x);\n        useMotionValue.translateAxis(viewportBox.y, scroll.y);\n    }\n    return viewportBox;\n}\n\nvar elementDragControls = new WeakMap();\n/**\n *\n */\n// let latestPointerEvent: AnyPointerEvent\nvar VisualElementDragControls = /** @class */ (function () {\n    function VisualElementDragControls(visualElement) {\n        // This is a reference to the global drag gesture lock, ensuring only one component\n        // can \"capture\" the drag of one or both axes.\n        // TODO: Look into moving this into pansession?\n        this.openGlobalLock = null;\n        this.isDragging = false;\n        this.currentDirection = null;\n        this.originPoint = { x: 0, y: 0 };\n        /**\n         * The permitted boundaries of travel, in pixels.\n         */\n        this.constraints = false;\n        this.hasMutatedConstraints = false;\n        /**\n         * The per-axis resolved elastic values.\n         */\n        this.elastic = useMotionValue.createBox();\n        this.visualElement = visualElement;\n    }\n    VisualElementDragControls.prototype.start = function (originEvent, _a) {\n        var _this = this;\n        var _b = _a === void 0 ? {} : _a, _c = _b.snapToCursor, snapToCursor = _c === void 0 ? false : _c;\n        /**\n         * Don't start dragging if this component is exiting\n         */\n        if (this.visualElement.isPresent === false)\n            return;\n        var onSessionStart = function (event) {\n            // Stop any animations on both axis values immediately. This allows the user to throw and catch\n            // the component.\n            _this.stopAnimation();\n            if (snapToCursor) {\n                _this.snapToCursor(useMotionValue.extractEventInfo(event, \"page\").point);\n            }\n        };\n        var onStart = function (event, info) {\n            var _a;\n            // Attempt to grab the global drag gesture lock - maybe make this part of PanSession\n            var _b = _this.getProps(), drag = _b.drag, dragPropagation = _b.dragPropagation, onDragStart = _b.onDragStart;\n            if (drag && !dragPropagation) {\n                if (_this.openGlobalLock)\n                    _this.openGlobalLock();\n                _this.openGlobalLock = useMotionValue.getGlobalLock(drag);\n                // If we don 't have the lock, don't start dragging\n                if (!_this.openGlobalLock)\n                    return;\n            }\n            _this.isDragging = true;\n            _this.currentDirection = null;\n            _this.resolveConstraints();\n            if (_this.visualElement.projection) {\n                _this.visualElement.projection.isAnimationBlocked = true;\n                _this.visualElement.projection.target = undefined;\n            }\n            /**\n             * Record gesture origin\n             */\n            useMotionValue.eachAxis(function (axis) {\n                var _a, _b;\n                var current = _this.getAxisMotionValue(axis).get() || 0;\n                /**\n                 * If the MotionValue is a percentage value convert to px\n                 */\n                if (styleValueTypes.percent.test(current)) {\n                    var measuredAxis = (_b = (_a = _this.visualElement.projection) === null || _a === void 0 ? void 0 : _a.layout) === null || _b === void 0 ? void 0 : _b.actual[axis];\n                    if (measuredAxis) {\n                        var length_1 = useMotionValue.calcLength(measuredAxis);\n                        current = length_1 * (parseFloat(current) / 100);\n                    }\n                }\n                _this.originPoint[axis] = current;\n            });\n            // Fire onDragStart event\n            onDragStart === null || onDragStart === void 0 ? void 0 : onDragStart(event, info);\n            (_a = _this.visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(useMotionValue.AnimationType.Drag, true);\n        };\n        var onMove = function (event, info) {\n            // latestPointerEvent = event\n            var _a = _this.getProps(), dragPropagation = _a.dragPropagation, dragDirectionLock = _a.dragDirectionLock, onDirectionLock = _a.onDirectionLock, onDrag = _a.onDrag;\n            // If we didn't successfully receive the gesture lock, early return.\n            if (!dragPropagation && !_this.openGlobalLock)\n                return;\n            var offset = info.offset;\n            // Attempt to detect drag direction if directionLock is true\n            if (dragDirectionLock && _this.currentDirection === null) {\n                _this.currentDirection = getCurrentDirection(offset);\n                // If we've successfully set a direction, notify listener\n                if (_this.currentDirection !== null) {\n                    onDirectionLock === null || onDirectionLock === void 0 ? void 0 : onDirectionLock(_this.currentDirection);\n                }\n                return;\n            }\n            // Update each point with the latest position\n            _this.updateAxis(\"x\", info.point, offset);\n            _this.updateAxis(\"y\", info.point, offset);\n            /**\n             * Ideally we would leave the renderer to fire naturally at the end of\n             * this frame but if the element is about to change layout as the result\n             * of a re-render we want to ensure the browser can read the latest\n             * bounding box to ensure the pointer and element don't fall out of sync.\n             */\n            _this.visualElement.syncRender();\n            /**\n             * This must fire after the syncRender call as it might trigger a state\n             * change which itself might trigger a layout update.\n             */\n            onDrag === null || onDrag === void 0 ? void 0 : onDrag(event, info);\n        };\n        var onSessionEnd = function (event, info) {\n            return _this.stop(event, info);\n        };\n        this.panSession = new PanSession(originEvent, {\n            onSessionStart: onSessionStart,\n            onStart: onStart,\n            onMove: onMove,\n            onSessionEnd: onSessionEnd,\n        }, { transformPagePoint: this.visualElement.getTransformPagePoint() });\n    };\n    VisualElementDragControls.prototype.stop = function (event, info) {\n        var isDragging = this.isDragging;\n        this.cancel();\n        if (!isDragging)\n            return;\n        var velocity = info.velocity;\n        this.startAnimation(velocity);\n        var onDragEnd = this.getProps().onDragEnd;\n        onDragEnd === null || onDragEnd === void 0 ? void 0 : onDragEnd(event, info);\n    };\n    VisualElementDragControls.prototype.cancel = function () {\n        var _a, _b;\n        this.isDragging = false;\n        if (this.visualElement.projection) {\n            this.visualElement.projection.isAnimationBlocked = false;\n        }\n        (_a = this.panSession) === null || _a === void 0 ? void 0 : _a.end();\n        this.panSession = undefined;\n        var dragPropagation = this.getProps().dragPropagation;\n        if (!dragPropagation && this.openGlobalLock) {\n            this.openGlobalLock();\n            this.openGlobalLock = null;\n        }\n        (_b = this.visualElement.animationState) === null || _b === void 0 ? void 0 : _b.setActive(useMotionValue.AnimationType.Drag, false);\n    };\n    VisualElementDragControls.prototype.updateAxis = function (axis, _point, offset) {\n        var drag = this.getProps().drag;\n        // If we're not dragging this axis, do an early return.\n        if (!offset || !shouldDrag(axis, drag, this.currentDirection))\n            return;\n        var axisValue = this.getAxisMotionValue(axis);\n        var next = this.originPoint[axis] + offset[axis];\n        // Apply constraints\n        if (this.constraints && this.constraints[axis]) {\n            next = applyConstraints(next, this.constraints[axis], this.elastic[axis]);\n        }\n        axisValue.set(next);\n    };\n    VisualElementDragControls.prototype.resolveConstraints = function () {\n        var _this = this;\n        var _a = this.getProps(), dragConstraints = _a.dragConstraints, dragElastic = _a.dragElastic;\n        var layout = (this.visualElement.projection || {}).layout;\n        var prevConstraints = this.constraints;\n        if (dragConstraints && useMotionValue.isRefObject(dragConstraints)) {\n            if (!this.constraints) {\n                this.constraints = this.resolveRefConstraints();\n            }\n        }\n        else {\n            if (dragConstraints && layout) {\n                this.constraints = calcRelativeConstraints(layout.actual, dragConstraints);\n            }\n            else {\n                this.constraints = false;\n            }\n        }\n        this.elastic = resolveDragElastic(dragElastic);\n        /**\n         * If we're outputting to external MotionValues, we want to rebase the measured constraints\n         * from viewport-relative to component-relative.\n         */\n        if (prevConstraints !== this.constraints &&\n            layout &&\n            this.constraints &&\n            !this.hasMutatedConstraints) {\n            useMotionValue.eachAxis(function (axis) {\n                if (_this.getAxisMotionValue(axis)) {\n                    _this.constraints[axis] = rebaseAxisConstraints(layout.actual[axis], _this.constraints[axis]);\n                }\n            });\n        }\n    };\n    VisualElementDragControls.prototype.resolveRefConstraints = function () {\n        var _a = this.getProps(), constraints = _a.dragConstraints, onMeasureDragConstraints = _a.onMeasureDragConstraints;\n        if (!constraints || !useMotionValue.isRefObject(constraints))\n            return false;\n        var constraintsElement = constraints.current;\n        heyListen.invariant(constraintsElement !== null, \"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.\");\n        var projection = this.visualElement.projection;\n        // TODO\n        if (!projection || !projection.layout)\n            return false;\n        var constraintsBox = measurePageBox(constraintsElement, projection.root, this.visualElement.getTransformPagePoint());\n        var measuredConstraints = calcViewportConstraints(projection.layout.actual, constraintsBox);\n        /**\n         * If there's an onMeasureDragConstraints listener we call it and\n         * if different constraints are returned, set constraints to that\n         */\n        if (onMeasureDragConstraints) {\n            var userConstraints = onMeasureDragConstraints(convertBoxToBoundingBox(measuredConstraints));\n            this.hasMutatedConstraints = !!userConstraints;\n            if (userConstraints) {\n                measuredConstraints = convertBoundingBoxToBox(userConstraints);\n            }\n        }\n        return measuredConstraints;\n    };\n    VisualElementDragControls.prototype.startAnimation = function (velocity) {\n        var _this = this;\n        var _a = this.getProps(), drag = _a.drag, dragMomentum = _a.dragMomentum, dragElastic = _a.dragElastic, dragTransition = _a.dragTransition, dragSnapToOrigin = _a.dragSnapToOrigin, onDragTransitionEnd = _a.onDragTransitionEnd;\n        var constraints = this.constraints || {};\n        var momentumAnimations = useMotionValue.eachAxis(function (axis) {\n            var _a;\n            if (!shouldDrag(axis, drag, _this.currentDirection)) {\n                return;\n            }\n            var transition = (_a = constraints === null || constraints === void 0 ? void 0 : constraints[axis]) !== null && _a !== void 0 ? _a : {};\n            if (dragSnapToOrigin)\n                transition = { min: 0, max: 0 };\n            /**\n             * Overdamp the boundary spring if `dragElastic` is disabled. There's still a frame\n             * of spring animations so we should look into adding a disable spring option to `inertia`.\n             * We could do something here where we affect the `bounceStiffness` and `bounceDamping`\n             * using the value of `dragElastic`.\n             */\n            var bounceStiffness = dragElastic ? 200 : 1000000;\n            var bounceDamping = dragElastic ? 40 : 10000000;\n            var inertia = tslib.__assign(tslib.__assign({ type: \"inertia\", velocity: dragMomentum ? velocity[axis] : 0, bounceStiffness: bounceStiffness, bounceDamping: bounceDamping, timeConstant: 750, restDelta: 1, restSpeed: 10 }, dragTransition), transition);\n            // If we're not animating on an externally-provided `MotionValue` we can use the\n            // component's animation controls which will handle interactions with whileHover (etc),\n            // otherwise we just have to animate the `MotionValue` itself.\n            return _this.startAxisValueAnimation(axis, inertia);\n        });\n        // Run all animations and then resolve the new drag constraints.\n        return Promise.all(momentumAnimations).then(onDragTransitionEnd);\n    };\n    VisualElementDragControls.prototype.startAxisValueAnimation = function (axis, transition) {\n        var axisValue = this.getAxisMotionValue(axis);\n        return useMotionValue.startAnimation(axis, axisValue, 0, transition);\n    };\n    VisualElementDragControls.prototype.stopAnimation = function () {\n        var _this = this;\n        useMotionValue.eachAxis(function (axis) { return _this.getAxisMotionValue(axis).stop(); });\n    };\n    /**\n     * Drag works differently depending on which props are provided.\n     *\n     * - If _dragX and _dragY are provided, we output the gesture delta directly to those motion values.\n     * - Otherwise, we apply the delta to the x/y motion values.\n     */\n    VisualElementDragControls.prototype.getAxisMotionValue = function (axis) {\n        var _a, _b;\n        var dragKey = \"_drag\" + axis.toUpperCase();\n        var externalMotionValue = this.visualElement.getProps()[dragKey];\n        return externalMotionValue\n            ? externalMotionValue\n            : this.visualElement.getValue(axis, (_b = (_a = this.visualElement.getProps().initial) === null || _a === void 0 ? void 0 : _a[axis]) !== null && _b !== void 0 ? _b : 0);\n    };\n    VisualElementDragControls.prototype.snapToCursor = function (point) {\n        var _this = this;\n        useMotionValue.eachAxis(function (axis) {\n            var drag = _this.getProps().drag;\n            // If we're not dragging this axis, do an early return.\n            if (!shouldDrag(axis, drag, _this.currentDirection))\n                return;\n            var projection = _this.visualElement.projection;\n            var axisValue = _this.getAxisMotionValue(axis);\n            if (projection && projection.layout) {\n                var _a = projection.layout.actual[axis], min = _a.min, max = _a.max;\n                axisValue.set(point[axis] - popmotion.mix(min, max, 0.5));\n            }\n        });\n    };\n    /**\n     * When the viewport resizes we want to check if the measured constraints\n     * have changed and, if so, reposition the element within those new constraints\n     * relative to where it was before the resize.\n     */\n    VisualElementDragControls.prototype.scalePositionWithinConstraints = function () {\n        var _this = this;\n        var _a;\n        var _b = this.getProps(), drag = _b.drag, dragConstraints = _b.dragConstraints;\n        var projection = this.visualElement.projection;\n        if (!useMotionValue.isRefObject(dragConstraints) || !projection || !this.constraints)\n            return;\n        /**\n         * Stop current animations as there can be visual glitching if we try to do\n         * this mid-animation\n         */\n        this.stopAnimation();\n        /**\n         * Record the relative position of the dragged element relative to the\n         * constraints box and save as a progress value.\n         */\n        var boxProgress = { x: 0, y: 0 };\n        useMotionValue.eachAxis(function (axis) {\n            var axisValue = _this.getAxisMotionValue(axis);\n            if (axisValue) {\n                var latest = axisValue.get();\n                boxProgress[axis] = calcOrigin({ min: latest, max: latest }, _this.constraints[axis]);\n            }\n        });\n        /**\n         * Update the layout of this element and resolve the latest drag constraints\n         */\n        var transformTemplate = this.visualElement.getProps().transformTemplate;\n        this.visualElement.getInstance().style.transform = transformTemplate\n            ? transformTemplate({}, \"\")\n            : \"none\";\n        (_a = projection.root) === null || _a === void 0 ? void 0 : _a.updateScroll();\n        projection.updateLayout();\n        this.resolveConstraints();\n        /**\n         * For each axis, calculate the current progress of the layout axis\n         * within the new constraints.\n         */\n        useMotionValue.eachAxis(function (axis) {\n            if (!shouldDrag(axis, drag, null))\n                return;\n            /**\n             * Calculate a new transform based on the previous box progress\n             */\n            var axisValue = _this.getAxisMotionValue(axis);\n            var _a = _this.constraints[axis], min = _a.min, max = _a.max;\n            axisValue.set(popmotion.mix(min, max, boxProgress[axis]));\n        });\n    };\n    VisualElementDragControls.prototype.addListeners = function () {\n        var _this = this;\n        var _a;\n        elementDragControls.set(this.visualElement, this);\n        var element = this.visualElement.getInstance();\n        /**\n         * Attach a pointerdown event listener on this DOM element to initiate drag tracking.\n         */\n        var stopPointerListener = useMotionValue.addPointerEvent(element, \"pointerdown\", function (event) {\n            var _a = _this.getProps(), drag = _a.drag, _b = _a.dragListener, dragListener = _b === void 0 ? true : _b;\n            drag && dragListener && _this.start(event);\n        });\n        var measureDragConstraints = function () {\n            var dragConstraints = _this.getProps().dragConstraints;\n            if (useMotionValue.isRefObject(dragConstraints)) {\n                _this.constraints = _this.resolveRefConstraints();\n            }\n        };\n        var projection = this.visualElement.projection;\n        var stopMeasureLayoutListener = projection.addEventListener(\"measure\", measureDragConstraints);\n        if (projection && !projection.layout) {\n            (_a = projection.root) === null || _a === void 0 ? void 0 : _a.updateScroll();\n            projection.updateLayout();\n        }\n        measureDragConstraints();\n        /**\n         * Attach a window resize listener to scale the draggable target within its defined\n         * constraints as the window resizes.\n         */\n        var stopResizeListener = useMotionValue.addDomEvent(window, \"resize\", function () {\n            _this.scalePositionWithinConstraints();\n        });\n        /**\n         * If the element's layout changes, calculate the delta and apply that to\n         * the drag gesture's origin point.\n         */\n        projection.addEventListener(\"didUpdate\", (function (_a) {\n            var delta = _a.delta, hasLayoutChanged = _a.hasLayoutChanged;\n            if (_this.isDragging && hasLayoutChanged) {\n                useMotionValue.eachAxis(function (axis) {\n                    var motionValue = _this.getAxisMotionValue(axis);\n                    if (!motionValue)\n                        return;\n                    _this.originPoint[axis] += delta[axis].translate;\n                    motionValue.set(motionValue.get() + delta[axis].translate);\n                });\n                _this.visualElement.syncRender();\n            }\n        }));\n        return function () {\n            stopResizeListener();\n            stopPointerListener();\n            stopMeasureLayoutListener();\n        };\n    };\n    VisualElementDragControls.prototype.getProps = function () {\n        var props = this.visualElement.getProps();\n        var _a = props.drag, drag = _a === void 0 ? false : _a, _b = props.dragDirectionLock, dragDirectionLock = _b === void 0 ? false : _b, _c = props.dragPropagation, dragPropagation = _c === void 0 ? false : _c, _d = props.dragConstraints, dragConstraints = _d === void 0 ? false : _d, _e = props.dragElastic, dragElastic = _e === void 0 ? defaultElastic : _e, _f = props.dragMomentum, dragMomentum = _f === void 0 ? true : _f;\n        return tslib.__assign(tslib.__assign({}, props), { drag: drag, dragDirectionLock: dragDirectionLock, dragPropagation: dragPropagation, dragConstraints: dragConstraints, dragElastic: dragElastic, dragMomentum: dragMomentum });\n    };\n    return VisualElementDragControls;\n}());\nfunction shouldDrag(direction, drag, currentDirection) {\n    return ((drag === true || drag === direction) &&\n        (currentDirection === null || currentDirection === direction));\n}\n/**\n * Based on an x/y offset determine the current drag direction. If both axis' offsets are lower\n * than the provided threshold, return `null`.\n *\n * @param offset - The x/y offset from origin.\n * @param lockThreshold - (Optional) - the minimum absolute offset before we can determine a drag direction.\n */\nfunction getCurrentDirection(offset, lockThreshold) {\n    if (lockThreshold === void 0) { lockThreshold = 10; }\n    var direction = null;\n    if (Math.abs(offset.y) > lockThreshold) {\n        direction = \"y\";\n    }\n    else if (Math.abs(offset.x) > lockThreshold) {\n        direction = \"x\";\n    }\n    return direction;\n}\n\n/**\n * A hook that allows an element to be dragged.\n *\n * @internal\n */\nfunction useDrag(props) {\n    var groupDragControls = props.dragControls, visualElement = props.visualElement;\n    var dragControls = useMotionValue.useConstant(function () { return new VisualElementDragControls(visualElement); });\n    // If we've been provided a DragControls for manual control over the drag gesture,\n    // subscribe this component to it on mount.\n    React.useEffect(function () { return groupDragControls && groupDragControls.subscribe(dragControls); }, [dragControls, groupDragControls]);\n    // Apply the event listeners to the element\n    React.useEffect(function () { return dragControls.addListeners(); }, [dragControls]);\n}\n\n/**\n *\n * @param handlers -\n * @param ref -\n *\n * @internalremarks\n * Currently this sets new pan gesture functions every render. The memo route has been explored\n * in the past but ultimately we're still creating new functions every render. An optimisation\n * to explore is creating the pan gestures and loading them into a `ref`.\n *\n * @internal\n */\nfunction usePanGesture(_a) {\n    var onPan = _a.onPan, onPanStart = _a.onPanStart, onPanEnd = _a.onPanEnd, onPanSessionStart = _a.onPanSessionStart, visualElement = _a.visualElement;\n    var hasPanEvents = onPan || onPanStart || onPanEnd || onPanSessionStart;\n    var panSession = React.useRef(null);\n    var transformPagePoint = React.useContext(useMotionValue.MotionConfigContext).transformPagePoint;\n    var handlers = {\n        onSessionStart: onPanSessionStart,\n        onStart: onPanStart,\n        onMove: onPan,\n        onEnd: function (event, info) {\n            panSession.current = null;\n            onPanEnd && onPanEnd(event, info);\n        },\n    };\n    React.useEffect(function () {\n        if (panSession.current !== null) {\n            panSession.current.updateHandlers(handlers);\n        }\n    });\n    function onPointerDown(event) {\n        panSession.current = new PanSession(event, handlers, {\n            transformPagePoint: transformPagePoint,\n        });\n    }\n    useMotionValue.usePointerEvent(visualElement, \"pointerdown\", hasPanEvents && onPointerDown);\n    useMotionValue.useUnmountEffect(function () { return panSession.current && panSession.current.end(); });\n}\n\nvar drag = {\n    pan: useMotionValue.makeRenderlessComponent(usePanGesture),\n    drag: useMotionValue.makeRenderlessComponent(useDrag),\n};\n\nfunction isCSSVariable(value) {\n    return typeof value === \"string\" && value.startsWith(\"var(--\");\n}\n/**\n * Parse Framer's special CSS variable format into a CSS token and a fallback.\n *\n * ```\n * `var(--foo, #fff)` => [`--foo`, '#fff']\n * ```\n *\n * @param current\n */\nvar cssVariableRegex = /var\\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\\)/;\nfunction parseCSSVariable(current) {\n    var match = cssVariableRegex.exec(current);\n    if (!match)\n        return [,];\n    var _a = tslib.__read(match, 3), token = _a[1], fallback = _a[2];\n    return [token, fallback];\n}\nvar maxDepth = 4;\nfunction getVariableValue(current, element, depth) {\n    if (depth === void 0) { depth = 1; }\n    heyListen.invariant(depth <= maxDepth, \"Max CSS variable fallback depth detected in property \\\"\".concat(current, \"\\\". This may indicate a circular fallback dependency.\"));\n    var _a = tslib.__read(parseCSSVariable(current), 2), token = _a[0], fallback = _a[1];\n    // No CSS variable detected\n    if (!token)\n        return;\n    // Attempt to read this CSS variable off the element\n    var resolved = window.getComputedStyle(element).getPropertyValue(token);\n    if (resolved) {\n        return resolved.trim();\n    }\n    else if (isCSSVariable(fallback)) {\n        // The fallback might itself be a CSS variable, in which case we attempt to resolve it too.\n        return getVariableValue(fallback, element, depth + 1);\n    }\n    else {\n        return fallback;\n    }\n}\n/**\n * Resolve CSS variables from\n *\n * @internal\n */\nfunction resolveCSSVariables(visualElement, _a, transitionEnd) {\n    var _b;\n    var target = tslib.__rest(_a, []);\n    var element = visualElement.getInstance();\n    if (!(element instanceof Element))\n        return { target: target, transitionEnd: transitionEnd };\n    // If `transitionEnd` isn't `undefined`, clone it. We could clone `target` and `transitionEnd`\n    // only if they change but I think this reads clearer and this isn't a performance-critical path.\n    if (transitionEnd) {\n        transitionEnd = tslib.__assign({}, transitionEnd);\n    }\n    // Go through existing `MotionValue`s and ensure any existing CSS variables are resolved\n    visualElement.forEachValue(function (value) {\n        var current = value.get();\n        if (!isCSSVariable(current))\n            return;\n        var resolved = getVariableValue(current, element);\n        if (resolved)\n            value.set(resolved);\n    });\n    // Cycle through every target property and resolve CSS variables. Currently\n    // we only read single-var properties like `var(--foo)`, not `calc(var(--foo) + 20px)`\n    for (var key in target) {\n        var current = target[key];\n        if (!isCSSVariable(current))\n            continue;\n        var resolved = getVariableValue(current, element);\n        if (!resolved)\n            continue;\n        // Clone target if it hasn't already been\n        target[key] = resolved;\n        // If the user hasn't already set this key on `transitionEnd`, set it to the unresolved\n        // CSS variable. This will ensure that after the animation the component will reflect\n        // changes in the value of the CSS variable.\n        if (transitionEnd)\n            (_b = transitionEnd[key]) !== null && _b !== void 0 ? _b : (transitionEnd[key] = current);\n    }\n    return { target: target, transitionEnd: transitionEnd };\n}\n\nvar positionalKeys = new Set([\n    \"width\",\n    \"height\",\n    \"top\",\n    \"left\",\n    \"right\",\n    \"bottom\",\n    \"x\",\n    \"y\",\n]);\nvar isPositionalKey = function (key) { return positionalKeys.has(key); };\nvar hasPositionalKey = function (target) {\n    return Object.keys(target).some(isPositionalKey);\n};\nvar setAndResetVelocity = function (value, to) {\n    // Looks odd but setting it twice doesn't render, it'll just\n    // set both prev and current to the latest value\n    value.set(to, false);\n    value.set(to);\n};\nvar isNumOrPxType = function (v) {\n    return v === styleValueTypes.number || v === styleValueTypes.px;\n};\nvar BoundingBoxDimension;\n(function (BoundingBoxDimension) {\n    BoundingBoxDimension[\"width\"] = \"width\";\n    BoundingBoxDimension[\"height\"] = \"height\";\n    BoundingBoxDimension[\"left\"] = \"left\";\n    BoundingBoxDimension[\"right\"] = \"right\";\n    BoundingBoxDimension[\"top\"] = \"top\";\n    BoundingBoxDimension[\"bottom\"] = \"bottom\";\n})(BoundingBoxDimension || (BoundingBoxDimension = {}));\nvar getPosFromMatrix = function (matrix, pos) {\n    return parseFloat(matrix.split(\", \")[pos]);\n};\nvar getTranslateFromMatrix = function (pos2, pos3) {\n    return function (_bbox, _a) {\n        var transform = _a.transform;\n        if (transform === \"none\" || !transform)\n            return 0;\n        var matrix3d = transform.match(/^matrix3d\\((.+)\\)$/);\n        if (matrix3d) {\n            return getPosFromMatrix(matrix3d[1], pos3);\n        }\n        else {\n            var matrix = transform.match(/^matrix\\((.+)\\)$/);\n            if (matrix) {\n                return getPosFromMatrix(matrix[1], pos2);\n            }\n            else {\n                return 0;\n            }\n        }\n    };\n};\nvar transformKeys = new Set([\"x\", \"y\", \"z\"]);\nvar nonTranslationalTransformKeys = useMotionValue.transformProps.filter(function (key) { return !transformKeys.has(key); });\nfunction removeNonTranslationalTransform(visualElement) {\n    var removedTransforms = [];\n    nonTranslationalTransformKeys.forEach(function (key) {\n        var value = visualElement.getValue(key);\n        if (value !== undefined) {\n            removedTransforms.push([key, value.get()]);\n            value.set(key.startsWith(\"scale\") ? 1 : 0);\n        }\n    });\n    // Apply changes to element before measurement\n    if (removedTransforms.length)\n        visualElement.syncRender();\n    return removedTransforms;\n}\nvar positionalValues = {\n    // Dimensions\n    width: function (_a, _b) {\n        var x = _a.x;\n        var _c = _b.paddingLeft, paddingLeft = _c === void 0 ? \"0\" : _c, _d = _b.paddingRight, paddingRight = _d === void 0 ? \"0\" : _d;\n        return x.max - x.min - parseFloat(paddingLeft) - parseFloat(paddingRight);\n    },\n    height: function (_a, _b) {\n        var y = _a.y;\n        var _c = _b.paddingTop, paddingTop = _c === void 0 ? \"0\" : _c, _d = _b.paddingBottom, paddingBottom = _d === void 0 ? \"0\" : _d;\n        return y.max - y.min - parseFloat(paddingTop) - parseFloat(paddingBottom);\n    },\n    top: function (_bbox, _a) {\n        var top = _a.top;\n        return parseFloat(top);\n    },\n    left: function (_bbox, _a) {\n        var left = _a.left;\n        return parseFloat(left);\n    },\n    bottom: function (_a, _b) {\n        var y = _a.y;\n        var top = _b.top;\n        return parseFloat(top) + (y.max - y.min);\n    },\n    right: function (_a, _b) {\n        var x = _a.x;\n        var left = _b.left;\n        return parseFloat(left) + (x.max - x.min);\n    },\n    // Transform\n    x: getTranslateFromMatrix(4, 13),\n    y: getTranslateFromMatrix(5, 14),\n};\nvar convertChangedValueTypes = function (target, visualElement, changedKeys) {\n    var originBbox = visualElement.measureViewportBox();\n    var element = visualElement.getInstance();\n    var elementComputedStyle = getComputedStyle(element);\n    var display = elementComputedStyle.display;\n    var origin = {};\n    // If the element is currently set to display: \"none\", make it visible before\n    // measuring the target bounding box\n    if (display === \"none\") {\n        visualElement.setStaticValue(\"display\", target.display || \"block\");\n    }\n    /**\n     * Record origins before we render and update styles\n     */\n    changedKeys.forEach(function (key) {\n        origin[key] = positionalValues[key](originBbox, elementComputedStyle);\n    });\n    // Apply the latest values (as set in checkAndConvertChangedValueTypes)\n    visualElement.syncRender();\n    var targetBbox = visualElement.measureViewportBox();\n    changedKeys.forEach(function (key) {\n        // Restore styles to their **calculated computed style**, not their actual\n        // originally set style. This allows us to animate between equivalent pixel units.\n        var value = visualElement.getValue(key);\n        setAndResetVelocity(value, origin[key]);\n        target[key] = positionalValues[key](targetBbox, elementComputedStyle);\n    });\n    return target;\n};\nvar checkAndConvertChangedValueTypes = function (visualElement, target, origin, transitionEnd) {\n    if (origin === void 0) { origin = {}; }\n    if (transitionEnd === void 0) { transitionEnd = {}; }\n    target = tslib.__assign({}, target);\n    transitionEnd = tslib.__assign({}, transitionEnd);\n    var targetPositionalKeys = Object.keys(target).filter(isPositionalKey);\n    // We want to remove any transform values that could affect the element's bounding box before\n    // it's measured. We'll reapply these later.\n    var removedTransformValues = [];\n    var hasAttemptedToRemoveTransformValues = false;\n    var changedValueTypeKeys = [];\n    targetPositionalKeys.forEach(function (key) {\n        var value = visualElement.getValue(key);\n        if (!visualElement.hasValue(key))\n            return;\n        var from = origin[key];\n        var fromType = useMotionValue.findDimensionValueType(from);\n        var to = target[key];\n        var toType;\n        // TODO: The current implementation of this basically throws an error\n        // if you try and do value conversion via keyframes. There's probably\n        // a way of doing this but the performance implications would need greater scrutiny,\n        // as it'd be doing multiple resize-remeasure operations.\n        if (useMotionValue.isKeyframesTarget(to)) {\n            var numKeyframes = to.length;\n            var fromIndex = to[0] === null ? 1 : 0;\n            from = to[fromIndex];\n            fromType = useMotionValue.findDimensionValueType(from);\n            for (var i = fromIndex; i < numKeyframes; i++) {\n                if (!toType) {\n                    toType = useMotionValue.findDimensionValueType(to[i]);\n                    heyListen.invariant(toType === fromType ||\n                        (isNumOrPxType(fromType) && isNumOrPxType(toType)), \"Keyframes must be of the same dimension as the current value\");\n                }\n                else {\n                    heyListen.invariant(useMotionValue.findDimensionValueType(to[i]) === toType, \"All keyframes must be of the same type\");\n                }\n            }\n        }\n        else {\n            toType = useMotionValue.findDimensionValueType(to);\n        }\n        if (fromType !== toType) {\n            // If they're both just number or px, convert them both to numbers rather than\n            // relying on resize/remeasure to convert (which is wasteful in this situation)\n            if (isNumOrPxType(fromType) && isNumOrPxType(toType)) {\n                var current = value.get();\n                if (typeof current === \"string\") {\n                    value.set(parseFloat(current));\n                }\n                if (typeof to === \"string\") {\n                    target[key] = parseFloat(to);\n                }\n                else if (Array.isArray(to) && toType === styleValueTypes.px) {\n                    target[key] = to.map(parseFloat);\n                }\n            }\n            else if ((fromType === null || fromType === void 0 ? void 0 : fromType.transform) &&\n                (toType === null || toType === void 0 ? void 0 : toType.transform) &&\n                (from === 0 || to === 0)) {\n                // If one or the other value is 0, it's safe to coerce it to the\n                // type of the other without measurement\n                if (from === 0) {\n                    value.set(toType.transform(from));\n                }\n                else {\n                    target[key] = fromType.transform(to);\n                }\n            }\n            else {\n                // If we're going to do value conversion via DOM measurements, we first\n                // need to remove non-positional transform values that could affect the bbox measurements.\n                if (!hasAttemptedToRemoveTransformValues) {\n                    removedTransformValues =\n                        removeNonTranslationalTransform(visualElement);\n                    hasAttemptedToRemoveTransformValues = true;\n                }\n                changedValueTypeKeys.push(key);\n                transitionEnd[key] =\n                    transitionEnd[key] !== undefined\n                        ? transitionEnd[key]\n                        : target[key];\n                setAndResetVelocity(value, to);\n            }\n        }\n    });\n    if (changedValueTypeKeys.length) {\n        var convertedTarget = convertChangedValueTypes(target, visualElement, changedValueTypeKeys);\n        // If we removed transform values, reapply them before the next render\n        if (removedTransformValues.length) {\n            removedTransformValues.forEach(function (_a) {\n                var _b = tslib.__read(_a, 2), key = _b[0], value = _b[1];\n                visualElement.getValue(key).set(value);\n            });\n        }\n        // Reapply original values\n        visualElement.syncRender();\n        return { target: convertedTarget, transitionEnd: transitionEnd };\n    }\n    else {\n        return { target: target, transitionEnd: transitionEnd };\n    }\n};\n/**\n * Convert value types for x/y/width/height/top/left/bottom/right\n *\n * Allows animation between `'auto'` -> `'100%'` or `0` -> `'calc(50% - 10vw)'`\n *\n * @internal\n */\nfunction unitConversion(visualElement, target, origin, transitionEnd) {\n    return hasPositionalKey(target)\n        ? checkAndConvertChangedValueTypes(visualElement, target, origin, transitionEnd)\n        : { target: target, transitionEnd: transitionEnd };\n}\n\n/**\n * Parse a DOM variant to make it animatable. This involves resolving CSS variables\n * and ensuring animations like \"20%\" => \"calc(50vw)\" are performed in pixels.\n */\nvar parseDomVariant = function (visualElement, target, origin, transitionEnd) {\n    var resolved = resolveCSSVariables(visualElement, target, transitionEnd);\n    target = resolved.target;\n    transitionEnd = resolved.transitionEnd;\n    return unitConversion(visualElement, target, origin, transitionEnd);\n};\n\nfunction getComputedStyle$1(element) {\n    return window.getComputedStyle(element);\n}\nvar htmlConfig = {\n    treeType: \"dom\",\n    readValueFromInstance: function (domElement, key) {\n        if (useMotionValue.isTransformProp(key)) {\n            var defaultType = useMotionValue.getDefaultValueType(key);\n            return defaultType ? defaultType.default || 0 : 0;\n        }\n        else {\n            var computedStyle = getComputedStyle$1(domElement);\n            return ((isCSSVariable$1(key)\n                ? computedStyle.getPropertyValue(key)\n                : computedStyle[key]) || 0);\n        }\n    },\n    sortNodePosition: function (a, b) {\n        /**\n         * compareDocumentPosition returns a bitmask, by using the bitwise &\n         * we're returning true if 2 in that bitmask is set to true. 2 is set\n         * to true if b preceeds a.\n         */\n        return a.compareDocumentPosition(b) & 2 ? 1 : -1;\n    },\n    getBaseTarget: function (props, key) {\n        var _a;\n        return (_a = props.style) === null || _a === void 0 ? void 0 : _a[key];\n    },\n    measureViewportBox: function (element, _a) {\n        var transformPagePoint = _a.transformPagePoint;\n        return measureViewportBox(element, transformPagePoint);\n    },\n    /**\n     * Reset the transform on the current Element. This is called as part\n     * of a batched process across the entire layout tree. To remove this write\n     * cycle it'd be interesting to see if it's possible to \"undo\" all the current\n     * layout transforms up the tree in the same way this.getBoundingBoxWithoutTransforms\n     * works\n     */\n    resetTransform: function (element, domElement, props) {\n        var transformTemplate = props.transformTemplate;\n        domElement.style.transform = transformTemplate\n            ? transformTemplate({}, \"\")\n            : \"none\";\n        // Ensure that whatever happens next, we restore our transform on the next frame\n        element.scheduleRender();\n    },\n    restoreTransform: function (instance, mutableState) {\n        instance.style.transform = mutableState.style.transform;\n    },\n    removeValueFromRenderState: function (key, _a) {\n        var vars = _a.vars, style = _a.style;\n        delete vars[key];\n        delete style[key];\n    },\n    /**\n     * Ensure that HTML and Framer-specific value types like `px`->`%` and `Color`\n     * can be animated by Motion.\n     */\n    makeTargetAnimatable: function (element, _a, _b, isMounted) {\n        var transformValues = _b.transformValues;\n        if (isMounted === void 0) { isMounted = true; }\n        var transition = _a.transition, transitionEnd = _a.transitionEnd, target = tslib.__rest(_a, [\"transition\", \"transitionEnd\"]);\n        var origin = useMotionValue.getOrigin(target, transition || {}, element);\n        /**\n         * If Framer has provided a function to convert `Color` etc value types, convert them\n         */\n        if (transformValues) {\n            if (transitionEnd)\n                transitionEnd = transformValues(transitionEnd);\n            if (target)\n                target = transformValues(target);\n            if (origin)\n                origin = transformValues(origin);\n        }\n        if (isMounted) {\n            useMotionValue.checkTargetForNewValues(element, target, origin);\n            var parsed = parseDomVariant(element, target, origin, transitionEnd);\n            transitionEnd = parsed.transitionEnd;\n            target = parsed.target;\n        }\n        return tslib.__assign({ transition: transition, transitionEnd: transitionEnd }, target);\n    },\n    scrapeMotionValuesFromProps: scrapeMotionValuesFromProps$1,\n    build: function (element, renderState, latestValues, options, props) {\n        if (element.isVisible !== undefined) {\n            renderState.style.visibility = element.isVisible\n                ? \"visible\"\n                : \"hidden\";\n        }\n        buildHTMLStyles(renderState, latestValues, options, props.transformTemplate);\n    },\n    render: renderHTML,\n};\nvar htmlVisualElement = useMotionValue.visualElement(htmlConfig);\n\nvar svgVisualElement = useMotionValue.visualElement(tslib.__assign(tslib.__assign({}, htmlConfig), { getBaseTarget: function (props, key) {\n        return props[key];\n    }, readValueFromInstance: function (domElement, key) {\n        var _a;\n        if (useMotionValue.isTransformProp(key)) {\n            return ((_a = useMotionValue.getDefaultValueType(key)) === null || _a === void 0 ? void 0 : _a.default) || 0;\n        }\n        key = !camelCaseAttributes.has(key) ? camelToDash(key) : key;\n        return domElement.getAttribute(key);\n    }, scrapeMotionValuesFromProps: scrapeMotionValuesFromProps, build: function (_element, renderState, latestValues, options, props) {\n        buildSVGAttrs(renderState, latestValues, options, props.transformTemplate);\n    }, render: renderSVG }));\n\nvar createDomVisualElement = function (Component, options) {\n    return isSVGComponent(Component)\n        ? svgVisualElement(options, { enableHardwareAcceleration: false })\n        : htmlVisualElement(options, { enableHardwareAcceleration: true });\n};\n\nfunction pixelsToPercent(pixels, axis) {\n    if (axis.max === axis.min)\n        return 0;\n    return (pixels / (axis.max - axis.min)) * 100;\n}\n/**\n * We always correct borderRadius as a percentage rather than pixels to reduce paints.\n * For example, if you are projecting a box that is 100px wide with a 10px borderRadius\n * into a box that is 200px wide with a 20px borderRadius, that is actually a 10%\n * borderRadius in both states. If we animate between the two in pixels that will trigger\n * a paint each time. If we animate between the two in percentage we'll avoid a paint.\n */\nvar correctBorderRadius = {\n    correct: function (latest, node) {\n        if (!node.target)\n            return latest;\n        /**\n         * If latest is a string, if it's a percentage we can return immediately as it's\n         * going to be stretched appropriately. Otherwise, if it's a pixel, convert it to a number.\n         */\n        if (typeof latest === \"string\") {\n            if (styleValueTypes.px.test(latest)) {\n                latest = parseFloat(latest);\n            }\n            else {\n                return latest;\n            }\n        }\n        /**\n         * If latest is a number, it's a pixel value. We use the current viewportBox to calculate that\n         * pixel value as a percentage of each axis\n         */\n        var x = pixelsToPercent(latest, node.target.x);\n        var y = pixelsToPercent(latest, node.target.y);\n        return \"\".concat(x, \"% \").concat(y, \"%\");\n    },\n};\n\nvar varToken = \"_$css\";\nvar correctBoxShadow = {\n    correct: function (latest, _a) {\n        var treeScale = _a.treeScale, projectionDelta = _a.projectionDelta;\n        var original = latest;\n        /**\n         * We need to first strip and store CSS variables from the string.\n         */\n        var containsCSSVariables = latest.includes(\"var(\");\n        var cssVariables = [];\n        if (containsCSSVariables) {\n            latest = latest.replace(cssVariableRegex, function (match) {\n                cssVariables.push(match);\n                return varToken;\n            });\n        }\n        var shadow = styleValueTypes.complex.parse(latest);\n        // TODO: Doesn't support multiple shadows\n        if (shadow.length > 5)\n            return original;\n        var template = styleValueTypes.complex.createTransformer(latest);\n        var offset = typeof shadow[0] !== \"number\" ? 1 : 0;\n        // Calculate the overall context scale\n        var xScale = projectionDelta.x.scale * treeScale.x;\n        var yScale = projectionDelta.y.scale * treeScale.y;\n        shadow[0 + offset] /= xScale;\n        shadow[1 + offset] /= yScale;\n        /**\n         * Ideally we'd correct x and y scales individually, but because blur and\n         * spread apply to both we have to take a scale average and apply that instead.\n         * We could potentially improve the outcome of this by incorporating the ratio between\n         * the two scales.\n         */\n        var averageScale = popmotion.mix(xScale, yScale, 0.5);\n        // Blur\n        if (typeof shadow[2 + offset] === \"number\")\n            shadow[2 + offset] /= averageScale;\n        // Spread\n        if (typeof shadow[3 + offset] === \"number\")\n            shadow[3 + offset] /= averageScale;\n        var output = template(shadow);\n        if (containsCSSVariables) {\n            var i_1 = 0;\n            output = output.replace(varToken, function () {\n                var cssVariable = cssVariables[i_1];\n                i_1++;\n                return cssVariable;\n            });\n        }\n        return output;\n    },\n};\n\nvar MeasureLayoutWithContext = /** @class */ (function (_super) {\n    tslib.__extends(MeasureLayoutWithContext, _super);\n    function MeasureLayoutWithContext() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * This only mounts projection nodes for components that\n     * need measuring, we might want to do it for all components\n     * in order to incorporate transforms\n     */\n    MeasureLayoutWithContext.prototype.componentDidMount = function () {\n        var _this = this;\n        var _a = this.props, visualElement = _a.visualElement, layoutGroup = _a.layoutGroup, switchLayoutGroup = _a.switchLayoutGroup, layoutId = _a.layoutId;\n        var projection = visualElement.projection;\n        useMotionValue.addScaleCorrector(defaultScaleCorrectors);\n        if (projection) {\n            if (layoutGroup === null || layoutGroup === void 0 ? void 0 : layoutGroup.group)\n                layoutGroup.group.add(projection);\n            if ((switchLayoutGroup === null || switchLayoutGroup === void 0 ? void 0 : switchLayoutGroup.register) && layoutId) {\n                switchLayoutGroup.register(projection);\n            }\n            projection.root.didUpdate();\n            projection.addEventListener(\"animationComplete\", function () {\n                _this.safeToRemove();\n            });\n            projection.setOptions(tslib.__assign(tslib.__assign({}, projection.options), { onExitComplete: function () { return _this.safeToRemove(); } }));\n        }\n        useMotionValue.globalProjectionState.hasEverUpdated = true;\n    };\n    MeasureLayoutWithContext.prototype.getSnapshotBeforeUpdate = function (prevProps) {\n        var _this = this;\n        var _a = this.props, layoutDependency = _a.layoutDependency, visualElement = _a.visualElement, drag = _a.drag, isPresent = _a.isPresent;\n        var projection = visualElement.projection;\n        if (!projection)\n            return null;\n        /**\n         * TODO: We use this data in relegate to determine whether to\n         * promote a previous element. There's no guarantee its presence data\n         * will have updated by this point - if a bug like this arises it will\n         * have to be that we markForRelegation and then find a new lead some other way,\n         * perhaps in didUpdate\n         */\n        projection.isPresent = isPresent;\n        if (drag ||\n            prevProps.layoutDependency !== layoutDependency ||\n            layoutDependency === undefined) {\n            projection.willUpdate();\n        }\n        else {\n            this.safeToRemove();\n        }\n        if (prevProps.isPresent !== isPresent) {\n            if (isPresent) {\n                projection.promote();\n            }\n            else if (!projection.relegate()) {\n                /**\n                 * If there's another stack member taking over from this one,\n                 * it's in charge of the exit animation and therefore should\n                 * be in charge of the safe to remove. Otherwise we call it here.\n                 */\n                sync__default[\"default\"].postRender(function () {\n                    var _a;\n                    if (!((_a = projection.getStack()) === null || _a === void 0 ? void 0 : _a.members.length)) {\n                        _this.safeToRemove();\n                    }\n                });\n            }\n        }\n        return null;\n    };\n    MeasureLayoutWithContext.prototype.componentDidUpdate = function () {\n        var projection = this.props.visualElement.projection;\n        if (projection) {\n            projection.root.didUpdate();\n            if (!projection.currentAnimation && projection.isLead()) {\n                this.safeToRemove();\n            }\n        }\n    };\n    MeasureLayoutWithContext.prototype.componentWillUnmount = function () {\n        var _a = this.props, visualElement = _a.visualElement, layoutGroup = _a.layoutGroup, promoteContext = _a.switchLayoutGroup;\n        var projection = visualElement.projection;\n        if (projection) {\n            projection.scheduleCheckAfterUnmount();\n            if (layoutGroup === null || layoutGroup === void 0 ? void 0 : layoutGroup.group)\n                layoutGroup.group.remove(projection);\n            if (promoteContext === null || promoteContext === void 0 ? void 0 : promoteContext.deregister)\n                promoteContext.deregister(projection);\n        }\n    };\n    MeasureLayoutWithContext.prototype.safeToRemove = function () {\n        var safeToRemove = this.props.safeToRemove;\n        safeToRemove === null || safeToRemove === void 0 ? void 0 : safeToRemove();\n    };\n    MeasureLayoutWithContext.prototype.render = function () {\n        return null;\n    };\n    return MeasureLayoutWithContext;\n}(React__default[\"default\"].Component));\nfunction MeasureLayout(props) {\n    var _a = tslib.__read(useMotionValue.usePresence(), 2), isPresent = _a[0], safeToRemove = _a[1];\n    var layoutGroup = React.useContext(useMotionValue.LayoutGroupContext);\n    return (React__default[\"default\"].createElement(MeasureLayoutWithContext, tslib.__assign({}, props, { layoutGroup: layoutGroup, switchLayoutGroup: React.useContext(useMotionValue.SwitchLayoutGroupContext), isPresent: isPresent, safeToRemove: safeToRemove })));\n}\nvar defaultScaleCorrectors = {\n    borderRadius: tslib.__assign(tslib.__assign({}, correctBorderRadius), { applyTo: [\n            \"borderTopLeftRadius\",\n            \"borderTopRightRadius\",\n            \"borderBottomLeftRadius\",\n            \"borderBottomRightRadius\",\n        ] }),\n    borderTopLeftRadius: correctBorderRadius,\n    borderTopRightRadius: correctBorderRadius,\n    borderBottomLeftRadius: correctBorderRadius,\n    borderBottomRightRadius: correctBorderRadius,\n    boxShadow: correctBoxShadow,\n};\n\nvar layoutFeatures = {\n    measureLayout: MeasureLayout,\n};\n\nvar DocumentProjectionNode = useMotionValue.createProjectionNode({\n    attachResizeListener: function (ref, notify) {\n        ref.addEventListener(\"resize\", notify, { passive: true });\n        return function () { return ref.removeEventListener(\"resize\", notify); };\n    },\n    measureScroll: function () { return ({\n        x: document.documentElement.scrollLeft || document.body.scrollLeft,\n        y: document.documentElement.scrollTop || document.body.scrollTop,\n    }); },\n});\n\nvar rootProjectionNode = {\n    current: undefined,\n};\nvar HTMLProjectionNode = useMotionValue.createProjectionNode({\n    measureScroll: function (instance) { return ({\n        x: instance.scrollLeft,\n        y: instance.scrollTop,\n    }); },\n    defaultParent: function () {\n        if (!rootProjectionNode.current) {\n            var documentNode = new DocumentProjectionNode(0, {});\n            documentNode.mount(window);\n            documentNode.setOptions({ layoutScroll: true });\n            rootProjectionNode.current = documentNode;\n        }\n        return rootProjectionNode.current;\n    },\n    resetTransform: function (instance, value) {\n        instance.style.transform = value !== null && value !== void 0 ? value : \"none\";\n    },\n});\n\nvar featureBundle = tslib.__assign(tslib.__assign(tslib.__assign(tslib.__assign({}, useMotionValue.animations), gestureAnimations), drag), layoutFeatures);\n/**\n * HTML & SVG components, optimised for use with gestures and animation. These can be used as\n * drop-in replacements for any HTML & SVG component, all CSS & SVG properties are supported.\n *\n * @public\n */\nvar motion = /*@__PURE__*/ createMotionProxy(function (Component, config) {\n    return createDomMotionConfig(Component, config, featureBundle, createDomVisualElement, HTMLProjectionNode);\n});\n/**\n * Create a DOM `motion` component with the provided string. This is primarily intended\n * as a full alternative to `motion` for consumers who have to support environments that don't\n * support `Proxy`.\n *\n * ```javascript\n * import { createDomMotionComponent } from \"framer-motion\"\n *\n * const motion = {\n *   div: createDomMotionComponent('div')\n * }\n * ```\n *\n * @public\n */\nfunction createDomMotionComponent(key) {\n    return useMotionValue.createMotionComponent(createDomMotionConfig(key, { forwardMotionProps: false }, featureBundle, createDomVisualElement, HTMLProjectionNode));\n}\n\n/**\n * @public\n */\nvar m = createMotionProxy(createDomMotionConfig);\n\nvar presenceId = 0;\nfunction getPresenceId() {\n    var id = presenceId;\n    presenceId++;\n    return id;\n}\nvar PresenceChild = function (_a) {\n    var children = _a.children, initial = _a.initial, isPresent = _a.isPresent, onExitComplete = _a.onExitComplete, custom = _a.custom, presenceAffectsLayout = _a.presenceAffectsLayout;\n    var presenceChildren = useMotionValue.useConstant(newChildrenMap);\n    var id = useMotionValue.useConstant(getPresenceId);\n    var context = React.useMemo(function () { return ({\n        id: id,\n        initial: initial,\n        isPresent: isPresent,\n        custom: custom,\n        onExitComplete: function (childId) {\n            var e_1, _a;\n            presenceChildren.set(childId, true);\n            try {\n                for (var _b = tslib.__values(presenceChildren.values()), _c = _b.next(); !_c.done; _c = _b.next()) {\n                    var isComplete = _c.value;\n                    if (!isComplete)\n                        return; // can stop searching when any is incomplete\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            onExitComplete === null || onExitComplete === void 0 ? void 0 : onExitComplete();\n        },\n        register: function (childId) {\n            presenceChildren.set(childId, false);\n            return function () { return presenceChildren.delete(childId); };\n        },\n    }); }, \n    /**\n     * If the presence of a child affects the layout of the components around it,\n     * we want to make a new context value to ensure they get re-rendered\n     * so they can detect that layout change.\n     */\n    presenceAffectsLayout ? undefined : [isPresent]);\n    React.useMemo(function () {\n        presenceChildren.forEach(function (_, key) { return presenceChildren.set(key, false); });\n    }, [isPresent]);\n    /**\n     * If there's no `motion` components to fire exit animations, we want to remove this\n     * component immediately.\n     */\n    React__namespace.useEffect(function () {\n        !isPresent && !presenceChildren.size && (onExitComplete === null || onExitComplete === void 0 ? void 0 : onExitComplete());\n    }, [isPresent]);\n    return (React__namespace.createElement(useMotionValue.PresenceContext.Provider, { value: context }, children));\n};\nfunction newChildrenMap() {\n    return new Map();\n}\n\nfunction getChildKey(child) {\n    return child.key || \"\";\n}\nfunction updateChildLookup(children, allChildren) {\n    var seenChildren = process.env.NODE_ENV !== \"production\" ? new Set() : null;\n    children.forEach(function (child) {\n        var key = getChildKey(child);\n        if (process.env.NODE_ENV !== \"production\" && seenChildren) {\n            if (seenChildren.has(key)) {\n                console.warn(\"Children of AnimatePresence require unique keys. \\\"\".concat(key, \"\\\" is a duplicate.\"));\n            }\n            seenChildren.add(key);\n        }\n        allChildren.set(key, child);\n    });\n}\nfunction onlyElements(children) {\n    var filtered = [];\n    // We use forEach here instead of map as map mutates the component key by preprending `.$`\n    React.Children.forEach(children, function (child) {\n        if (React.isValidElement(child))\n            filtered.push(child);\n    });\n    return filtered;\n}\n/**\n * `AnimatePresence` enables the animation of components that have been removed from the tree.\n *\n * When adding/removing more than a single child, every child **must** be given a unique `key` prop.\n *\n * Any `motion` components that have an `exit` property defined will animate out when removed from\n * the tree.\n *\n * ```jsx\n * import { motion, AnimatePresence } from 'framer-motion'\n *\n * export const Items = ({ items }) => (\n *   <AnimatePresence>\n *     {items.map(item => (\n *       <motion.div\n *         key={item.id}\n *         initial={{ opacity: 0 }}\n *         animate={{ opacity: 1 }}\n *         exit={{ opacity: 0 }}\n *       />\n *     ))}\n *   </AnimatePresence>\n * )\n * ```\n *\n * You can sequence exit animations throughout a tree using variants.\n *\n * If a child contains multiple `motion` components with `exit` props, it will only unmount the child\n * once all `motion` components have finished animating out. Likewise, any components using\n * `usePresence` all need to call `safeToRemove`.\n *\n * @public\n */\nvar AnimatePresence = function (_a) {\n    var children = _a.children, custom = _a.custom, _b = _a.initial, initial = _b === void 0 ? true : _b, onExitComplete = _a.onExitComplete, exitBeforeEnter = _a.exitBeforeEnter, _c = _a.presenceAffectsLayout, presenceAffectsLayout = _c === void 0 ? true : _c;\n    // We want to force a re-render once all exiting animations have finished. We\n    // either use a local forceRender function, or one from a parent context if it exists.\n    var _d = tslib.__read(useMotionValue.useForceUpdate(), 1), forceRender = _d[0];\n    var forceRenderLayoutGroup = React.useContext(useMotionValue.LayoutGroupContext).forceRender;\n    if (forceRenderLayoutGroup)\n        forceRender = forceRenderLayoutGroup;\n    var isInitialRender = React.useRef(true);\n    var isMounted = React.useRef(true);\n    React.useEffect(function () { return function () {\n        isMounted.current = false;\n    }; }, []);\n    // Filter out any children that aren't ReactElements. We can only track ReactElements with a props.key\n    var filteredChildren = onlyElements(children);\n    // Keep a living record of the children we're actually rendering so we\n    // can diff to figure out which are entering and exiting\n    var presentChildren = React.useRef(filteredChildren);\n    // A lookup table to quickly reference components by key\n    var allChildren = React.useRef(new Map()).current;\n    // A living record of all currently exiting components.\n    var exiting = React.useRef(new Set()).current;\n    updateChildLookup(filteredChildren, allChildren);\n    // If this is the initial component render, just deal with logic surrounding whether\n    // we play onMount animations or not.\n    if (isInitialRender.current) {\n        isInitialRender.current = false;\n        return (React__namespace.createElement(React__namespace.Fragment, null, filteredChildren.map(function (child) { return (React__namespace.createElement(PresenceChild, { key: getChildKey(child), isPresent: true, initial: initial ? undefined : false, presenceAffectsLayout: presenceAffectsLayout }, child)); })));\n    }\n    // If this is a subsequent render, deal with entering and exiting children\n    var childrenToRender = tslib.__spreadArray([], tslib.__read(filteredChildren), false);\n    // Diff the keys of the currently-present and target children to update our\n    // exiting list.\n    var presentKeys = presentChildren.current.map(getChildKey);\n    var targetKeys = filteredChildren.map(getChildKey);\n    // Diff the present children with our target children and mark those that are exiting\n    var numPresent = presentKeys.length;\n    for (var i = 0; i < numPresent; i++) {\n        var key = presentKeys[i];\n        if (targetKeys.indexOf(key) === -1) {\n            exiting.add(key);\n        }\n        else {\n            // In case this key has re-entered, remove from the exiting list\n            exiting.delete(key);\n        }\n    }\n    // If we currently have exiting children, and we're deferring rendering incoming children\n    // until after all current children have exiting, empty the childrenToRender array\n    if (exitBeforeEnter && exiting.size) {\n        childrenToRender = [];\n    }\n    // Loop through all currently exiting components and clone them to overwrite `animate`\n    // with any `exit` prop they might have defined.\n    exiting.forEach(function (key) {\n        // If this component is actually entering again, early return\n        if (targetKeys.indexOf(key) !== -1)\n            return;\n        var child = allChildren.get(key);\n        if (!child)\n            return;\n        var insertionIndex = presentKeys.indexOf(key);\n        var onExit = function () {\n            allChildren.delete(key);\n            exiting.delete(key);\n            // Remove this child from the present children\n            var removeIndex = presentChildren.current.findIndex(function (presentChild) { return presentChild.key === key; });\n            presentChildren.current.splice(removeIndex, 1);\n            // Defer re-rendering until all exiting children have indeed left\n            if (!exiting.size) {\n                presentChildren.current = filteredChildren;\n                if (isMounted.current === false) {\n                    return;\n                }\n                forceRender();\n                onExitComplete && onExitComplete();\n            }\n        };\n        childrenToRender.splice(insertionIndex, 0, React__namespace.createElement(PresenceChild, { key: getChildKey(child), isPresent: false, onExitComplete: onExit, custom: custom, presenceAffectsLayout: presenceAffectsLayout }, child));\n    });\n    // Add `MotionContext` even to children that don't need it to ensure we're rendering\n    // the same tree between renders\n    childrenToRender = childrenToRender.map(function (child) {\n        var key = child.key;\n        return exiting.has(key) ? (child) : (React__namespace.createElement(PresenceChild, { key: getChildKey(child), isPresent: true, presenceAffectsLayout: presenceAffectsLayout }, child));\n    });\n    presentChildren.current = childrenToRender;\n    if (process.env.NODE_ENV !== \"production\" &&\n        exitBeforeEnter &&\n        childrenToRender.length > 1) {\n        console.warn(\"You're attempting to animate multiple children within AnimatePresence, but its exitBeforeEnter prop is set to true. This will lead to odd visual behaviour.\");\n    }\n    return (React__namespace.createElement(React__namespace.Fragment, null, exiting.size\n        ? childrenToRender\n        : childrenToRender.map(function (child) { return React.cloneElement(child); })));\n};\n\n/**\n * @internal\n * @deprecated\n */\nvar DeprecatedLayoutGroupContext = React.createContext(null);\n\nvar notify = function (node) {\n    return !node.isLayoutDirty && node.willUpdate(false);\n};\nfunction nodeGroup() {\n    var nodes = new Set();\n    var subscriptions = new WeakMap();\n    var dirtyAll = function () { return nodes.forEach(notify); };\n    return {\n        add: function (node) {\n            nodes.add(node);\n            subscriptions.set(node, node.addEventListener(\"willUpdate\", dirtyAll));\n        },\n        remove: function (node) {\n            var _a;\n            nodes.delete(node);\n            (_a = subscriptions.get(node)) === null || _a === void 0 ? void 0 : _a();\n            subscriptions.delete(node);\n            dirtyAll();\n        },\n        dirty: dirtyAll,\n    };\n}\n\nvar LayoutGroup = function (_a) {\n    var _b, _c;\n    var children = _a.children, id = _a.id, _d = _a.inheritId, inheritId = _d === void 0 ? true : _d;\n    var layoutGroupContext = React.useContext(useMotionValue.LayoutGroupContext);\n    var deprecatedLayoutGroupContext = React.useContext(DeprecatedLayoutGroupContext);\n    var _e = tslib.__read(useMotionValue.useForceUpdate(), 2), forceRender = _e[0], key = _e[1];\n    var context = React.useRef(null);\n    var upstreamId = (_b = layoutGroupContext.id) !== null && _b !== void 0 ? _b : deprecatedLayoutGroupContext;\n    if (context.current === null) {\n        if (inheritId && upstreamId) {\n            id = id ? upstreamId + \"-\" + id : upstreamId;\n        }\n        context.current = {\n            id: id,\n            group: inheritId\n                ? (_c = layoutGroupContext === null || layoutGroupContext === void 0 ? void 0 : layoutGroupContext.group) !== null && _c !== void 0 ? _c : nodeGroup()\n                : nodeGroup(),\n        };\n    }\n    var memoizedContext = React.useMemo(function () { return (tslib.__assign(tslib.__assign({}, context.current), { forceRender: forceRender })); }, [key]);\n    return (React__namespace.createElement(useMotionValue.LayoutGroupContext.Provider, { value: memoizedContext }, children));\n};\n\nvar id = 0;\nvar AnimateSharedLayout = function (_a) {\n    var children = _a.children;\n    return (React__namespace.createElement(LayoutGroup, { id: useMotionValue.useConstant(function () { return \"asl-\".concat(id++); }) }, children));\n};\n\n/**\n * `MotionConfig` is used to set configuration options for all children `motion` components.\n *\n * ```jsx\n * import { motion, MotionConfig } from \"framer-motion\"\n *\n * export function App() {\n *   return (\n *     <MotionConfig transition={{ type: \"spring\" }}>\n *       <motion.div animate={{ x: 100 }} />\n *     </MotionConfig>\n *   )\n * }\n * ```\n *\n * @public\n */\nfunction MotionConfig(_a) {\n    var children = _a.children, isValidProp = _a.isValidProp, config = tslib.__rest(_a, [\"children\", \"isValidProp\"]);\n    isValidProp && useMotionValue.loadExternalIsValidProp(isValidProp);\n    /**\n     * Inherit props from any parent MotionConfig components\n     */\n    config = tslib.__assign(tslib.__assign({}, React.useContext(useMotionValue.MotionConfigContext)), config);\n    /**\n     * Don't allow isStatic to change between renders as it affects how many hooks\n     * motion components fire.\n     */\n    config.isStatic = useMotionValue.useConstant(function () { return config.isStatic; });\n    /**\n     * Creating a new config context object will re-render every `motion` component\n     * every time it renders. So we only want to create a new one sparingly.\n     */\n    var context = React.useMemo(function () { return config; }, [JSON.stringify(config.transition), config.transformPagePoint]);\n    return (React__namespace.createElement(useMotionValue.MotionConfigContext.Provider, { value: context }, children));\n}\n\n/**\n * Used in conjunction with the `m` component to reduce bundle size.\n *\n * `m` is a version of the `motion` component that only loads functionality\n * critical for the initial render.\n *\n * `LazyMotion` can then be used to either synchronously or asynchronously\n * load animation and gesture support.\n *\n * ```jsx\n * // Synchronous loading\n * import { LazyMotion, m, domAnimations } from \"framer-motion\"\n *\n * function App() {\n *   return (\n *     <LazyMotion features={domAnimations}>\n *       <m.div animate={{ scale: 2 }} />\n *     </LazyMotion>\n *   )\n * }\n *\n * // Asynchronous loading\n * import { LazyMotion, m } from \"framer-motion\"\n *\n * function App() {\n *   return (\n *     <LazyMotion features={() => import('./path/to/domAnimations')}>\n *       <m.div animate={{ scale: 2 }} />\n *     </LazyMotion>\n *   )\n * }\n * ```\n *\n * @public\n */\nfunction LazyMotion(_a) {\n    var children = _a.children, features = _a.features, _b = _a.strict, strict = _b === void 0 ? false : _b;\n    var _c = tslib.__read(React.useState(!isLazyBundle(features)), 2), setIsLoaded = _c[1];\n    var loadedRenderer = React.useRef(undefined);\n    /**\n     * If this is a synchronous load, load features immediately\n     */\n    if (!isLazyBundle(features)) {\n        var renderer = features.renderer, loadedFeatures = tslib.__rest(features, [\"renderer\"]);\n        loadedRenderer.current = renderer;\n        useMotionValue.loadFeatures(loadedFeatures);\n    }\n    React.useEffect(function () {\n        if (isLazyBundle(features)) {\n            features().then(function (_a) {\n                var renderer = _a.renderer, loadedFeatures = tslib.__rest(_a, [\"renderer\"]);\n                useMotionValue.loadFeatures(loadedFeatures);\n                loadedRenderer.current = renderer;\n                setIsLoaded(true);\n            });\n        }\n    }, []);\n    return (React__namespace.createElement(useMotionValue.LazyContext.Provider, { value: { renderer: loadedRenderer.current, strict: strict } }, children));\n}\nfunction isLazyBundle(features) {\n    return typeof features === \"function\";\n}\n\nvar ReorderContext = React.createContext(null);\n\nfunction checkReorder(order, value, offset, velocity) {\n    if (!velocity)\n        return order;\n    var index = order.findIndex(function (item) { return item.value === value; });\n    if (index === -1)\n        return order;\n    var nextOffset = velocity > 0 ? 1 : -1;\n    var nextItem = order[index + nextOffset];\n    if (!nextItem)\n        return order;\n    var item = order[index];\n    var nextLayout = nextItem.layout;\n    var nextItemCenter = popmotion.mix(nextLayout.min, nextLayout.max, 0.5);\n    if ((nextOffset === 1 && item.layout.max + offset > nextItemCenter) ||\n        (nextOffset === -1 && item.layout.min + offset < nextItemCenter)) {\n        return useMotionValue.moveItem(order, index, index + nextOffset);\n    }\n    return order;\n}\n\nfunction ReorderGroup(_a, externalRef) {\n    var children = _a.children, _b = _a.as, as = _b === void 0 ? \"ul\" : _b, _c = _a.axis, axis = _c === void 0 ? \"y\" : _c, onReorder = _a.onReorder, values = _a.values, props = tslib.__rest(_a, [\"children\", \"as\", \"axis\", \"onReorder\", \"values\"]);\n    var Component = useMotionValue.useConstant(function () { return motion(as); });\n    var order = [];\n    var isReordering = React.useRef(false);\n    heyListen.invariant(Boolean(values), \"Reorder.Group must be provided a values prop\");\n    var context = {\n        axis: axis,\n        registerItem: function (value, layout) {\n            /**\n             * Ensure entries can't add themselves more than once\n             */\n            if (layout &&\n                order.findIndex(function (entry) { return value === entry.value; }) === -1) {\n                order.push({ value: value, layout: layout[axis] });\n                order.sort(compareMin);\n            }\n        },\n        updateOrder: function (id, offset, velocity) {\n            if (isReordering.current)\n                return;\n            var newOrder = checkReorder(order, id, offset, velocity);\n            if (order !== newOrder) {\n                isReordering.current = true;\n                onReorder(newOrder\n                    .map(getValue)\n                    .filter(function (value) { return values.indexOf(value) !== -1; }));\n            }\n        },\n    };\n    React.useEffect(function () {\n        isReordering.current = false;\n    });\n    return (React__namespace.createElement(Component, tslib.__assign({}, props, { ref: externalRef }),\n        React__namespace.createElement(ReorderContext.Provider, { value: context }, children)));\n}\nvar Group = React.forwardRef(ReorderGroup);\nfunction getValue(item) {\n    return item.value;\n}\nfunction compareMin(a, b) {\n    return a.layout.min - b.layout.min;\n}\n\nvar isCustomValueType = function (v) {\n    return typeof v === \"object\" && v.mix;\n};\nvar getMixer = function (v) { return (isCustomValueType(v) ? v.mix : undefined); };\nfunction transform() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var useImmediate = !Array.isArray(args[0]);\n    var argOffset = useImmediate ? 0 : -1;\n    var inputValue = args[0 + argOffset];\n    var inputRange = args[1 + argOffset];\n    var outputRange = args[2 + argOffset];\n    var options = args[3 + argOffset];\n    var interpolator = popmotion.interpolate(inputRange, outputRange, tslib.__assign({ mixer: getMixer(outputRange[0]) }, options));\n    return useImmediate ? interpolator(inputValue) : interpolator;\n}\n\nfunction useOnChange(value, callback) {\n    React.useEffect(function () {\n        if (useMotionValue.isMotionValue(value))\n            return value.onChange(callback);\n    }, [callback]);\n}\nfunction useMultiOnChange(values, handler) {\n    React.useEffect(function () {\n        var subscriptions = values.map(function (value) { return value.onChange(handler); });\n        return function () { return subscriptions.forEach(function (unsubscribe) { return unsubscribe(); }); };\n    });\n}\n\nfunction useCombineMotionValues(values, combineValues) {\n    /**\n     * Initialise the returned motion value. This remains the same between renders.\n     */\n    var value = useMotionValue.useMotionValue(combineValues());\n    /**\n     * Create a function that will update the template motion value with the latest values.\n     * This is pre-bound so whenever a motion value updates it can schedule its\n     * execution in Framesync. If it's already been scheduled it won't be fired twice\n     * in a single frame.\n     */\n    var updateValue = function () { return value.set(combineValues()); };\n    /**\n     * Synchronously update the motion value with the latest values during the render.\n     * This ensures that within a React render, the styles applied to the DOM are up-to-date.\n     */\n    updateValue();\n    /**\n     * Subscribe to all motion values found within the template. Whenever any of them change,\n     * schedule an update.\n     */\n    useMultiOnChange(values, function () { return sync__default[\"default\"].update(updateValue, false, true); });\n    return value;\n}\n\nfunction useTransform(input, inputRangeOrTransformer, outputRange, options) {\n    var transformer = typeof inputRangeOrTransformer === \"function\"\n        ? inputRangeOrTransformer\n        : transform(inputRangeOrTransformer, outputRange, options);\n    return Array.isArray(input)\n        ? useListTransform(input, transformer)\n        : useListTransform([input], function (_a) {\n            var _b = tslib.__read(_a, 1), latest = _b[0];\n            return transformer(latest);\n        });\n}\nfunction useListTransform(values, transformer) {\n    var latest = useMotionValue.useConstant(function () { return []; });\n    return useCombineMotionValues(values, function () {\n        latest.length = 0;\n        var numValues = values.length;\n        for (var i = 0; i < numValues; i++) {\n            latest[i] = values[i].get();\n        }\n        return transformer(latest);\n    });\n}\n\nfunction useDefaultMotionValue(value, defaultValue) {\n    if (defaultValue === void 0) { defaultValue = 0; }\n    return useMotionValue.isMotionValue(value) ? value : useMotionValue.useMotionValue(defaultValue);\n}\nfunction ReorderItem(_a, externalRef) {\n    var children = _a.children, style = _a.style, value = _a.value, _b = _a.as, as = _b === void 0 ? \"li\" : _b, onDrag = _a.onDrag, props = tslib.__rest(_a, [\"children\", \"style\", \"value\", \"as\", \"onDrag\"]);\n    var Component = useMotionValue.useConstant(function () { return motion(as); });\n    var context = React.useContext(ReorderContext);\n    var point = {\n        x: useDefaultMotionValue(style === null || style === void 0 ? void 0 : style.x),\n        y: useDefaultMotionValue(style === null || style === void 0 ? void 0 : style.y),\n    };\n    var zIndex = useTransform([point.x, point.y], function (_a) {\n        var _b = tslib.__read(_a, 2), latestX = _b[0], latestY = _b[1];\n        return latestX || latestY ? 1 : \"unset\";\n    });\n    var layout = React.useRef(null);\n    heyListen.invariant(Boolean(context), \"Reorder.Item must be a child of Reorder.Group\");\n    var _c = context, axis = _c.axis, registerItem = _c.registerItem, updateOrder = _c.updateOrder;\n    React.useEffect(function () {\n        registerItem(value, layout.current);\n    }, [context]);\n    return (React__namespace.createElement(Component, tslib.__assign({ drag: axis }, props, { dragSnapToOrigin: true, style: tslib.__assign(tslib.__assign({}, style), { x: point.x, y: point.y, zIndex: zIndex }), layout: true, onDrag: function (event, gesturePoint) {\n            var velocity = gesturePoint.velocity;\n            velocity[axis] &&\n                updateOrder(value, point[axis].get(), velocity[axis]);\n            onDrag === null || onDrag === void 0 ? void 0 : onDrag(event, gesturePoint);\n        }, onLayoutMeasure: function (measured) {\n            layout.current = measured;\n        }, ref: externalRef }), children));\n}\nvar Item = React.forwardRef(ReorderItem);\n\nvar Reorder = {\n    Group: Group,\n    Item: Item,\n};\n\n/**\n * @public\n */\nvar domAnimation = tslib.__assign(tslib.__assign({ renderer: createDomVisualElement }, useMotionValue.animations), gestureAnimations);\n\n/**\n * @public\n */\nvar domMax = tslib.__assign(tslib.__assign(tslib.__assign(tslib.__assign({}, domAnimation), drag), layoutFeatures), { projectionNodeConstructor: HTMLProjectionNode });\n\n/**\n * Combine multiple motion values into a new one using a string template literal.\n *\n * ```jsx\n * import {\n *   motion,\n *   useSpring,\n *   useMotionValue,\n *   useMotionTemplate\n * } from \"framer-motion\"\n *\n * function Component() {\n *   const shadowX = useSpring(0)\n *   const shadowY = useMotionValue(0)\n *   const shadow = useMotionTemplate`drop-shadow(${shadowX}px ${shadowY}px 20px rgba(0,0,0,0.3))`\n *\n *   return <motion.div style={{ filter: shadow }} />\n * }\n * ```\n *\n * @public\n */\nfunction useMotionTemplate(fragments) {\n    var values = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        values[_i - 1] = arguments[_i];\n    }\n    /**\n     * Create a function that will build a string from the latest motion values.\n     */\n    var numFragments = fragments.length;\n    function buildValue() {\n        var output = \"\";\n        for (var i = 0; i < numFragments; i++) {\n            output += fragments[i];\n            var value = values[i];\n            if (value)\n                output += values[i].get();\n        }\n        return output;\n    }\n    return useCombineMotionValues(values, buildValue);\n}\n\n/**\n * Creates a `MotionValue` that, when `set`, will use a spring animation to animate to its new state.\n *\n * It can either work as a stand-alone `MotionValue` by initialising it with a value, or as a subscriber\n * to another `MotionValue`.\n *\n * @remarks\n *\n * ```jsx\n * const x = useSpring(0, { stiffness: 300 })\n * const y = useSpring(x, { damping: 10 })\n * ```\n *\n * @param inputValue - `MotionValue` or number. If provided a `MotionValue`, when the input `MotionValue` changes, the created `MotionValue` will spring towards that value.\n * @param springConfig - Configuration options for the spring.\n * @returns `MotionValue`\n *\n * @public\n */\nfunction useSpring(source, config) {\n    if (config === void 0) { config = {}; }\n    var isStatic = React.useContext(useMotionValue.MotionConfigContext).isStatic;\n    var activeSpringAnimation = React.useRef(null);\n    var value = useMotionValue.useMotionValue(useMotionValue.isMotionValue(source) ? source.get() : source);\n    React.useMemo(function () {\n        return value.attach(function (v, set) {\n            /**\n             * A more hollistic approach to this might be to use isStatic to fix VisualElement animations\n             * at that level, but this will work for now\n             */\n            if (isStatic)\n                return set(v);\n            if (activeSpringAnimation.current) {\n                activeSpringAnimation.current.stop();\n            }\n            activeSpringAnimation.current = popmotion.animate(tslib.__assign(tslib.__assign({ from: value.get(), to: v, velocity: value.getVelocity() }, config), { onUpdate: set }));\n            return value.get();\n        });\n    }, Object.values(config));\n    useOnChange(source, function (v) { return value.set(parseFloat(v)); });\n    return value;\n}\n\n/**\n * Creates a `MotionValue` that updates when the velocity of the provided `MotionValue` changes.\n *\n * ```javascript\n * const x = useMotionValue(0)\n * const xVelocity = useVelocity(x)\n * const xAcceleration = useVelocity(xVelocity)\n * ```\n *\n * @public\n */\nfunction useVelocity(value) {\n    var velocity = useMotionValue.useMotionValue(value.getVelocity());\n    React.useEffect(function () {\n        return value.velocityUpdateSubscribers.add(function (newVelocity) {\n            velocity.set(newVelocity);\n        });\n    }, [value]);\n    return velocity;\n}\n\nfunction createScrollMotionValues() {\n    return {\n        scrollX: useMotionValue.motionValue(0),\n        scrollY: useMotionValue.motionValue(0),\n        scrollXProgress: useMotionValue.motionValue(0),\n        scrollYProgress: useMotionValue.motionValue(0),\n    };\n}\nfunction setProgress(offset, maxOffset, value) {\n    value.set(!offset || !maxOffset ? 0 : offset / maxOffset);\n}\nfunction createScrollUpdater(values, getOffsets) {\n    var update = function () {\n        var _a = getOffsets(), xOffset = _a.xOffset, yOffset = _a.yOffset, xMaxOffset = _a.xMaxOffset, yMaxOffset = _a.yMaxOffset;\n        // Set absolute positions\n        values.scrollX.set(xOffset);\n        values.scrollY.set(yOffset);\n        // Set 0-1 progress\n        setProgress(xOffset, xMaxOffset, values.scrollXProgress);\n        setProgress(yOffset, yMaxOffset, values.scrollYProgress);\n    };\n    update();\n    return update;\n}\n\nvar getElementScrollOffsets = function (element) { return function () {\n    return {\n        xOffset: element.scrollLeft,\n        yOffset: element.scrollTop,\n        xMaxOffset: element.scrollWidth - element.offsetWidth,\n        yMaxOffset: element.scrollHeight - element.offsetHeight,\n    };\n}; };\n/**\n * Returns MotionValues that update when the provided element scrolls:\n *\n * - `scrollX`  Horizontal scroll distance in pixels.\n * - `scrollY`  Vertical scroll distance in pixels.\n * - `scrollXProgress`  Horizontal scroll progress between `0` and `1`.\n * - `scrollYProgress`  Vertical scroll progress between `0` and `1`.\n *\n * This element must be set to `overflow: scroll` on either or both axes to report scroll offset.\n *\n * ```jsx\n * export const MyComponent = () => {\n *   const ref = useRef()\n *   const { scrollYProgress } = useElementScroll(ref)\n *\n *   return (\n *     <div ref={ref}>\n *       <motion.div style={{ scaleX: scrollYProgress }} />\n *     </div>\n *   )\n * }\n * ```\n *\n * @public\n */\nfunction useElementScroll(ref) {\n    var values = useMotionValue.useConstant(createScrollMotionValues);\n    useMotionValue.useIsomorphicLayoutEffect(function () {\n        var element = ref.current;\n        heyListen.invariant(!!element, \"ref provided to useScroll must be passed into a HTML element.\");\n        if (!element)\n            return;\n        var updateScrollValues = createScrollUpdater(values, getElementScrollOffsets(element));\n        var scrollListener = useMotionValue.addDomEvent(element, \"scroll\", updateScrollValues, { passive: true });\n        var resizeListener = useMotionValue.addDomEvent(element, \"resize\", updateScrollValues);\n        return function () {\n            scrollListener && scrollListener();\n            resizeListener && resizeListener();\n        };\n    }, []);\n    return values;\n}\n\nvar viewportScrollValues;\nfunction getViewportScrollOffsets() {\n    return {\n        xOffset: window.pageXOffset,\n        yOffset: window.pageYOffset,\n        xMaxOffset: document.body.clientWidth - window.innerWidth,\n        yMaxOffset: document.body.clientHeight - window.innerHeight,\n    };\n}\nvar hasListeners = false;\nfunction addEventListeners() {\n    hasListeners = true;\n    if (typeof window === \"undefined\")\n        return;\n    var updateScrollValues = createScrollUpdater(viewportScrollValues, getViewportScrollOffsets);\n    useMotionValue.addDomEvent(window, \"scroll\", updateScrollValues, { passive: true });\n    useMotionValue.addDomEvent(window, \"resize\", updateScrollValues);\n}\n/**\n * Returns MotionValues that update when the viewport scrolls:\n *\n * - `scrollX`  Horizontal scroll distance in pixels.\n * - `scrollY`  Vertical scroll distance in pixels.\n * - `scrollXProgress`  Horizontal scroll progress between `0` and `1`.\n * - `scrollYProgress`  Vertical scroll progress between `0` and `1`.\n *\n * **Warning:** Setting `body` or `html` to `height: 100%` or similar will break the `Progress`\n * values as this breaks the browser's capability to accurately measure the page length.\n *\n * ```jsx\n * export const MyComponent = () => {\n *   const { scrollYProgress } = useViewportScroll()\n *   return <motion.div style={{ scaleX: scrollYProgress }} />\n * }\n * ```\n *\n * @public\n */\nfunction useViewportScroll() {\n    /**\n     * Lazy-initialise the viewport scroll values\n     */\n    if (!viewportScrollValues) {\n        viewportScrollValues = createScrollMotionValues();\n    }\n    useMotionValue.useIsomorphicLayoutEffect(function () {\n        !hasListeners && addEventListeners();\n    }, []);\n    return viewportScrollValues;\n}\n\nvar getCurrentTime = typeof performance !== \"undefined\"\n    ? function () { return performance.now(); }\n    : function () { return Date.now(); };\nfunction useAnimationFrame(callback) {\n    var initialTimestamp = useMotionValue.useConstant(getCurrentTime);\n    React.useEffect(function () {\n        var provideTimeSinceStart = function (_a) {\n            var timestamp = _a.timestamp;\n            callback(timestamp - initialTimestamp);\n        };\n        sync__default[\"default\"].update(provideTimeSinceStart, true);\n        return function () { return sync.cancelSync.update(provideTimeSinceStart); };\n    }, [callback]);\n}\n\nfunction useTime() {\n    var time = useMotionValue.useMotionValue(0);\n    useAnimationFrame(function (t) { return time.set(t); });\n    return time;\n}\n\n// Does this device prefer reduced motion? Returns `null` server-side.\nvar prefersReducedMotion;\nfunction initPrefersReducedMotion() {\n    prefersReducedMotion = useMotionValue.motionValue(null);\n    if (typeof window === \"undefined\")\n        return;\n    if (window.matchMedia) {\n        var motionMediaQuery_1 = window.matchMedia(\"(prefers-reduced-motion)\");\n        var setReducedMotionPreferences = function () {\n            return prefersReducedMotion.set(motionMediaQuery_1.matches);\n        };\n        motionMediaQuery_1.addListener(setReducedMotionPreferences);\n        setReducedMotionPreferences();\n    }\n    else {\n        prefersReducedMotion.set(false);\n    }\n}\n/**\n * A hook that returns `true` if we should be using reduced motion based on the current device's Reduced Motion setting.\n *\n * This can be used to implement changes to your UI based on Reduced Motion. For instance, replacing motion-sickness inducing\n * `x`/`y` animations with `opacity`, disabling the autoplay of background videos, or turning off parallax motion.\n *\n * It will actively respond to changes and re-render your components with the latest setting.\n *\n * ```jsx\n * export function Sidebar({ isOpen }) {\n *   const shouldReduceMotion = useReducedMotion()\n *   const closedX = shouldReduceMotion ? 0 : \"-100%\"\n *\n *   return (\n *     <motion.div animate={{\n *       opacity: isOpen ? 1 : 0,\n *       x: isOpen ? 0 : closedX\n *     }} />\n *   )\n * }\n * ```\n *\n * @return boolean\n *\n * @public\n */\nfunction useReducedMotion() {\n    /**\n     * Lazy initialisation of prefersReducedMotion\n     */\n    !prefersReducedMotion && initPrefersReducedMotion();\n    var _a = tslib.__read(React.useState(prefersReducedMotion.get()), 2), shouldReduceMotion = _a[0], setShouldReduceMotion = _a[1];\n    useOnChange(prefersReducedMotion, setShouldReduceMotion);\n    return shouldReduceMotion;\n}\n\n/**\n * @public\n */\nfunction animationControls() {\n    /**\n     * Track whether the host component has mounted.\n     */\n    var hasMounted = false;\n    /**\n     * Pending animations that are started before a component is mounted.\n     * TODO: Remove this as animations should only run in effects\n     */\n    var pendingAnimations = [];\n    /**\n     * A collection of linked component animation controls.\n     */\n    var subscribers = new Set();\n    var controls = {\n        subscribe: function (visualElement) {\n            subscribers.add(visualElement);\n            return function () { return void subscribers.delete(visualElement); };\n        },\n        start: function (definition, transitionOverride) {\n            /**\n             * TODO: We only perform this hasMounted check because in Framer we used to\n             * encourage the ability to start an animation within the render phase. This\n             * isn't behaviour concurrent-safe so when we make Framer concurrent-safe\n             * we can ditch this.\n             */\n            if (hasMounted) {\n                var animations_1 = [];\n                subscribers.forEach(function (visualElement) {\n                    animations_1.push(useMotionValue.animateVisualElement(visualElement, definition, {\n                        transitionOverride: transitionOverride,\n                    }));\n                });\n                return Promise.all(animations_1);\n            }\n            else {\n                return new Promise(function (resolve) {\n                    pendingAnimations.push({\n                        animation: [definition, transitionOverride],\n                        resolve: resolve,\n                    });\n                });\n            }\n        },\n        set: function (definition) {\n            heyListen.invariant(hasMounted, \"controls.set() should only be called after a component has mounted. Consider calling within a useEffect hook.\");\n            return subscribers.forEach(function (visualElement) {\n                useMotionValue.setValues(visualElement, definition);\n            });\n        },\n        stop: function () {\n            subscribers.forEach(function (visualElement) {\n                useMotionValue.stopAnimation(visualElement);\n            });\n        },\n        mount: function () {\n            hasMounted = true;\n            pendingAnimations.forEach(function (_a) {\n                var animation = _a.animation, resolve = _a.resolve;\n                controls.start.apply(controls, tslib.__spreadArray([], tslib.__read(animation), false)).then(resolve);\n            });\n            return function () {\n                hasMounted = false;\n                controls.stop();\n            };\n        },\n    };\n    return controls;\n}\n\n/**\n * Creates `AnimationControls`, which can be used to manually start, stop\n * and sequence animations on one or more components.\n *\n * The returned `AnimationControls` should be passed to the `animate` property\n * of the components you want to animate.\n *\n * These components can then be animated with the `start` method.\n *\n * ```jsx\n * import * as React from 'react'\n * import { motion, useAnimation } from 'framer-motion'\n *\n * export function MyComponent(props) {\n *    const controls = useAnimation()\n *\n *    controls.start({\n *        x: 100,\n *        transition: { duration: 0.5 },\n *    })\n *\n *    return <motion.div animate={controls} />\n * }\n * ```\n *\n * @returns Animation controller with `start` and `stop` methods\n *\n * @public\n */\nfunction useAnimation() {\n    var controls = useMotionValue.useConstant(animationControls);\n    React.useEffect(controls.mount, []);\n    return controls;\n}\n\n/**\n * Cycles through a series of visual properties. Can be used to toggle between or cycle through animations. It works similar to `useState` in React. It is provided an initial array of possible states, and returns an array of two arguments.\n *\n * An index value can be passed to the returned `cycle` function to cycle to a specific index.\n *\n * ```jsx\n * import * as React from \"react\"\n * import { motion, useCycle } from \"framer-motion\"\n *\n * export const MyComponent = () => {\n *   const [x, cycleX] = useCycle(0, 50, 100)\n *\n *   return (\n *     <motion.div\n *       animate={{ x: x }}\n *       onTap={() => cycleX()}\n *      />\n *    )\n * }\n * ```\n *\n * @param items - items to cycle through\n * @returns [currentState, cycleState]\n *\n * @public\n */\nfunction useCycle() {\n    var items = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        items[_i] = arguments[_i];\n    }\n    var index = React.useRef(0);\n    var _a = tslib.__read(React.useState(items[index.current]), 2), item = _a[0], setItem = _a[1];\n    return [\n        item,\n        function (next) {\n            index.current =\n                typeof next !== \"number\"\n                    ? popmotion.wrap(0, items.length, index.current + 1)\n                    : next;\n            setItem(items[index.current]);\n        },\n    ];\n}\n\n/**\n * Can manually trigger a drag gesture on one or more `drag`-enabled `motion` components.\n *\n * ```jsx\n * const dragControls = useDragControls()\n *\n * function startDrag(event) {\n *   dragControls.start(event, { snapToCursor: true })\n * }\n *\n * return (\n *   <>\n *     <div onPointerDown={startDrag} />\n *     <motion.div drag=\"x\" dragControls={dragControls} />\n *   </>\n * )\n * ```\n *\n * @public\n */\nvar DragControls = /** @class */ (function () {\n    function DragControls() {\n        this.componentControls = new Set();\n    }\n    /**\n     * Subscribe a component's internal `VisualElementDragControls` to the user-facing API.\n     *\n     * @internal\n     */\n    DragControls.prototype.subscribe = function (controls) {\n        var _this = this;\n        this.componentControls.add(controls);\n        return function () { return _this.componentControls.delete(controls); };\n    };\n    /**\n     * Start a drag gesture on every `motion` component that has this set of drag controls\n     * passed into it via the `dragControls` prop.\n     *\n     * ```jsx\n     * dragControls.start(e, {\n     *   snapToCursor: true\n     * })\n     * ```\n     *\n     * @param event - PointerEvent\n     * @param options - Options\n     *\n     * @public\n     */\n    DragControls.prototype.start = function (event, options) {\n        this.componentControls.forEach(function (controls) {\n            controls.start(event.nativeEvent || event, options);\n        });\n    };\n    return DragControls;\n}());\nvar createDragControls = function () { return new DragControls(); };\n/**\n * Usually, dragging is initiated by pressing down on a `motion` component with a `drag` prop\n * and moving it. For some use-cases, for instance clicking at an arbitrary point on a video scrubber, we\n * might want to initiate that dragging from a different component than the draggable one.\n *\n * By creating a `dragControls` using the `useDragControls` hook, we can pass this into\n * the draggable component's `dragControls` prop. It exposes a `start` method\n * that can start dragging from pointer events on other components.\n *\n * ```jsx\n * const dragControls = useDragControls()\n *\n * function startDrag(event) {\n *   dragControls.start(event, { snapToCursor: true })\n * }\n *\n * return (\n *   <>\n *     <div onPointerDown={startDrag} />\n *     <motion.div drag=\"x\" dragControls={dragControls} />\n *   </>\n * )\n * ```\n *\n * @public\n */\nfunction useDragControls() {\n    return useMotionValue.useConstant(createDragControls);\n}\n\nfunction useInstantLayoutTransition() {\n    return startTransition;\n}\nfunction startTransition(cb) {\n    if (!rootProjectionNode.current)\n        return;\n    rootProjectionNode.current.isUpdating = false;\n    rootProjectionNode.current.blockUpdate();\n    cb === null || cb === void 0 ? void 0 : cb();\n}\n\nfunction useInstantTransition() {\n    var _a = tslib.__read(useMotionValue.useForceUpdate(), 2), forceUpdate = _a[0], forcedRenderCount = _a[1];\n    var startInstantLayoutTransition = useInstantLayoutTransition();\n    React.useEffect(function () {\n        /**\n         * Unblock after two animation frames, otherwise this will unblock too soon.\n         */\n        sync__default[\"default\"].postRender(function () {\n            return sync__default[\"default\"].postRender(function () { return (useMotionValue.instantAnimationState.current = false); });\n        });\n    }, [forcedRenderCount]);\n    return function (callback) {\n        startInstantLayoutTransition(function () {\n            useMotionValue.instantAnimationState.current = true;\n            forceUpdate();\n            callback();\n        });\n    };\n}\n\nfunction useResetProjection() {\n    var reset = React__namespace.useCallback(function () {\n        var root = rootProjectionNode.current;\n        if (!root)\n            return;\n        root.resetTree();\n    }, []);\n    return reset;\n}\n\nvar createObject = function () { return ({}); };\nvar stateVisualElement = useMotionValue.visualElement({\n    build: function () { },\n    measureViewportBox: useMotionValue.createBox,\n    resetTransform: function () { },\n    restoreTransform: function () { },\n    removeValueFromRenderState: function () { },\n    render: function () { },\n    scrapeMotionValuesFromProps: createObject,\n    readValueFromInstance: function (_state, key, options) {\n        return options.initialState[key] || 0;\n    },\n    makeTargetAnimatable: function (element, _a) {\n        var transition = _a.transition, transitionEnd = _a.transitionEnd, target = tslib.__rest(_a, [\"transition\", \"transitionEnd\"]);\n        var origin = useMotionValue.getOrigin(target, transition || {}, element);\n        useMotionValue.checkTargetForNewValues(element, target, origin);\n        return tslib.__assign({ transition: transition, transitionEnd: transitionEnd }, target);\n    },\n});\nvar useVisualState = useMotionValue.makeUseVisualState({\n    scrapeMotionValuesFromProps: createObject,\n    createRenderState: createObject,\n});\n/**\n * This is not an officially supported API and may be removed\n * on any version.\n * @internal\n */\nfunction useAnimatedState(initialState) {\n    var _a = tslib.__read(React.useState(initialState), 2), animationState = _a[0], setAnimationState = _a[1];\n    var visualState = useVisualState({}, false);\n    var element = useMotionValue.useConstant(function () {\n        return stateVisualElement({ props: {}, visualState: visualState }, { initialState: initialState });\n    });\n    React.useEffect(function () {\n        element.mount({});\n        return element.unmount();\n    }, []);\n    React.useEffect(function () {\n        element.setProps({\n            onUpdate: function (v) { return setAnimationState(tslib.__assign({}, v)); },\n        });\n    });\n    var startAnimation = useMotionValue.useConstant(function () { return function (animationDefinition) {\n        return useMotionValue.animateVisualElement(element, animationDefinition);\n    }; });\n    return [animationState, startAnimation];\n}\n\n// Keep things reasonable and avoid scale: Infinity. In practise we might need\n// to add another value, opacity, that could interpolate scaleX/Y [0,0.01] => [0,1]\n// to simply hide content at unreasonable scales.\nvar maxScale = 100000;\nvar invertScale = function (scale) {\n    return scale > 0.001 ? 1 / scale : maxScale;\n};\nvar hasWarned = false;\n/**\n * Returns a `MotionValue` each for `scaleX` and `scaleY` that update with the inverse\n * of their respective parent scales.\n *\n * This is useful for undoing the distortion of content when scaling a parent component.\n *\n * By default, `useInvertedScale` will automatically fetch `scaleX` and `scaleY` from the nearest parent.\n * By passing other `MotionValue`s in as `useInvertedScale({ scaleX, scaleY })`, it will invert the output\n * of those instead.\n *\n * ```jsx\n * const MyComponent = () => {\n *   const { scaleX, scaleY } = useInvertedScale()\n *   return <motion.div style={{ scaleX, scaleY }} />\n * }\n * ```\n *\n * @deprecated\n * @internal\n */\nfunction useInvertedScale(scale) {\n    var parentScaleX = useMotionValue.useMotionValue(1);\n    var parentScaleY = useMotionValue.useMotionValue(1);\n    var visualElement = useMotionValue.useVisualElementContext();\n    heyListen.invariant(!!(scale || visualElement), \"If no scale values are provided, useInvertedScale must be used within a child of another motion component.\");\n    heyListen.warning(hasWarned, \"useInvertedScale is deprecated and will be removed in 3.0. Use the layout prop instead.\");\n    hasWarned = true;\n    if (scale) {\n        parentScaleX = scale.scaleX || parentScaleX;\n        parentScaleY = scale.scaleY || parentScaleY;\n    }\n    else if (visualElement) {\n        parentScaleX = visualElement.getValue(\"scaleX\", 1);\n        parentScaleY = visualElement.getValue(\"scaleY\", 1);\n    }\n    var scaleX = useTransform(parentScaleX, invertScale);\n    var scaleY = useTransform(parentScaleY, invertScale);\n    return { scaleX: scaleX, scaleY: scaleY };\n}\n\nexports.FlatTree = useMotionValue.FlatTree;\nexports.LayoutGroupContext = useMotionValue.LayoutGroupContext;\nexports.MotionConfigContext = useMotionValue.MotionConfigContext;\nexports.MotionContext = useMotionValue.MotionContext;\nexports.MotionValue = useMotionValue.MotionValue;\nexports.PresenceContext = useMotionValue.PresenceContext;\nexports.SwitchLayoutGroupContext = useMotionValue.SwitchLayoutGroupContext;\nexports.addScaleCorrector = useMotionValue.addScaleCorrector;\nexports.animate = useMotionValue.animate;\nexports.animateVisualElement = useMotionValue.animateVisualElement;\nexports.createMotionComponent = useMotionValue.createMotionComponent;\nexports.isValidMotionProp = useMotionValue.isValidMotionProp;\nexports.motionValue = useMotionValue.motionValue;\nexports.resolveMotionValue = useMotionValue.resolveMotionValue;\nexports.useDomEvent = useMotionValue.useDomEvent;\nexports.useIsPresent = useMotionValue.useIsPresent;\nexports.useMotionValue = useMotionValue.useMotionValue;\nexports.usePresence = useMotionValue.usePresence;\nexports.visualElement = useMotionValue.visualElement;\nexports.AnimatePresence = AnimatePresence;\nexports.AnimateSharedLayout = AnimateSharedLayout;\nexports.DeprecatedLayoutGroupContext = DeprecatedLayoutGroupContext;\nexports.DragControls = DragControls;\nexports.LayoutGroup = LayoutGroup;\nexports.LazyMotion = LazyMotion;\nexports.MotionConfig = MotionConfig;\nexports.Reorder = Reorder;\nexports.animationControls = animationControls;\nexports.createDomMotionComponent = createDomMotionComponent;\nexports.domAnimation = domAnimation;\nexports.domMax = domMax;\nexports.m = m;\nexports.motion = motion;\nexports.transform = transform;\nexports.useAnimation = useAnimation;\nexports.useAnimationFrame = useAnimationFrame;\nexports.useCycle = useCycle;\nexports.useDeprecatedAnimatedState = useAnimatedState;\nexports.useDeprecatedInvertedScale = useInvertedScale;\nexports.useDragControls = useDragControls;\nexports.useElementScroll = useElementScroll;\nexports.useInstantLayoutTransition = useInstantLayoutTransition;\nexports.useInstantTransition = useInstantTransition;\nexports.useMotionTemplate = useMotionTemplate;\nexports.useReducedMotion = useReducedMotion;\nexports.useResetProjection = useResetProjection;\nexports.useSpring = useSpring;\nexports.useTime = useTime;\nexports.useTransform = useTransform;\nexports.useVelocity = useVelocity;\nexports.useViewportScroll = useViewportScroll;\n"]},"metadata":{},"sourceType":"script"}